function addViewerComponent(a){VIEWER_COMPONENTS.push(a)}function viewerClearTextSelection(){window.getSelection&&(window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges())}function addIviewComponent(a){console.warn("addIviewComponent shouldnt be used anymore!"),VIEWER_COMPONENTS.push(a)}function ViewerFormatString(a,b){var c=function(a,b,c){return a.replace("{"+b+"}",c)},d=a;for(var e in b)d=c(d,e,b[e]);return d}function isFullscreen(){var a=document;return null!=a.fullscreenElement||null!=a.webkitFullscreenElement}function viewerCrossBrowserWheel(a,b){var c=function(c){c.preventDefault();var d=c.clientX-jQuery(a).offset().left,e=c.clientY-jQuery(a).offset().top,f=new Position2D(d,e).scale(window.devicePixelRatio);if("deltaX"in c)return void b({deltaX:c.deltaX,deltaY:c.deltaY,orig:c,pos:f,altKey:c.altKey,ctrlKey:c.ctrlKey});var g=c.shiftKey;if("axis"in c&&(g=1==c.axis,"detail"in c)){var h=c.detail,i={deltaX:0,deltaY:0,orig:c,pos:f,altKey:c.altKey,ctrlKey:c.ctrlKey};return g?i.deltaX=h:i.deltaY=h,void b(i)}if("wheelDelta"in c){var j=-c.wheelDelta,k=c.shiftKey?{deltaX:j,deltaY:0}:{deltaX:0,deltaY:j};k.orig=c,k.pos=f,k.altKey=c.altKey,b(k)}};a.addEventListener&&(a.addEventListener("mousewheel",c,!1),a.addEventListener("MozMousePixelScroll",c,!1))}function singleSelectShim(a,b,c){if("evaluate"in document){var d=function(a){return c.get(a)};return a.evaluate(b,a.documentElement,d,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}var e=new ActiveXObject("Msxml2.DOMDocument.6.0");e.async=!1,e.load(a);var f="";return c.keys.forEach(function(a){var b="xmlns:"+a+'="'+c.get(a)+'" ';f+=b}),e.setProperty("SelectionNamespaces",f),e.setProperty("SelectionLanguage","XPath"),e.documentElement.selectSingleNode(b)}function getNodesShim(a,b,c,d,e,f){if("evaluate"in document){for(var g=function(a){return d.get(a)},h=a.evaluate(b,c,g,e,f),i=[],j=void 0;null!=(j=h.iterateNext());)i.push(j);return i}var k=new ActiveXObject("Msxml2.DOMDocument.6.0");k.async=!1,k.load(a);var l="";d.keys.forEach(function(a){var b="xmlns:"+a+'="'+d.get(a)+'" ';l+=b}),k.setProperty("SelectionNamespaces",l),k.setProperty("SelectionLanguage","XPath");for(var h=k.documentElement.selectNodes(b),i=[],m=0;m<h.length;m++)i.push(h.nextNode());return i}var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a){this._type=a}return Object.defineProperty(a.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),a}();a.DefaultViewerEvent=b}(a.events||(a.events={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(b){!function(b){!function(b){var c=function(a){function b(b,c){a.call(this,c),this.component=b}return __extends(b,a),b}(a.viewer.widgets.events.DefaultViewerEvent);b.MyCoReImageViewerEvent=c}(b.events||(b.events={}))}(b.components||(b.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var VIEWER_COMPONENTS=IVIEW_COMPONENTS||[],ArrayIterator=function(){function a(a){this._array=a,this.iterator=0}return a.prototype.hasPrevious=function(){return 0!=this.iterator},a.prototype.hasNext=function(){return this.iterator+1<this._array.length},a.prototype.previous=function(){return this._array[--this.iterator]},a.prototype.next=function(){return this._array[++this.iterator]},a.prototype.current=function(){return this._array[this.iterator]},a.prototype.reset=function(){this.iterator=0},a}(),Position2D=function(){function a(a,b){this._x=a,this._y=b}return a.prototype.toString=function(){return this.x+":"+this.y},a.prototype.move=function(b){return new a(this._x+b.x,this._y+b.y)},a.prototype.roundDown=function(){return new a(Math.floor(this.x),Math.floor(this.y))},a.prototype.roundUp=function(){return new a(Math.ceil(this.x),Math.ceil(this.y))},a.prototype.scale=function(b){return new a(this._x*b,this._y*b)},a.prototype.copy=function(){return new a(this.x,this.y)},a.fromString=function(b){var c=b.split(":");return new a(parseInt(c[0],10),parseInt(c[1],10))},Object.defineProperty(a.prototype,"x",{get:function(){return this._x},set:function(a){throw"x of position is unmodifyable!"},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"y",{get:function(){return this._y},set:function(a){throw"y of position is unmodifyable!"},enumerable:!0,configurable:!0}),a.prototype.rotate=function(b){var c=this._x,d=this._y;switch(b){case 90:var e=c;c=-d,d=e;case 180:var e=c;c=-d,d=e;case 270:var e=c;c=-1*d,d=e}return new a(c,d)},a.prototype.rotateAround=function(b,c){c*=-1;var d=this.x-b.x,e=this.y-b.y;return new a(b.x+d*Math.cos(c)-e*Math.sin(c),b.y+d*Math.sin(c)+e*Math.cos(c))},a.prototype.toPosition3D=function(a){return new Position3D(this.x,this.y,a)},a.prototype.equals=function(a){return"x"in a&&"y"in a&&(a.x==this.x&&a.y==this.y)},a.prototype.min=function(b,c){return new a(Math.min(this.x,b),Math.min(this.y,c))},a.prototype.max=function(b,c){return new a(Math.max(this.x,b),Math.max(this.y,c))},a}(),MoveVector=function(a){function b(b,c){a.call(this,b,c)}return __extends(b,a),b}(Position2D),Position3D=function(){function a(a,b,c){this.x=a,this.y=b,this.z=c}return a.prototype.toString=function(){return this.z+":"+this.x+":"+this.y},a.prototype.toPosition2D=function(){return new Position2D(this.x,this.y)},a}(),Size2D=function(){function a(a,b){this.width=a,this.height=b}return a.prototype.toString=function(){return this.width+":"+this.height},a.prototype.roundUp=function(){return new a(Math.ceil(this.width),Math.ceil(this.height))},a.prototype.scale=function(b){return new a(this.width*b,this.height*b)},a.prototype.copy=function(){return new a(this.width,this.height)},a.prototype.getRotated=function(b){return 0==b||180==b?this.copy():new a(this.height,this.width)},a.prototype.maxSide=function(){return Math.max(this.width,this.height)},a.prototype.getSurface=function(){return this.width*this.height},a.prototype.roundDown=function(){return new a(Math.floor(this.width),Math.floor(this.height))},a}(),Rect=function(){function a(a,b){this.pos=a,this.size=b}return a.prototype.getPoints=function(){return{upperLeft:this.pos,upperRight:new Position2D(this.pos.x+this.size.width,this.pos.y),lowerLeft:new Position2D(this.pos.x,this.pos.y+this.size.height),lowerRight:new Position2D(this.pos.x+this.size.width,this.pos.y+this.size.height)}},a.prototype.getX=function(){return this.pos.x},a.prototype.getY=function(){return this.pos.y},a.prototype.getWidth=function(){return this.size.width},a.prototype.getHeight=function(){return this.size.height},a.prototype.scale=function(b){return new a(this.pos.scale(b),this.size.scale(b))},a.prototype.getIntersection=function(b){var c=this,d=Math.max(c.pos.x,b.pos.x),e=c.pos.x+c.size.width,f=b.pos.x+b.size.width,g=Math.min(e,f);if(g>d){var h=Math.max(c.pos.y,b.pos.y),i=c.pos.y+c.size.height,j=b.pos.y+b.size.height,k=Math.min(i,j);if(k>h)return new a(new Position2D(d,h),new Size2D(g-d,k-h))}return null},a.prototype.intersects=function(a){return this.intersectsHorizontal(a.x)&&this.intersectsVertical(a.y)},a.prototype.intersectsArea=function(a){return this.getX()<a.getX()+a.getWidth()&&a.getX()<this.getX()+this.getWidth()&&this.getY()<a.getY()+a.getHeight()&&a.getY()<this.getY()+this.getHeight()},a.prototype.intersectsVertical=function(a){return a<this.pos.y+this.size.height&&a>this.pos.y},a.prototype.intersectsHorizontal=function(a){return a<this.pos.x+this.size.width&&a>this.pos.x},a.prototype.rotate=function(b){return new a(this.pos.rotate(b),this.size.getRotated(b))},a.prototype.flipX=function(){var b=this.pos.x+this.size.width,c=-this.size.width;return new a(new Position2D(b,this.pos.y),new Size2D(c,this.size.height))},a.prototype.flipY=function(){var b=this.pos.y+this.size.height,c=-this.size.height;return new a(new Position2D(this.pos.x,b),new Size2D(this.size.width,c))},a.prototype.flip=function(a){return 90==a?this.flipX():180==a?this.flipX().flipY():270==a?this.flipY():this.copy()},a.prototype.equals=function(b){if(b instanceof a||"pos"in b&&"size"in b&&"_x"in b.pos&&"_y"in b.pos&&"width"in b.size&&"height"in b.size)return b.pos.x==this.pos.x&&b.pos.y==this.pos.y&&b.size.width==this.size.width&&b.size.height==this.size.height},a.prototype.contains=function(a){return a.getX()>=this.getX()&&a.getY()>=this.getY()&&a.getX()+a.getWidth()<=this.getX()+this.getWidth()&&a.getY()+a.getHeight()<=this.getY()+this.getHeight()},a.prototype.getMiddlePoint=function(){return new Position2D(this.pos.x+this.size.width/2,this.pos.y+this.size.height/2)},a.prototype.toString=function(){return this.pos.toString()+" - "+this.size.toString()},a.prototype.getRotated=function(b){var c=this.getMiddlePoint(),d=this.size.getRotated(b);return new a(new Position2D(c.x-d.width/2,c.y-d.height/2),d)},a.prototype.maximize=function(b,c,d,e){var f=this.pos.x+this.size.width,g=b+d,h=this.pos.y+this.size.height,i=c+e,j=b<this.pos.x?b:this.pos.x,k=c<this.pos.y?c:this.pos.y,l=Math.max(f,g)-j,m=Math.max(h,i)-k;return a.fromXYWH(j,k,l,m)},a.prototype.maximizeRect=function(a){return this.maximize(a.getX(),a.getY(),a.getWidth(),a.getHeight())},a.prototype.increase=function(b){var c=this.pos.x-b,d=this.pos.y-b,e=this.size.width+2*b,f=this.size.height+2*b;return a.fromXYWH(c,d,e,f)},a.prototype.difference=function(b){var c=this,d=a.diff(this,b);return d=d.filter(function(a){return 0!=a.getWidth()&&0!=a.getHeight()}).filter(function(a){return c.contains(a)})},a.prototype.copy=function(){return new a(this.pos.copy(),this.size.copy())},a.fromXYWH=function(b,c,d,e){return new a(new Position2D(b,c),new Size2D(d,e))},a.fromULLR=function(b,c){return new a(new Position2D(b.x,b.y),new Size2D(c.x-b.x,c.y-b.y))},a.getBounding=function(){for(var b=[],c=0;c<arguments.length;c++)b[c-0]=arguments[c];var d=Math.pow(2,31),e=d,f=d,g=-d,h=-d;return b.forEach(function(a){e=Math.min(e,a.pos.y),g=Math.max(g,a.pos.y+a.size.height),f=Math.min(f,a.pos.x),h=Math.max(h,a.pos.x+a.size.width)}),a.fromULLR(new Position2D(f,e),new Position2D(h,g))},a.diff=function(b,c){var d=Math.min(b.getX(),c.getX()),e=Math.max(b.getX(),c.getX()),f=Math.min(b.getX()+b.getWidth(),c.getX()+c.getWidth()),g=Math.max(b.getX()+b.getWidth(),c.getX()+c.getWidth()),h=Math.min(b.getY(),c.getY()),i=Math.max(b.getY(),c.getY()),j=Math.min(b.getY()+b.getHeight(),c.getY()+c.getHeight()),k=Math.max(b.getY()+b.getHeight(),c.getY()+c.getHeight()),l=[];return l[0]=a.fromULLR(new Position2D(d,h),new Position2D(e,i)),l[1]=a.fromULLR(new Position2D(e,h),new Position2D(f,i)),l[2]=a.fromULLR(new Position2D(f,h),new Position2D(g,i)),l[3]=a.fromULLR(new Position2D(d,i),new Position2D(e,j)),l[4]=a.fromULLR(new Position2D(f,i),new Position2D(g,j)),l[5]=a.fromULLR(new Position2D(d,j),new Position2D(e,k)),l[6]=a.fromULLR(new Position2D(e,j),new Position2D(f,k)),l[7]=a.fromULLR(new Position2D(f,j),new Position2D(g,k)),l},a}(),Utils=function(){function a(){}return a.canvasToImage=function(a){var b=document.createElement("img");return b.src=a.toDataURL(),b},a.getVar=function(b,c,d,e){if(void 0===d&&(d=null),void 0===e&&(e=function(a){return!0}),c in b&&e(b[c]))return b[c];var f=c.indexOf(".");-1==f&&(f=c.length);var g=c.substring(0,f);if(g in b&&null!=b[g]&&void 0!==b[g]){if(f!=c.length)return a.getVar(b[g],c.substring(g.length+1),d,e);if(e(b[g]))return b[g]}return d},a.synchronize=function(a,b){return function(c){a.filter(function(a){return a(c)}).length==a.length&&b(c)}},a.createRandomId=function(){return"nnnnnn-nnnn-nnnn-nnnnnnnn".split("n").map(function(a){return a+Math.ceil(15*Math.random()).toString(36)}).join("")},a.hash=function(a){for(var b=0,c=0;c<a.length;c++)b=(b<<5)-b+a.charCodeAt(c),b&=b;return b},a.selectElementText=function(a){a.select()},a.LOG_HALF=Math.log(.5),a.stopPropagation=function(a){a.stopImmediatePropagation()},a}(),MyCoReMap=function(){function a(b){if(this.keyMap={},this.valueMap={},this.keyToHashFunction=a.BASE_KEY_TO_HASH_FUNCTION,void 0!==b)for(var c in b)this.set(c,b[c])}return a.prototype.set=function(a,b){var c=this.getHash(a);this.keyMap[c]=a,this.valueMap[c]=b},a.prototype.get=function(a){return this.valueMap[this.getHash(a)]},a.prototype.setKeyToHashFunction=function(a){this.keyToHashFunction=a},a.prototype.hasThen=function(a,b){this.has(a)&&b(this.get(a))},Object.defineProperty(a.prototype,"keys",{get:function(){var a=[];for(var b in this.keyMap)a.push(this.keyMap[b]);return a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"values",{get:function(){var a=[];for(var b in this.valueMap)a.push(this.valueMap[b]);return a},enumerable:!0,configurable:!0}),a.prototype.has=function(a){if(void 0===a||null==a)return!1;var b=this.valueMap[this.getHash(a)];return void 0!==b&&null!=b},a.prototype.forEach=function(a){var b=this;this.keys.forEach(function(c){a(c,b.get(c))})},a.prototype.filter=function(b){var c=new a;return this.forEach(function(a,d){b(a,d)&&c.set(a,d)}),c},a.prototype.copy=function(){var b=new a;return this.forEach(function(a,c){b.set(a,c)}),b},a.prototype.remove=function(a){var b=this.getHash(a);delete this.keyMap[b],delete this.valueMap[b]},a.prototype.clear=function(){this.keyMap={},this.valueMap={}},a.prototype.mergeIn=function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];var c=this;for(var d in a){a[d].forEach(function(a,b){c.set(a,b)})}},a.prototype.isEmpty=function(){return Object.keys(this.keyMap).length<=0},a.prototype.getHash=function(b){return a.KEY_PREFIX+this.keyToHashFunction(b)},a.BASE_KEY_TO_HASH_FUNCTION=function(a){return a.toString()},a.KEY_PREFIX="MyCoReMap.",a}(),ViewerError=function(){function a(a,b){void 0===b&&(b=null),this.informations=new MyCoReMap,this.informations.set("message",a),this.informations.set("error",b),this.informations.set("callee",arguments.callee),console.log(this.toString()),console.trace()}return a.prototype.toString=function(){return this.informations.get("message")},a}(),ViewerProperty=function(){function a(a,b,c){void 0===c&&(c=null),this._from=a,this._name=b,this._value=c,this.propertyChanging=!1,this.observerArray=new Array}return Object.defineProperty(a.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"value",{get:function(){return this._value},set:function(a){var b=this.clone();this._value=a,this.notifyPropertyChanged(b,this)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"from",{get:function(){return this._from},enumerable:!0,configurable:!0}),a.prototype.clone=function(){return new a(this._from,this.name,this.value)},a.prototype.removeAllObserver=function(){for(;this.observerArray.pop(););},a.prototype.removeObserver=function(a){var b=this.observerArray.indexOf(a);this.observerArray.splice(b,1)},a.prototype.addObserver=function(a){this.observerArray.push(a)},a.prototype.notifyPropertyChanged=function(a,b){var c=this;this.propertyChanging=!0,this.observerArray.forEach(function(d){c.propertyChanging&&d.propertyChanged(a,b)}),this.propertyChanging=!1},a}(),viewerRequestAnimationFrame=function(a){return void 0===a&&(a=window),window.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}(window),viewerCancelRequestAnimationFrame=function(a){return void 0===a&&(a=window),window.cancelAnimationFrame||a.webkitCancelRequestAnimationFrame||a.mozCancelRequestAnimationFrame||function(a){window.clearTimeout(a)}}(window),ViewerUserSettingStore=function(){function a(){if(void 0!==a._INSTANCE&&null!==a._INSTANCE)throw new ViewerError("Its a Singleton use instance instead!");this._browserStorageSupport="undefined"!=typeof Storage,this.browserStorageSupport||(this._sessionMap=new MyCoReMap)}return a.getInstance=function(){return void 0!==a._INSTANCE&&null!=a._INSTANCE||(a._INSTANCE=new a),a._INSTANCE},a.prototype.getValue=function(a){return this.browserStorageSupport?window.localStorage.getItem(a):this._sessionMap.get(a)},a.prototype.setValue=function(a,b){this.browserStorageSupport?window.localStorage.setItem(a,b):this._sessionMap.set(a,b)},a.prototype.hasValue=function(a){return this.browserStorageSupport?null!==window.localStorage.getItem(a):this._sessionMap.has(a)},Object.defineProperty(a.prototype,"browserStorageSupport",{get:function(){return this._browserStorageSupport},enumerable:!0,configurable:!0}),a.LOCK=!1,a}(),viewerDeviceSupportTouch="ontouchstart"in window,ViewerPromise=function(){function a(){this._result=null,this._rejectReason=null,this._then=a.DEFAULT,this._onReject=a.DEFAULT}return a.prototype.then=function(a){this._then=a,null!=this._result&&a(this._result)},a.prototype.onreject=function(a){this._onReject=a,null!=this._rejectReason&&this._onReject(this._rejectReason)},a.prototype.reject=function(b){this._rejectReason=b,this._onReject!=a.DEFAULT&&this._onReject(b)},a.prototype.resolve=function(b){this._result=b,this._then!=a.DEFAULT&&this._then(b)},a.DEFAULT=function(a){},a}(),ViewerParameterMap=function(a){function b(){a.call(this)}return __extends(b,a),b.prototype.toParameterString=function(){var a=new Array;this.forEach(function(b,c){a.push(b+"="+c)});var b=a.join("&");return b.length>0?"?"+b:""},b.fromCurrentUrl=function(){return b.fromUrl(window.location.href)},b.fromUrl=function(a){var c=new b,d=a.split("?")[1];if(void 0!==d){var e=(d.split("#")[0],d.split("&"));for(var f in e){var g=e[f],h=g.split("=");c.set(h[0],decodeURIComponent(h[1]))}}return c},b}(MyCoReMap),XMLUtil=function(){function a(){}return a.iterateChildNodes=function(a,b){for(var c=a.childNodes,d=0;d<c.length;d++)b(c.item(d))},a.nodeListToNodeArray=function(a){for(var b=new Array,c=0;c<a.length;c++)b.push(a.item(c));return b},a.getOneChild=function(b,c){var d=b.childNodes;return a.getOneOf(d,c)},a.getOneOf=function(a,b){for(var c=0;c<a.length;c++){var d=a.item(c);if(b(d))return d}return null},a.METS_NAMESPACE_URI="http://www.loc.gov/METS/",a.XLINK_NAMESPACE_URI="http://www.w3.org/1999/xlink",a.NS_MAP=function(){var b=new MyCoReMap;return b.set("mets",a.METS_NAMESPACE_URI),b.set("xlink",a.XLINK_NAMESPACE_URI),b}(),a}(),ClassDescriber=function(){function a(){}return a.getName=function(a){var b=/function (.{1,})\(/,c=b.exec(a.constructor.toString());return c&&c.length>1?c[1]:""},a.ofEqualClass=function(b,c){return a.getName(b)==a.getName(c)},a}(),mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(){this._currentAnimation=null,this._lastAnimTime=-1,this.positionProperty=new ViewerProperty(this,"_position",new Position2D(0,0)),this.sizeProperty=new ViewerProperty(this,"_position",new Size2D(0,0)),this.rotationProperty=new ViewerProperty(this,"_rotation",0),this.scaleProperty=new ViewerProperty(this,"_scale",1)}return Object.defineProperty(a.prototype,"scale",{get:function(){return this.scaleProperty.value},set:function(a){if(0==a||void 0===a||null==a||isNaN(a))throw new ViewerError("The scale of viewport is not valid!",a);this.scaleProperty.value=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"rotation",{get:function(){return this.rotationProperty.value},set:function(a){if(0!=a&&90!=a&&180!=a&&270!=a)throw new ViewerError("The rotation of viewport is not valid!",a);this.rotationProperty.value=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"size",{get:function(){return this.sizeProperty.value},set:function(a){if(void 0===a||null==a||isNaN(a.width)||isNaN(a.height))throw new ViewerError("The size of viewport is not valid!",a);this.sizeProperty.value=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"position",{get:function(){return this.positionProperty.value},set:function(a){if(void 0===a||null==a||isNaN(a.x)||isNaN(a.y))throw new ViewerError("The position of viewport is not valid!",a);this.positionProperty.value=a},enumerable:!0,configurable:!0}),a.prototype.asRectInArea=function(){var a=this.size.getRotated(this.rotation).scale(1/this.scale);return new Rect(new Position2D(this.position.x-a.width/2,this.position.y-a.height/2),a)},a.prototype.startAnimation=function(a){this._currentAnimation=a,this._lastAnimTime=(new Date).valueOf(),this.scale=this.scale},a.prototype.getAbsolutePosition=function(a){var b=this.asRectInArea().getPoints(),c=b.upperLeft;switch(this.rotation){case 90:c=b.lowerLeft;break;case 180:c=b.lowerRight;break;case 270:c=b.upperRight}var d=a.scale(1/this.scale).rotate(this.rotation);return new Position2D(c.x+d.x,c.y+d.y)},a.prototype.stopAnimation=function(){this._currentAnimation=null},a.prototype.updateAnimation=function(){if(null!=this._currentAnimation){var a=(new Date).valueOf();this._currentAnimation.updateAnimation(a-this._lastAnimTime)?this._currentAnimation=null:this._lastAnimTime=(new Date).valueOf()}},Object.defineProperty(a.prototype,"currentAnimation",{get:function(){return this._currentAnimation},enumerable:!0,configurable:!0}),a.prototype.setRect=function(a){this.size.width>0&&this.size.height>0&&(this.scale=Math.min(this.size.width/a.size.width,this.size.height/a.size.height)),this.position=a.getMiddlePoint()},a}();a.Viewport=b}(a.canvas||(a.canvas={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(){this._pages=new Array,this._pageAreaInformationMap=new MyCoReMap,this._updateCallback=null}return Object.defineProperty(a.prototype,"updateCallback",{get:function(){return null==this._updateCallback?function(){}:this._updateCallback},set:function(a){this._updateCallback=a},enumerable:!0,configurable:!0}),a.prototype.addPage=function(a,b){this.setPageAreaInformation(a,b),this._pages.push(a),this.registerPageAreaInformationEvents(b),this.updateCallback()},a.prototype.removePage=function(a){this._pages.splice(this._pages.indexOf(a),1);var b=this._pageAreaInformationMap.get(a);this._pageAreaInformationMap.remove(a),this.unregisterPageAreaInformationEvents(b),this.updateCallback()},a.prototype.propertyChanged=function(a,b){this._updateCallback()},a.prototype.setPageAreaInformation=function(a,b){this._pageAreaInformationMap.set(a,b)},a.prototype.getPages=function(){return this._pages},a.prototype.getPagesInViewport=function(a){var b=this,c=this._pages,d=new Array;return c.forEach(function(c){b.pageIntersectViewport(c,a)&&d.push(c)}),d},a.prototype.getPageInformation=function(a){return this._pageAreaInformationMap.get(a)},a.prototype.pageIntersectViewport=function(a,b){var c=this._pageAreaInformationMap.get(a),d=a.size.getRotated(c.rotation).scale(c.scale),e=new Position2D(c.position.x-d.width/2,c.position.y-d.height/2),f=new Rect(e,d),g=b.asRectInArea();return null!=f.getIntersection(g)},a.prototype.registerPageAreaInformationEvents=function(a){a.positionProperty.addObserver(this),a.rotationProperty.addObserver(this),a.scaleProperty.addObserver(this)},a.prototype.unregisterPageAreaInformationEvents=function(a){a.positionProperty.removeObserver(this),a.rotationProperty.removeObserver(this),a.scaleProperty.removeObserver(this)},a}();a.PageArea=b;var c=function(){function a(){this._positionProperty=new ViewerProperty(this,"position",new Position2D(0,0)),this._scaleProperty=new ViewerProperty(this,"scale",1),this._rotationProperty=new ViewerProperty(this,"rotation",0)}return Object.defineProperty(a.prototype,"positionProperty",{get:function(){return this._positionProperty},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"rotationProperty",{get:function(){return this._rotationProperty},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scaleProperty",{get:function(){return this._scaleProperty},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"rotation",{get:function(){return this._rotationProperty.value},set:function(a){this.rotationProperty.value=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scale",{get:function(){return this.scaleProperty.value},set:function(a){this.scaleProperty.value=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"position",{get:function(){return this.positionProperty.value},set:function(a){this.positionProperty.value=a},enumerable:!0,configurable:!0}),a}();a.PageAreaInformation=c}(a.canvas||(a.canvas={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(){}return a.centerViewportOnPage=function(a,b){a.position=b.position},a.fitViewportOverPage=function(b,c,d){if(0!=b.size.width&&0!=b.size.height){a.centerViewportOnPage(b,c);var e=b.size.getRotated(b.rotation);b.scale=Math.min(e.width/d.size.width,e.height/d.size.height)}else{var f={propertyChanged:function(e,g){a.fitViewportOverPage(b,c,d),b.sizeProperty.removeObserver(f)}};b.sizeProperty.addObserver(f)}},a.fitViewportOverPageWidth=function(a,b,c){if(0!=a.size.width&&0!=a.size.height){var d=c.size.getRotated(a.rotation).scale(b.scale);a.scale=a.size.width/d.width;var e=(a.size.getRotated(a.rotation),0==a.rotation||180==a.rotation?a.position:new Position2D(a.position.y,a.position.x)),f=Math.max(e.y,b.position.y-d.height/2+a.size.scale(1/a.scale).height/2);f=Math.min(f,b.position.y+d.height/2-a.size.scale(1/a.scale).height/2),a.size.height>d.scale(a.scale).width&&(f=0),0==a.rotation||180==a.rotation?a.position=new Position2D(b.position.x,f):a.position=new Position2D(f,b.position.x)}},a}();a.ViewportTools=b}(a.canvas||(a.canvas={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(){this.isRunning=!1,this.isFinished=!1,this.isPaused=!1,this.totalElapsedTime=0}return a.prototype.updateAnimation=function(a){return this.isPaused||this.isFinished?this.isFinished:(this.isRunning||(a=0,this.totalElapsedTime=0),this.totalElapsedTime+=a,this.isFinished=this.update(a),this.isRunning=!this.isFinished,this.isFinished)},a.prototype.pause=function(){this.isPaused=!0},a.prototype.continue=function(){this.isPaused=!1},a}();a.StatefulAnimation=b}(a.canvas||(a.canvas={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){function b(a,b,c){return a+(b-a)*c}var c=function(a){function c(c,d,e,f){void 0===f&&(f=b),a.call(this),this.duration=c,this.from=d,this.to=e,this.interpolationFunction=f,this.value=this.from}return __extends(c,a),c.prototype.update=function(a){if(this.totalElapsedTime>=this.duration)return this.totalElapsedTime=this.duration,this.value=this.to,!0;var b=this.totalElapsedTime/this.duration;return this.value=this.interpolationFunction(this.from,this.to,b),!1},c}(a.StatefulAnimation);a.InterpolationAnimation=c}(a.canvas||(a.canvas={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a,b,c){this._vp=a,this._area=b,this._view=c,this._addedPages=new Array,this._pageElementCache=new MyCoReMap,this._idPageMap=new MyCoReMap,this._addedContentMap=new MyCoReMap,this.htmlContainer=document.createElement("div"),this.htmlContainer.setAttribute("class","textContainer"),this._view.container[0].appendChild(this.htmlContainer)}return a.prototype.update=function(){var a=this,b=this._area.getPagesInViewport(this._vp);b.forEach(function(b){if(a._idPageMap.has(b.id)||a._idPageMap.set(b.id,b),-1==a._addedPages.indexOf(b)&&a.addPage(b),!a._addedContentMap.has(b)&&"getHTMLContent"in b){var c=b.getHTMLContent();a._addedContentMap.set(b,c);var d={propertyChanged:function(c,d){if(null!=d.value){var e=a._pageElementCache.get(b),f=e.querySelector("div div");f.innerHTML="",f.appendChild(d.value)}}};c.addObserver(d),d.propertyChanged(null,c)}a.updatePage(b)}),this._addedPages.forEach(function(c){-1==b.indexOf(c)&&a.removePage(c)})},a.prototype.updatePage=function(a){var b=this._area.getPageInformation(a),c=a.size.scale(b.scale),d=c.scale(.5),e=new Rect(new Position2D(b.position.x-d.width,b.position.y-d.height),c),f=this._vp.asRectInArea(),g=window.devicePixelRatio||1,h=new Position2D(e.pos.x-f.pos.x,e.pos.y-f.pos.y),i=h.scale(this._vp.scale/g),j=this._pageElementCache.get(a),k=c.scale(1/b.scale);j.style.cssText="\n                position: absolute;\n                transform-origin : 0% 0%;\n                width : "+k.width+"px;\n                height : "+k.height+"px;\n                transform : translate("+Math.round(i.x)+"px,"+Math.round(i.y)+"px) scale("+b.scale*this._vp.scale/g+");\n                ",j.children[0].style.cssText="transform : rotate("+b.rotation+"deg);width: "+k.width+"px;height: "+k.height+"px;background-color : transparent;"},a.prototype.addPage=function(a){this._pageElementCache.has(a)||this.createPageElement(a);var b=this._pageElementCache.get(a);this._addedPages.push(a),this.htmlContainer.appendChild(b)},a.prototype.createPageElement=function(a){var b=document.createElement("div"),c=b.cloneNode();b.appendChild(c),this._pageElementCache.set(a,b)},a.prototype.removePage=function(a){this._addedPages.splice(this._addedPages.indexOf(a),1);var b=this._pageElementCache.get(a);b.parentElement.removeChild(b)},a}();a.HtmlRenderer=b}(a.canvas||(a.canvas={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d,e){this._vp=a,this._area=b,this._view=c,this._textContentProvider=d,this.pageLinkClicked=e,this._contentCache=new MyCoReMap,this._callbackRunning=new MyCoReMap,this._addedPages=new Array,this._elementCache=new MyCoReMap,this._pageElementCache=new MyCoReMap,this._lineElementMap=new MyCoReMap,this._highlightWordMap=null,this._idPageMap=new MyCoReMap,this._mesureCanvas=document.createElement("canvas").getContext("2d"),this.textContainer=document.createElement("div"),this.textContainer.style.cssText="line-height: 1;white-space: pre;font-family: sans-serif",this.textContainer.setAttribute("class","textContainer"),this._view.container[0].appendChild(this.textContainer)}return a.prototype.update=function(){var a=this,b=this._area.getPagesInViewport(this._vp);b.forEach(function(b){if(a._idPageMap.has(b.id)||a._idPageMap.set(b.id,b),-1==a._addedPages.indexOf(b)&&a.addPage(b),a._contentCache.has(b)||a._callbackRunning.has(b))a._contentCache.has(b)&&a.updatePage(b);else{a._textContentProvider(b,function(c){a._contentCache.set(b,c),a.addPageParts(b,c)});a._callbackRunning.set(b,!0)}}),this._addedPages.forEach(function(c){-1==b.indexOf(c)&&a.removePage(c)})},a.prototype.updatePage=function(a){var b=this._area.getPageInformation(a),c=a.size.scale(b.scale),d=c.scale(.5),e=new Rect(new Position2D(b.position.x-d.width,b.position.y-d.height),c),f=this._vp.asRectInArea(),g=window.devicePixelRatio||1,h=new Position2D(e.pos.x-f.pos.x,e.pos.y-f.pos.y),i=h.scale(this._vp.scale/g),j=this._pageElementCache.get(a),k=c.scale(1/b.scale);j.style.cssText="transform-origin : 0% 0%;position : absolute;left : "+i.x+"px;top : "+i.y+"px;width : "+k.width+"px;height : "+k.height+"px;transform : scale("+b.scale*this._vp.scale/g+");z-index: 5;",j.children[0].style.cssText="transform : rotate("+b.rotation+"deg);width: "+k.width+"px;height: "+k.height+"px;"},a.prototype.addPage=function(a){this._pageElementCache.has(a)||this.createPageElement(a);var b=this._pageElementCache.get(a);this._addedPages.push(a),this.textContainer.appendChild(b)},a.prototype.createPageElement=function(a){var b=document.createElement("div"),c=b.cloneNode();b.appendChild(c),this._pageElementCache.set(a,b),b.style.display="none"},a.prototype.removePage=function(a){this._addedPages.splice(this._addedPages.indexOf(a),1);var b=this._pageElementCache.get(a);b.parentElement.removeChild(b)},
a.prototype.addPageParts=function(a,b){var c=this,d=document.createDocumentFragment();b.content.forEach(function(b){var e=b.pos.toString()+b.text;if(!c._elementCache.has(e)){var f=c.createContentPart(a,b);d.appendChild(f)}}),b.links.forEach(function(a){var b=a.rect.toString()+a.url;if(!c._elementCache.has(b)){var e=document.createElement("a");e.setAttribute("href",a.url),e.style.left=a.rect.getX()+"px",e.style.top=a.rect.getY()+"px",e.style.width=a.rect.getWidth()+"px",e.style.height=a.rect.getHeight()+"px",e.style.display="block",e.style.position="fixed",e.style.zIndex="8",e.setAttribute("target","_blank"),c._elementCache.set(b,e),d.appendChild(e)}}),b.internLinks.forEach(function(a){var b=a.rect.toString()+"DEST";if(!c._elementCache.has(b)){var e=document.createElement("a");e.style.left=a.rect.getX()+"px",e.style.top=a.rect.getY()+"px",e.style.width=a.rect.getWidth()+"px",e.style.height=a.rect.getHeight()+"px",e.style.display="block",e.style.position="fixed",e.style.zIndex="8",e.style.cursor="pointer",e.addEventListener("click",function(){a.pageNumberResolver(function(a){c.pageLinkClicked(a)})}),c._elementCache.set(b,e),d.appendChild(e)}});var e=this._pageElementCache.get(a).children[0];e.appendChild(d),"none"==e.style.display&&(e.style.display="block")},a.prototype.removeContentPart=function(a){var b=this._lineElementMap.get(a);b.parentElement.removeChild(b),this._lineElementMap.remove(a)},a.prototype.createContentPart=function(a,b){var c=window.document.createElement("div");c.textContent=b.text,c.setAttribute("class","line");var d=function(a){a.stopPropagation()};c.addEventListener("mousedown",d),c.addEventListener("mouseup",d),c.addEventListener("mousemove",d),c.addEventListener("mouseenter",function(){"mouseenter"in b&&"function"==typeof b.mouseenter&&b.mouseenter()}),c.addEventListener("mouseleave",function(){"mouseleave"in b&&"function"==typeof b.mouseleave&&b.mouseleave()});var e=a.size,f=b.pos.toString()+b.text;this._elementCache.set(f,c),this._mesureCanvas.save(),this._mesureCanvas.font=b.fontSize+"px "+b.fontFamily;var g=this._mesureCanvas.measureText(b.text).width;this._mesureCanvas.restore();var h=b.size.width/g;this._lineElementMap.set(b,c);var i="fromBottomLeft"in b&&!b.fromBottomLeft?b.pos.y:e.height-b.pos.y;return c.style.cssText="left : "+b.pos.x+"px;top : "+i+"px;font-family : "+b.fontFamily+";font-size : "+b.fontSize+"px;transform-origin : 0% 0%;transform : scalex("+h+");",c},a}();a.TextRenderer=b}(a.canvas||(a.canvas={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(b,c){void 0===b&&(b=!0),void 0===c&&(c=!0),this.drawImage=b,this.drawHTML=c,this.container=jQuery("<div></div>"),this.drawCanvas=null,this.markCanvas=null;var d=b&&c?"grayscale(1) contrast(1000%)":null;this.drawCanvas=a.createCanvas(1,d),this.markCanvas=a.createCanvas(4),jQuery(this.drawCanvas).appendTo(this.container),jQuery(this.markCanvas).appendTo(this.container),this.container.css({position:"absolute",top:"0px",left:"0px",bottom:"0px",right:"0px",overflow:"hidden"});var e=this.drawCanvas.getContext("2d"),f=this.markCanvas.getContext("2d");"imageSmoothingEnabled"in e&&(e.imageSmoothingEnabled=!1,f.imageSmoothingEnabled=!1)}return a.createCanvas=function(a,b){void 0===a&&(a=1);var c=document.createElement("canvas");return c.style.transform="scale(1.0)",c.style.position="absolute",c.style.zIndex=a+"",b&&(c.style.filter=b),c},a}();a.PageView=b}(a.canvas||(a.canvas={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a){var b=this;this._horizontal=a,this._areaSize=null,this._viewSize=null,this._position=null,this._mouseDown=-1,this._scrollhandler=null,this._cachedScrollbarElementSize=null,this._cacheTime=-1,this.initElements();var c=jQuery(document.body),d=function(a){if(-1!=b._mouseDown){var c=(b._horizontal?a.clientX-b._scrollbarElement.offset().left:a.clientY-b._scrollbarElement.offset().top)-b._mouseDown,d=(b._horizontal?b._scrollbarElement.width():b._scrollbarElement.height())-30,e=d/b._areaSize;b._position=c/e,b.update(),null!=b.scrollHandler&&b.scrollHandler(),a.preventDefault()}},e=function(a){b._mouseDown=-1,-1!=f&&(window.clearInterval(f),f=-1,a.preventDefault()),c.unbind("mousemove",d)};this._slider.mousedown(function(a){b._mouseDown=b._horizontal?a.clientX-b._slider.offset().left:a.clientY-b._slider.offset().top,c.bind("mousemove",d),c.bind("mouseup",e),a.preventDefault()}),this._scrollbarElement.mousedown(function(a){if(!jQuery(a.target).hasClass("slider")){var c=b._horizontal?a.clientX-b._scrollbarElement.offset().left:a.clientY-b._scrollbarElement.offset().top,d=(b._horizontal?b._scrollbarElement.width():b._scrollbarElement.height())-30,e=d/b._areaSize,f=Math.min(Math.max(20,b._viewSize*e),d);b._position=(c-f/2)/e,b.update(),null!=b.scrollHandler&&b.scrollHandler()}});var f=-1;this._startButton.mousedown(function(a){b._position-=200,b.scrollHandler(),a.preventDefault(),a.stopImmediatePropagation(),f=window.setInterval(function(){b._position-=200,b.scrollHandler()},111)}),this._endButton.mousedown(function(a){b._position+=200,b.scrollHandler(),a.preventDefault(),a.stopImmediatePropagation(),f=window.setInterval(function(){b._position+=200,b.scrollHandler()},111)}),jQuery(document.body).mousemove(function(a){if(-1!=b._mouseDown){var c=(b._horizontal?a.clientX-b._scrollbarElement.offset().left:a.clientY-b._scrollbarElement.offset().top)-b._mouseDown,d=(b._horizontal?b._scrollbarElement.width():b._scrollbarElement.height())-30,e=d/b._areaSize;b._position=c/e,b.update(),null!=b.scrollHandler&&b.scrollHandler()}}),jQuery(document.body).mouseup(function(a){b._mouseDown=-1,-1!=f&&(window.clearInterval(f),f=-1)})}return a.prototype.clearRunning=function(){this._mouseDown=-1},a.prototype.initElements=function(){this._className=this._horizontal?"horizontal":"vertical",this._scrollbarElement=jQuery("<div></div>"),this._scrollbarElement.addClass(this._className+"Bar"),this._slider=jQuery("<div></div>"),this._slider.addClass("slider"),this._startButton=jQuery("<div></div>"),this._startButton.addClass("startButton"),this._endButton=jQuery("<div></div>"),this._endButton.addClass("endButton"),this._startButton.appendTo(this._scrollbarElement),this._slider.appendTo(this._scrollbarElement),this._endButton.appendTo(this._scrollbarElement)},Object.defineProperty(a.prototype,"viewSize",{get:function(){return this._viewSize},set:function(a){this._viewSize=a,this.update()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"areaSize",{get:function(){return this._areaSize},set:function(a){this._areaSize=a,this.update()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"position",{get:function(){return this._position},set:function(a){this._position=a,this.update()},enumerable:!0,configurable:!0}),a.prototype.update=function(){if(null!=this._areaSize&&null!=this._viewSize&&null!=this._position){var a=this.getScrollbarElementSize.call(this),b=(this._horizontal?a.width:a.height)-30,c=b/this._areaSize,d=Math.min(Math.max(20,this._viewSize*c),b),e=this._horizontal?"width":"height",f={};f[e]=d+"px",this._slider.css(f),c=(b-(d-this._viewSize*c))/this._areaSize;var g=Math.max(this._position*c+15,15),h=this._horizontal?"left":"top",i={};i[h]=g+"px",this._slider.css(i)}},a.prototype.getScrollbarElementSize=function(){var a=(new Date).getTime();if(null==this._cachedScrollbarElementSize||a-1e3>this._cacheTime){var b=this._scrollbarElement.height(),c=this._scrollbarElement.width();this._cachedScrollbarElementSize=new Size2D(c,b),this._cacheTime=(new Date).getTime()}return this._cachedScrollbarElementSize},a.prototype.resized=function(){this._cachedScrollbarElementSize=null},Object.defineProperty(a.prototype,"scrollbarElement",{get:function(){return this._scrollbarElement},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollHandler",{get:function(){return this._scrollhandler},set:function(a){this._scrollhandler=a},enumerable:!0,configurable:!0}),a}();a.Scrollbar=b}(a.canvas||(a.canvas={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(b){function c(c,d){void 0===d&&(d=new Size2D(250,250)),b.call(this,!0,!1),this.vp=c,this._maxOverviewSize=d,this.overviewViewport=new a.Viewport,this.container.addClass("overview"),this.container.attr("style",""),this.container.css("z-index","6"),jQuery(this.markCanvas).detach()}return __extends(c,b),c.prototype.updateOverviewSize=function(a){a=a.roundUp(),this.container[0].style.width=a.width+"px",this.container[0].style.height=a.height+"px",this.drawCanvas.width==a.width&&this.drawCanvas.height==a.height&&this.markCanvas.width==a.width&&this.markCanvas.height==a.height||(this.drawCanvas.width=a.width,this.drawCanvas.height=a.height,this.markCanvas.width=a.width,this.markCanvas.height=a.height),this.overviewViewport.size=a},Object.defineProperty(c.prototype,"overviewRect",{get:function(){return this.overviewViewport.asRectInArea()},set:function(a){this.overviewViewport.position=a.getMiddlePoint();var b,c=this.overviewViewport.scale=Math.min(this._maxOverviewSize.width/a.size.width,this._maxOverviewSize.height/a.size.height),d=this._maxOverviewSize.width/a.size.width==c;if(d){var e=a.size.width/a.size.height;b=new Size2D(this._maxOverviewSize.width,this._maxOverviewSize.height/e)}else{var e=a.size.height/a.size.width;b=new Size2D(this._maxOverviewSize.width/e,this._maxOverviewSize.height)}this.updateOverviewSize(b),this._overviewRect=a},enumerable:!0,configurable:!0}),c.prototype.drawRect=function(){var a=this.drawCanvas.getContext("2d"),b=this.overviewViewport.asRectInArea(),c=this.vp.asRectInArea(),d=500,e=new Position2D(c.pos.x-b.pos.x,c.pos.y-b.pos.y);e=e.scale(this.overviewViewport.scale);var f=this.vp.asRectInArea().size.scale(this.overviewViewport.scale);a.save(),a.lineWidth=d,a.strokeStyle="rgba(0,0,0,0.5)",a.translate(-d/2,-d/2),a.strokeRect(e.x,e.y,f.width+d,f.height+d),a.restore()},c.prototype.initEventHandler=function(){var a=this,b=function(b){b.preventDefault();var c=b.clientX+window.pageXOffset-jQuery(b.target).offset().left,d=b.clientY+window.pageYOffset-jQuery(b.target).offset().top,e=new Position2D(c,d),f=e.scale(1/a.overviewViewport.scale),g=a.overviewViewport.asRectInArea().getPoints().upperLeft,h=new Position2D(f.x+g.x,f.y+g.y);a.vp.position=h,b.stopImmediatePropagation()};jQuery(this.drawCanvas).mousedown(function(c){jQuery(a.drawCanvas).bind("mousemove",b)}),jQuery(this.drawCanvas).mouseup(function(c){jQuery(a.drawCanvas).unbind("mousemove",b)}),jQuery(this.drawCanvas).mouseout(function(c){jQuery(a.drawCanvas).unbind("mousemove",b)})},c}(a.PageView);a.Overview=b}(a.canvas||(a.canvas={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function b(b){var c=this;void 0===b&&(b=!1),this.miniOverview=b,this._lastSize=new Size2D(0,0),this._requestRunning=!1,this._nextRequested=!1,this._pageArea=new a.PageArea,this._viewport=new a.Viewport,this._views=new Array,this._viewHTMLRendererMap=new MyCoReMap,this._textRenderer=null,this._canvasPageLayers=new MyCoReMap,this._lastAnimationTime=null,this._animations=new Array,this._overview=null,this._pageArea.updateCallback=function(){c.update()},this._updateSizeIfChanged(),this._registerViewport()}return b.prototype._updateSizeIfChanged=function(){var a=this;this._views.forEach(function(b){var c=b.container.width()*(window.devicePixelRatio||1),d=b.container.height()*(window.devicePixelRatio||1);b.drawCanvas.width==c&&b.drawCanvas.height==d&&b.markCanvas.width==c&&b.markCanvas.height==d||a._updateSize(b)})},b.prototype._updateSize=function(a){a.drawCanvas.width=a.container.width()*(window.devicePixelRatio||1),a.drawCanvas.height=a.container.height()*(window.devicePixelRatio||1),a.markCanvas.width=a.container.width()*(window.devicePixelRatio||1),a.markCanvas.height=a.container.height()*(window.devicePixelRatio||1),this._lastSize=new Size2D(a.drawCanvas.width,a.drawCanvas.height),this._viewport.size=new Size2D(a.drawCanvas.width,a.drawCanvas.height)},b.prototype._unregisterViewport=function(){null!=this._viewport&&(this._viewport.sizeProperty.removeAllObserver(),this._viewport.positionProperty.removeAllObserver(),this._viewport.scaleProperty.removeAllObserver(),this._viewport.rotationProperty.removeAllObserver())},b.prototype._registerViewport=function(){var a=this,b={propertyChanged:function(b,c){a.update()}};this._viewport.sizeProperty.addObserver(b),this._viewport.positionProperty.addObserver(b),this._viewport.scaleProperty.addObserver(b),this._viewport.rotationProperty.addObserver(b)},b.prototype.update=function(){var b=this;this._nextRequested||(this._nextRequested=!0,this._requestRunning||(this._requestRunning=!0,viewerRequestAnimationFrame(function(){b._nextRequested=!1,b._updateSizeIfChanged(),b.updateAnimations(),b._views.forEach(function(c){if(c.drawHTML){var d;b._viewHTMLRendererMap.has(c)?d=b._viewHTMLRendererMap.get(c):(d=new a.HtmlRenderer(b._viewport,b._pageArea,c),b._viewHTMLRendererMap.set(c,d)),d.update()}b.drawOnView(c,b.viewport,!c.drawImage)}),null!=b._textRenderer&&b._textRenderer.update(),null!=b._overview&&(b.drawOnView(b._overview,b._overview.overviewViewport),b._overview.drawRect())}),this._requestRunning=!1))},b.prototype.drawOnView=function(a,b,c){var d=this;if(void 0===b&&(b=this._viewport),void 0===c&&(c=!1),null!=a&&null!=b){a.drawCanvas.width=a.drawCanvas.width,a.markCanvas.width=a.markCanvas.width;var e=b.size.getRotated(b.rotation),f=a.drawCanvas.getContext("2d"),g=a.markCanvas.getContext("2d");f.save(),g.save(),f.translate(b.size.width/2,b.size.height/2),f.rotate(b.rotation*Math.PI/180),f.translate(-e.width/2,-e.height/2),g.translate(b.size.width/2,b.size.height/2),g.rotate(b.rotation*Math.PI/180),g.translate(-e.width/2,-e.height/2),this._pageArea.getPagesInViewport(b).forEach(function(e){d.drawPage(e,d._pageArea.getPageInformation(e),b.asRectInArea(),b.scale,b!=d._viewport,a,c)}),f.restore(),g.restore()}},b.prototype.drawPage=function(a,b,c,d,e,f,g){void 0===g&&(g=!1);var h=a.size.getRotated(b.rotation).scale(b.scale),i=new Rect(new Position2D(b.position.x-h.width/2,b.position.y-h.height/2),h),j=c.getIntersection(i),k=new Rect(new Position2D(Math.max(0,j.pos.x-i.pos.x),Math.max(0,j.pos.y-i.pos.y)),j.size),l=function(a,b,c){if(0==a)return b;var d=b.pos.y,e=c.width-b.pos.x-b.size.width,f=new Rect(new Position2D(d,e),b.size.getRotated(90));return 90==a?f:l(a-90,f,c.getRotated(90))},m=l(b.rotation,k,h),n=a.size.scale(b.scale),o=f.drawCanvas.getContext("2d"),p=f.markCanvas.getContext("2d");o.save(),p.save(),o.translate(Math.floor((-c.pos.x+b.position.x)*d),Math.floor((-c.pos.y+b.position.y)*d)),o.rotate(b.rotation*Math.PI/180),o.translate(Math.floor((-n.width/2+m.pos.x)*d),Math.floor((-n.height/2+m.pos.y)*d)),p.translate(Math.floor((-c.pos.x+b.position.x)*d),Math.floor(-c.pos.y+b.position.y)*d),p.rotate(b.rotation*Math.PI/180),p.translate((Math.floor(-n.width/2)+m.pos.x)*d,Math.floor(-n.height/2+m.pos.y)*d);var q=m.scale(1/b.scale);if(q=new Rect(q.pos.roundDown(),q.size.roundDown()),g||a.draw(o,q,d*b.scale,e),p.translate(-q.pos.x*d*b.scale,-q.pos.y*d*b.scale),!e){p.scale(d*b.scale,d*b.scale);this.getCanvasPageLayersOrdered().forEach(function(b){b.draw(p,a.id,a.size,f.drawHTML)}),p.scale(1/d*b.scale,1/d*b.scale)}o.restore(),p.restore()},b.prototype.updateAnimations=function(){var a=this;if(this._viewport.updateAnimation(),0==this._animations.length)return void(this._lastAnimationTime=null);null==this._lastAnimationTime&&(this._lastAnimationTime=(new Date).valueOf());for(var b=(new Date).valueOf()-this._lastAnimationTime,c=[],d=0,e=this._animations;d<e.length;d++){var f=e[d];f.updateAnimation(b)&&c.push(f)}if(c.forEach(function(b){a.removeAnimation(b)}),0==this._animations.length)return void(this._lastAnimationTime=null);setTimeout(function(){a.update()},0)},b.prototype.addAnimation=function(a){this._animations.push(a)},b.prototype.removeAnimation=function(a){var b=this._animations.indexOf(a);b>=0&&this._animations.splice(b,1)},Object.defineProperty(b.prototype,"viewport",{get:function(){return this._viewport},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"views",{get:function(){return this._views},enumerable:!0,configurable:!0}),b.prototype.addPage=function(a,b){var c=this;a.refreshCallback=function(){c.update()},this._pageArea.addPage(a,b)},b.prototype.removePage=function(a){a.refreshCallback=function(){},a.clear(),this._pageArea.removePage(a)},b.prototype.getPages=function(){return this._pageArea.getPages()},b.prototype.setPageAreaInformation=function(a,b){this._pageArea.setPageAreaInformation(a,b)},b.prototype.getPageAreaInformation=function(a){return this._pageArea.getPageInformation(a)},b.prototype.addCanvasPageLayer=function(a,b){this._canvasPageLayers.set(a,b)},b.prototype.getCanvasPageLayers=function(){return this._canvasPageLayers},b.prototype.getCanvasPageLayersOrdered=function(){var a=this;if(null==this._canvasPageLayers||this._canvasPageLayers.isEmpty())return[];var b=[];return this._canvasPageLayers.keys.sort().forEach(function(c){b.push(a._canvasPageLayers.get(c))}),b},b.prototype.getPageArea=function(){return this._pageArea},Object.defineProperty(b.prototype,"textRenderer",{get:function(){return this._textRenderer},set:function(a){this._textRenderer=a},enumerable:!0,configurable:!0}),b}();a.PageController=b}(a.canvas||(a.canvas={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(){this._callBackArray=new Array}return a.prototype.bind=function(a){this._callBackArray.push(a)},a.prototype.trigger=function(a){for(var b in this._callBackArray){(0,this._callBackArray[b])(a)}},a.prototype.unbind=function(a){var b=this._callBackArray.lastIndexOf(a);this._callBackArray.splice(b,1)},a}();a.ViewerEventManager=b}(a.events||(a.events={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){a.toolbar||(a.toolbar={})}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a){this._properties=new MyCoReMap,this.addProperty(new ViewerProperty(this,"id",a))}return Object.defineProperty(a.prototype,"id",{get:function(){return this.getProperty("id").value},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"PropertyNames",{get:function(){return this._properties.keys},enumerable:!0,configurable:!0}),a.prototype.addProperty=function(a){this._properties.set(a.name,a)},a.prototype.getProperty=function(a){return this._properties.get(a)},a.prototype.hasProperty=function(a){return this._properties.has(a)},a}();a.ToolbarComponent=b}(a.toolbar||(a.toolbar={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a,b){void 0===b&&(b=!1),this._name=a,this._right=b,this._idComponentMap=new MyCoReMap,this._observerArray=new Array}return a.prototype.getComponentById=function(a){return this._idComponentMap.get(a)},a.prototype.addComponent=function(a){var b=a.getProperty("id").value;if(this._idComponentMap.has(b))throw new Error(b+" already exist in "+this.name);this._idComponentMap.set(b,a),this.notifyObserverChildAdded(this,a)},a.prototype.removeComponent=function(a){var b=a.getProperty("id").value;if(!this._idComponentMap.has(b))throw new Error(b+" doesnt exist in "+this.name);this._idComponentMap.remove(b),this.notifyObserverChildRemoved(this,a)},a.prototype.getComponentIDs=function(){return this._idComponentMap.keys},a.prototype.getComponents=function(){return this._idComponentMap.values},a.prototype.addObserver=function(a){this._observerArray.push(a)},a.prototype.removeObserver=function(a){var b=this._observerArray.indexOf(a);this._observerArray.splice(b,1)},Object.defineProperty(a.prototype,"observer",{get:function(){return this._observerArray},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"align",{get:function(){return this._right?"right":"left"},enumerable:!0,configurable:!0}),a.prototype.notifyObserverChildAdded=function(a,b){this._observerArray.forEach(function(c){c.childAdded(a,b)})},a.prototype.notifyObserverChildRemoved=function(a,b){this._observerArray.forEach(function(c){c.childRemoved(a,b)})},a}();a.ToolbarGroup=b}(a.toolbar||(a.toolbar={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(b){var c=function(a){function b(b){a.call(this,b),this._children=new MyCoReMap,this._groupObserverArray=new Array}return __extends(b,a),b.prototype.addGroup=function(a){if(this._children.has(a.name))throw new Error("Group : "+a.name+" already exists in "+this.name);this._children.set(a.name,a),a.addObserver(this),this.notifyGroupAdded(this,a)},b.prototype.removeGroup=function(a){if(!this._children.has(a.name))throw new Error("Group : "+a.name+" doesnt exists in "+this.name);this._children.remove(a.name),a.removeObserver(this),this.notifyGroupRemoved(this,a)},b.prototype.getGroup=function(a){return this._children.get(a)},b.prototype.getGroupIDs=function(){return this._children.keys},b.prototype.getGroups=function(){return this._children.values},b.prototype.childAdded=function(a,b){this.notifyObserverChildAdded(a,b)},b.prototype.childRemoved=function(a,b){this.notifyObserverChildRemoved(a,b)},b.prototype.addGroupObserver=function(a){this._groupObserverArray.push(a)},b.prototype.removeGroupObserver=function(a){var b=this._groupObserverArray.indexOf(a);this._groupObserverArray.splice(b,1)},b.prototype.notifyGroupAdded=function(a,b){this._groupObserverArray.forEach(function(c){c.childAdded(a,b)})},b.prototype.notifyGroupRemoved=function(a,b){this._groupObserverArray.forEach(function(c){c.childRemoved(a,b)})},b.prototype.addComponent=function(a){throw"Not added jet"},b.prototype.removeComponent=function(a){throw"Not added jet"},b}(a.toolbar.ToolbarGroup);b.ToolbarModel=c}(a.toolbar||(a.toolbar={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(b,c,d,e,f,g,h){void 0===d&&(d=c),void 0===e&&(e=null),void 0===f&&(f="default"),void 0===g&&(g=!1),void 0===h&&(h=!1),a.call(this,b),this.addProperty(new ViewerProperty(this,"label",c)),this.addProperty(new ViewerProperty(this,"tooltip",d)),this.addProperty(new ViewerProperty(this,"icon",e)),this.addProperty(new ViewerProperty(this,"buttonClass",f)),this.addProperty(new ViewerProperty(this,"disabled",!1)),this.addProperty(new ViewerProperty(this,"active",!1))}return __extends(b,a),Object.defineProperty(b.prototype,"label",{get:function(){return this.getProperty("label").value},set:function(a){this.getProperty("label").value=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"tooltip",{get:function(){return this.getProperty("tooltip").value},set:function(a){this.getProperty("tooltip").value=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"icon",{get:function(){return this.getProperty("icon").value},set:function(a){this.getProperty("icon").value=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"buttonClass",{get:function(){return this.getProperty("buttonClass").value},set:function(a){this.getProperty("buttonClass").value=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"disabled",{get:function(){return this.getProperty("disabled").value},set:function(a){this.getProperty("disabled").value=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"active",{get:function(){return this.getProperty("active").value},set:function(a){this.getProperty("active").value=a},enumerable:!0,configurable:!0}),b}(a.ToolbarComponent);a.ToolbarButton=b}(a.toolbar||(a.toolbar={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(b){!function(b){!function(b){!function(b){var c=function(a){function b(c,d){void 0===d&&(d=b.TYPE),a.call(this,d),this._button=c}return __extends(b,a),Object.defineProperty(b.prototype,"button",{get:function(){return this._button},enumerable:!0,configurable:!0}),b.TYPE="ButtonPressedEvent",b}(a.viewer.widgets.events.DefaultViewerEvent);b.ButtonPressedEvent=c}(b.events||(b.events={}))}(b.toolbar||(b.toolbar={}))}(b.widgets||(b.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(b){!function(b){!function(b){var c=function(){function c(b,c,d){this._groupMap=b,this._buttonViewMap=c,this._mobile=d,this._eventManager=new a.viewer.widgets.events.ViewerEventManager}return Object.defineProperty(c.prototype,"eventManager",{get:function(){return this._eventManager},enumerable:!0,configurable:!0}),c.prototype.childAdded=function(a,c){var d=a,e=this._groupMap.get(d.name),f=c.getProperty("id").value,g=c,h=g.getProperty("label"),i=g.getProperty("icon"),j=c.getProperty("tooltip"),k=g.getProperty("buttonClass"),l=g.getProperty("active"),m=g.getProperty("disabled");h.addObserver(this),i.addObserver(this),j.addObserver(this),k.addObserver(this),l.addObserver(this),m.addObserver(this);var n=this.createButtonView(g);n.updateButtonTooltip(j.value),n.updateButtonLabel(h.value),n.updateButtonClass(k.value),n.updateButtonActive(l.value),n.updateButtonDisabled(m.value);var o=this;n.getElement().bind("click",function(a){o._eventManager.trigger(new b.events.ButtonPressedEvent(g))});var p=i.value;null!=p&&n.updateButtonIcon(p),e.addChild(n.getElement()),this._buttonViewMap.set(f,n)},c.prototype.childRemoved=function(a,b){var c=b.getProperty("id").value;this._buttonViewMap.get(c).getElement().remove(),b.getProperty("label").removeObserver(this),b.getProperty("icon").removeObserver(this),b.getProperty("tooltip").removeObserver(this),b.getProperty("buttonClass").removeObserver(this),b.getProperty("active").removeObserver(this),b.getProperty("disabled").removeObserver(this)},c.prototype.createButtonView=function(a){return b.ToolbarViewFactoryImpl.createButtonView(a.id)},c.prototype.propertyChanged=function(a,b){var c=b.from.getProperty("id").value;return"label"==a.name&&"label"==b.name?void this._buttonViewMap.get(c).updateButtonLabel(b.value):"icon"==a.name&&"icon"==b.name?void this._buttonViewMap.get(c).updateButtonIcon(b.value):"tooltip"==a.name&&"tooltip"==b.name?void this._buttonViewMap.get(c).updateButtonTooltip(b.value):"buttonClass"==a.name&&"buttonClass"==b.name?void this._buttonViewMap.get(c).updateButtonClass(b.value):"active"==a.name&&"active"==b.name?void this._buttonViewMap.get(c).updateButtonActive(b.value):"disabled"==a.name&&"disabled"==b.name?void this._buttonViewMap.get(c).updateButtonDisabled(b.value):void 0},c}();b.ButtonController=c}(b.toolbar||(b.toolbar={}))}(b.widgets||(b.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(b,c,d,e,f,g,h,i){void 0===e&&(e=null),void 0===f&&(f=!1),void 0===g&&(g="default"),void 0===h&&(h=!1),void 0===i&&(i=!1),a.call(this,b,c,null,e,g,h,i),this.addProperty(new ViewerProperty(this,"children",d)),this.addProperty(new ViewerProperty(this,"largeContent",f))}return __extends(b,a),Object.defineProperty(b.prototype,"children",{get:function(){return this.getProperty("children").value},set:function(a){this.getProperty("children").value=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"largeContent",{get:function(){return this.getProperty("largeContent").value},set:function(a){this.getProperty("largeContent").value=a},enumerable:!0,configurable:!0}),b}(a.ToolbarButton);a.ToolbarDropdownButton=b}(a.toolbar||(a.toolbar={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(c,d){a.call(this,c,b.TYPE),this._childId=d}return __extends(b,a),Object.defineProperty(b.prototype,"childId",{get:function(){return this._childId},enumerable:!0,configurable:!0}),b.TYPE="DropdownButtonPressedEvent",b}(a.ButtonPressedEvent);a.DropdownButtonPressedEvent=b}(a.events||(a.events={}))}(a.toolbar||(a.toolbar={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(b){function c(a,c,d){void 0===d&&(d=!1),b.call(this,a,c,d),this._dropdownButtonViewMap=c,this.__mobile=d}return __extends(c,b),c.prototype.childAdded=function(a,c){b.prototype.childAdded.call(this,a,c);var d=c,e=c.getProperty("id").value,f=d.getProperty("children");f.addObserver(this),this._dropdownButtonViewMap.get(e).updateChilds(f.value),this.updateChildEvents(d,f.value)},c.prototype.updateChildEvents=function(b,c){var d=this._dropdownButtonViewMap.get(b.id),e=this;if(b.largeContent||this.__mobile)d.getElement().bind("change",function(c){return function(c){var d=jQuery(c.target),f=d.find(":selected");e.__mobile&&d.val([]),e.eventManager.trigger(new a.events.DropdownButtonPressedEvent(b,f.attr("data-id")))}}());else{var f=c;for(var g in f){d.getChildElement(f[g].id).bind("click",function(c){return function(){e.eventManager.trigger(new a.events.DropdownButtonPressedEvent(b,c.id))}}(f[g]))}}},c.prototype.childRemoved=function(a,c){b.prototype.childRemoved.call(this,a,c)},c.prototype.propertyChanged=function(a,c){"children"==c.name?(this._dropdownButtonViewMap.get(c.from.getProperty("id").value).updateChilds(c.value),this.updateChildEvents(c.from,c.value)):b.prototype.propertyChanged.call(this,a,c)},c.prototype.createButtonView=function(b){return!this.__mobile&&b.largeContent?a.ToolbarViewFactoryImpl.createLargeDropdownView(b.id):a.ToolbarViewFactoryImpl.createDropdownView(b.id)},c}(a.ButtonController);a.DropdownButtonController=b}(a.toolbar||(a.toolbar={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(b,c){a.call(this,b),this.addProperty(new ViewerProperty(this,"href",c))}return __extends(b,a),Object.defineProperty(b.prototype,"href",{get:function(){return this.getProperty("href").value},set:function(a){this.getProperty("href").value=a},enumerable:!0,configurable:!0}),b}(a.ToolbarComponent);a.ToolbarImage=b}(a.toolbar||(a.toolbar={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function b(a,b){this._groupMap=a,this._textViewMap=b}return b.prototype.childAdded=function(a,b){var c=a,d=this._groupMap.get(c.name),e=b.getProperty("id").value,f=b,g=this.createImageView(e),h=f.getProperty("href");h.addObserver(this),g.updateHref(h.value),d.addChild(g.getElement()),this._textViewMap.set(e,g)},b.prototype.childRemoved=function(a,b){var c=b.getProperty("id").value;this._textViewMap.get(c).getElement().remove(),b.getProperty("href").removeObserver(this)},b.prototype.propertyChanged=function(a,b){var c=b.from.getProperty("id").value;"href"==a.name&&"href"==b.name&&this._textViewMap.get(c).updateHref(b.value)},b.prototype.createImageView=function(b){return a.ToolbarViewFactoryImpl.createImageView(b)},b}();a.ImageController=b}(a.toolbar||(a.toolbar={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){
function b(b,c){a.call(this,b),this.addProperty(new ViewerProperty(this,"text",c))}return __extends(b,a),Object.defineProperty(b.prototype,"text",{get:function(){return this.getProperty("text").value},set:function(a){this.getProperty("text").value=a},enumerable:!0,configurable:!0}),b}(a.ToolbarComponent);a.ToolbarText=b}(a.toolbar||(a.toolbar={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function b(a,b,c){this._groupMap=a,this._textViewMap=b,this._mobile=c}return b.prototype.childAdded=function(a,b){var c=a,d=this._groupMap.get(c.name),e=b.getProperty("id").value,f=b,g=this.createTextView(e),h=f.getProperty("text");h.addObserver(this),g.updateText(h.value),d.addChild(g.getElement()),this._textViewMap.set(e,g)},b.prototype.childRemoved=function(a,b){var c=b.getProperty("id").value;this._textViewMap.get(c).getElement().remove(),b.getProperty("text").removeObserver(this)},b.prototype.propertyChanged=function(a,b){var c=b.from.getProperty("id").value;"text"==a.name&&"text"==b.name&&this._textViewMap.get(c).updateText(b.value)},b.prototype.createTextView=function(b){return a.ToolbarViewFactoryImpl.createTextView(b)},b}();a.TextController=b}(a.toolbar||(a.toolbar={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(b,c,d){a.call(this,b),this.addProperty(new ViewerProperty(this,"value",c)),this.addProperty(new ViewerProperty(this,"placeHolder",d))}return __extends(b,a),Object.defineProperty(b.prototype,"value",{get:function(){return this.getProperty("value").value},set:function(a){this.getProperty("value").value=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"placeHolder",{get:function(){return this.getProperty("placeHolder").value},set:function(a){this.getProperty("placeHolder").value=a},enumerable:!0,configurable:!0}),b}(a.ToolbarComponent);a.ToolbarTextInput=b}(a.toolbar||(a.toolbar={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function b(a,b){this._groupMap=a,this._textInputViewMap=b}return b.prototype.childAdded=function(a,b){var c=a,d=this._groupMap.get(c.name),e=b.getProperty("id").value,f=b,g=this.createTextInputView(e),h=f.getProperty("value");h.addObserver(this),g.updateValue(h.value);var i=f.getProperty("placeHolder");i.addObserver(this),g.updatePlaceholder(i.value),d.addChild(g.getElement()),g.onChange=function(){g.getValue()!=h.value&&(h.value=g.getValue())},this._textInputViewMap.set(e,g)},b.prototype.childRemoved=function(a,b){var c=b.getProperty("id").value;this._textInputViewMap.get(c).getElement().remove(),b.getProperty("value").removeObserver(this),b.getProperty("placeHolder").removeObserver(this)},b.prototype.propertyChanged=function(a,b){var c=b.from.getProperty("id").value,d=this._textInputViewMap.get(c);"value"==a.name&&"value"==b.name&&d.getValue()!=b.value&&d.updateValue(b.value),"placeHolder"==a.name&&"placeHolder"==b.name&&d.getValue()!=b.value&&d.updatePlaceholder(b.value)},b.prototype.createTextInputView=function(b){return a.ToolbarViewFactoryImpl.createTextInputView(b)},b}();a.TextInputController=b}(a.toolbar||(a.toolbar={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(b){!function(b){!function(b){var c=function(){function c(c,d,e){void 0===d&&(d=!1),void 0===e&&(e=new b.ToolbarModel("default")),this._container=c,this._mobile=d,this._model=e,this._idViewMap=new MyCoReMap,this._idGroupViewMap=new MyCoReMap,this._eventManager=new a.viewer.widgets.events.ViewerEventManager,this._model.addGroupObserver(this),this._model.addObserver(this),this._buttonController=new b.ButtonController(this._idGroupViewMap,this._idViewMap,d),this._dropdownController=new b.DropdownButtonController(this._idGroupViewMap,this._idViewMap,d),this._textController=new b.TextController(this._idGroupViewMap,this._idViewMap,d),this._imageController=new b.ImageController(this._idGroupViewMap,this._idViewMap),this._textInputController=new b.TextInputController(this._idGroupViewMap,this._idViewMap);var f=this;this._buttonController.eventManager.bind(function(a){f.eventManager.trigger(a)}),this._dropdownController.eventManager.bind(function(a){f.eventManager.trigger(a)}),this._createView()}return Object.defineProperty(c.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"eventManager",{get:function(){return this._eventManager},enumerable:!0,configurable:!0}),c.prototype._createView=function(){this._toolbarView=this.createToolbarView(),this._toolbarElement=this._toolbarView.getElement(),this._toolbarElement.appendTo(this._container);var a=this._model.getGroups();for(var b in a){var c=a[b];this.childAdded(this._model,c)}this._mobile&&this._toolbarView.getElement().trigger("create")},c.prototype.childAdded=function(a,c){if(a instanceof b.ToolbarModel){var d=c,e=this.createGroupView(d.name,d.align);this._idGroupViewMap.set(d.name,e),this._toolbarView.addChild(e.getElement());d.getComponents().forEach(function(a){d.notifyObserverChildAdded(d,a)})}else if(a instanceof b.ToolbarGroup){if(c instanceof b.ToolbarDropdownButton)return void this._dropdownController.childAdded(a,c);if(c instanceof b.ToolbarButton)return void this._buttonController.childAdded(a,c);if(c instanceof b.ToolbarText)return void this._textController.childAdded(a,c);if(c instanceof b.ToolbarTextInput)return void this._textInputController.childAdded(a,c);if(c instanceof b.ToolbarImage){if(this._mobile)throw new ViewerError("Mobile Toolbar doesnt support Image!");return void this._imageController.childAdded(a,c)}}},c.prototype.createToolbarView=function(){return b.ToolbarViewFactoryImpl.createToolbarView()},c.prototype.createGroupView=function(a,c){return b.ToolbarViewFactoryImpl.createGroupView(a,c)},c.prototype.childRemoved=function(a,c){return c instanceof b.ToolbarDropdownButton?void this._dropdownController.childRemoved(a,c):c instanceof b.ToolbarButton?void this._buttonController.childRemoved(a,c):c instanceof b.ToolbarText?void this._textController.childRemoved(a,c):c instanceof b.ToolbarImage?void this._imageController.childRemoved(a,c):c instanceof b.ToolbarTextInput?void this._textInputController.childRemoved(a,c):void 0},c.prototype.getView=function(a){if(a instanceof b.ToolbarComponent)var c=a,d=c.getProperty("id").value;else{if("string"!=typeof a)return this._toolbarView;var d=a}return this._idViewMap.get(d)},c}();b.IviewToolbar=c}(b.toolbar||(b.toolbar={}))}(b.widgets||(b.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){var b=function(){function a(a){this._keyTranslationMap=a}return a.prototype.getTranslation=function(a){return this._keyTranslationMap.has(a)?this._keyTranslationMap.get(a):"???"+a+"???"},a.prototype.getFormatedTranslation=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];return this._keyTranslationMap.has(a)?ViewerFormatString(this._keyTranslationMap.get(a),b):"???"+a+"??? "+b.join(" ")},a.prototype.hasTranslation=function(a){return this._keyTranslationMap.has(a)},a.prototype.translate=function(a){var b=this;a.find("[data-i18n]").each(function(){var a=$(this),c=a.data("i18n");b.hasTranslation(c)&&a.html(b.getTranslation(c))})},a}();a.LanguageModel=b}(a.model||(a.model={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(b){var c=function(b){function c(a){b.call(this,a),this._dropdownChildren=new Array,this.initComponents(),this.addComponents()}return __extends(c,b),c.prototype.initComponents=function(){this._sidebarControllGroup=new a.widgets.toolbar.ToolbarGroup("SidebarControllGroup"),this._sidebarControllDropdownButton=new a.widgets.toolbar.ToolbarDropdownButton("SidebarControllDropdownButton","",[],"menu-hamburger"),this._imageOverviewDropdownChild={id:"imageOverview",label:"Bildübersicht"},this._chapterOverviewDropdownChild={id:"chapterOverview",label:"Strukturübersicht"},this._dropdownChildren.push(this._imageOverviewDropdownChild),this._dropdownChildren.push(this._chapterOverviewDropdownChild),this._sidebarControllDropdownButton.children=this._dropdownChildren,this._sidebarControllGroup.addComponent(this._sidebarControllDropdownButton),this._imageChangeControllGroup=new a.widgets.toolbar.ToolbarGroup("ImageChangeControllGroup"),this._previousImageButton=new a.widgets.toolbar.ToolbarButton("PreviousImageButton","","previous-image","arrow-left"),this._pageSelect=new a.widgets.toolbar.ToolbarDropdownButton("PageSelect","",[],null,!0),this._pageSelectChildren=new Array,this._pageSelect.children=this._pageSelectChildren,this._nextImageButton=new a.widgets.toolbar.ToolbarButton("NextImageButton","","next-image","arrow-right"),this._imageChangeControllGroup.addComponent(this._previousImageButton),this._imageChangeControllGroup.addComponent(this._pageSelect),this._imageChangeControllGroup.addComponent(this._nextImageButton),this._zoomControllGroup=new a.widgets.toolbar.ToolbarGroup("ZoomControllGroup"),this._zoomInButton=new a.widgets.toolbar.ToolbarButton("ZoomInButton","","zoom-in","plus"),this._zoomOutButton=new a.widgets.toolbar.ToolbarButton("ZoomOutButton","","zoom-out","minus"),this._zoomWidthButton=new a.widgets.toolbar.ToolbarButton("ZoomWidthButton","","zoom-width","resize-horizontal"),this._zoomFitButton=new a.widgets.toolbar.ToolbarButton("ZoomFitButton","","zoom-fit-in","resize-full"),this._rotateButton=new a.widgets.toolbar.ToolbarButton("RotateButton","","Rotate","repeat"),this._zoomControllGroup.addComponent(this._zoomInButton),this._zoomControllGroup.addComponent(this._zoomOutButton),this._zoomControllGroup.addComponent(this._zoomWidthButton),this._zoomControllGroup.addComponent(this._zoomFitButton),this._zoomControllGroup.addComponent(this._rotateButton),this._layoutControllGroup=new a.widgets.toolbar.ToolbarGroup("LayoutControllGroup"),this._layoutDropdownButtonChilds=[],this._layoutDropdownButton=new a.widgets.toolbar.ToolbarDropdownButton("LayoutDropdownButton","",this._layoutDropdownButtonChilds,"book",!1),this._layoutControllGroup.addComponent(this._layoutDropdownButton),this._actionControllGroup=new a.widgets.toolbar.ToolbarGroup("ActionControllGroup"),this._shareButton=new a.widgets.toolbar.ToolbarButton("ShareButton","","share","share"),this._actionControllGroup.addComponent(this._shareButton),this._searchGroup=new a.widgets.toolbar.ToolbarGroup("SearchGroup",!0),this._closeViewerGroup=new a.widgets.toolbar.ToolbarGroup("CloseViewerGroup",!0),this._closeViewerButton=new a.widgets.toolbar.ToolbarButton("CloseViewerButton","","close-viewer","off"),this._closeViewerGroup.addComponent(this._closeViewerButton)},c.prototype.addComponents=function(){},c.prototype.i18n=function(a){this._previousImageButton.tooltip=a.getTranslation("toolbar.backward"),this._nextImageButton.tooltip=a.getTranslation("toolbar.forward"),this._zoomInButton.tooltip=a.getTranslation("toolbar.zoomIn"),this._zoomOutButton.tooltip=a.getTranslation("toolbar.zoomOut"),this._zoomWidthButton.tooltip=a.getTranslation("toolbar.toWidth"),this._zoomFitButton.tooltip=a.getTranslation("toolbar.toScreen"),this._shareButton.tooltip=a.getTranslation("toolbar.permalink"),this._closeViewerButton.tooltip=a.getTranslation("toolbar.normalView"),this._rotateButton.tooltip=a.getTranslation("toolbar.rotate"),this._imageOverviewDropdownChild.label=a.getTranslation("toolbar.openThumbnailPanel"),this._chapterOverviewDropdownChild.label=a.getTranslation("toolbar.openChapter"),this._sidebarControllDropdownButton.children=this._sidebarControllDropdownButton.children},c}(a.widgets.toolbar.ToolbarModel);b.MyCoReBasicToolbarModel=c}(a.model||(a.model={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(c,d){a.call(this,c,b.TYPE),this.eventType=d}return __extends(b,a),b.TYPE="WaitForEvent",b}(a.MyCoReImageViewerEvent);a.WaitForEvent=b}(a.events||(a.events={}))}(a.components||(a.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(b){!function(b){var c=function(a){function c(){a.call(this),this._eventCache=new MyCoReMap}return __extends(c,a),c.prototype.init=function(){console.info("Warning: IviewComponent doesnt implements init "+this)},Object.defineProperty(c.prototype,"handlesEvents",{get:function(){return[]},enumerable:!0,configurable:!0}),c.prototype._handle=function(a){if(a instanceof b.events.WaitForEvent){var c=a;if(this._eventCache.has(c.eventType)){var d=this._eventCache.get(c.eventType);c.component.handle(d)}}this.handle(a)},c.prototype.handle=function(a){},c.prototype.trigger=function(b){this._eventCache.set(b.type,b),a.prototype.trigger.call(this,b)},c}(a.viewer.widgets.events.ViewerEventManager);b.ViewerComponent=c}(b.components||(b.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){var b=function(){function a(){}return a.normalize=function(a){ViewerParameterMap.fromCurrentUrl();return void 0!==a.filePath&&null!=a.filePath&&"/"==a.filePath.charAt(0)&&(a.filePath=a.filePath.substring(1)),void 0!==a.derivateURL&&null!=a.derivateURL&&"/"!=a.derivateURL.charAt(a.derivateURL.length-1)&&(a.derivateURL+="/"),a.filePath=encodeURI(a.filePath),a.webApplicationBaseURL.lastIndexOf("/")==a.webApplicationBaseURL.length-1&&(a.webApplicationBaseURL=a.webApplicationBaseURL.substring(0,a.webApplicationBaseURL.length-1)),a},a}();a.MyCoReViewerSettings=b}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a,b,c){this._parent=a,this._horizontalStronger=b,this._containerMap=new MyCoReMap,this._descriptionMap=new MyCoReMap;for(var d in c){var e=c[d];this._descriptionMap.set(e.direction,e)}for(var d in c){var e=c[d];this._initContainer(e)}var f=this;window.onresize=function(){f.updateSizes()},this._initCenter()}return a.prototype._initCenter=function(){var b=jQuery("<div></div>");b.addClass(this.getDirectionDescription(a.DIRECTION_CENTER));var c=this._updateCenterCss();this._parent.append(b),b.css(c),this._containerMap.set(a.DIRECTION_CENTER,b)},a.prototype._updateCenterCss=function(){var b={};return b.position="absolute",b.left=this.getContainerSize(a.DIRECTION_WEST)+"px",b.top=this.getContainerSize(a.DIRECTION_NORTH)+"px",b.bottom=this.getContainerSize(a.DIRECTION_SOUTH)+"px",b.right=this.getContainerSize(a.DIRECTION_EAST)+"px",b},a.prototype._initContainer=function(a){var b=jQuery("<div></div>");b.addClass(this.getDirectionDescription(a.direction)),void 0===a.resizeable&&(a.resizeable=!1),a.resizeable&&this._initContainerResizeable(b,a),this._correctDescription(a);var c=this._updateCssDescription(a);b.css(c),this._parent.append(b),this._containerMap.set(a.direction,b)},a.prototype._correctDescription=function(a){if("minSize"in a&&!isNaN(a.minSize)){a.minSize;a.size=Math.max(a.minSize,a.size)}},a.prototype._updateCssDescription=function(b){var c={};switch(c.position="absolute",c.right="0px",c.top="0px",c.bottom="0px",c.left="0px",c.display=0!==b.size?"block":"none",b.direction){case a.DIRECTION_EAST:delete c.left;break;case a.DIRECTION_WEST:delete c.right;break;case a.DIRECTION_SOUTH:delete c.top;break;case a.DIRECTION_NORTH:delete c.bottom}return b.direction==a.DIRECTION_NORTH||b.direction==a.DIRECTION_SOUTH?(this.hasContainer(a.DIRECTION_WEST)&&this.horizontalStronger&&(c.left=this.getContainerSizeDescription(a.DIRECTION_WEST)+"px"),this.hasContainer(a.DIRECTION_EAST)&&this.horizontalStronger&&(c.right=this.getContainerSizeDescription(a.DIRECTION_EAST)+"px"),c.height=b.size+"px"):(this.hasContainer(a.DIRECTION_NORTH)&&!this.horizontalStronger&&(c.top=this.getContainerSizeDescription(a.DIRECTION_NORTH)+"px"),this.hasContainer(a.DIRECTION_SOUTH)&&!this.horizontalStronger&&(c.bottom=this.getContainerSizeDescription(a.DIRECTION_SOUTH)+"px"),c.width=b.size+"px"),c},a.prototype.updateSizes=function(){var b=this._descriptionMap.values;for(var c in b){var d=b[c],e=this._containerMap.get(d.direction);this._correctDescription(d),e.css(this._updateCssDescription(d)),e.delay(10).children().trigger("iviewResize")}var e=this._containerMap.get(a.DIRECTION_CENTER);e.css(this._updateCenterCss()),e.delay(10).children().trigger("iviewResize")},a.prototype._initContainerResizeable=function(b,c){var d=jQuery("<span></span>");d.addClass("resizer");var e=this;d.bind("mousedown",function(a){var b=new Position2D(a.clientX,a.clientY),d=c.size,f=function(a){var f=new Position2D(a.clientX,a.clientY);c.size=e._getNewSize(b,f,d,c.direction),a.preventDefault(),e.updateSizes()},g=function(a){new Position2D(a.clientX,a.clientY);e._parent.unbind("mousemove"),e._parent.unbind("mouseup")};a.preventDefault(),jQuery(e._parent).bind("mousemove",f),jQuery(e._parent).bind("mouseup",g)});var f={};f.position="absolute";var g=6;c.direction!=a.DIRECTION_NORTH&&a.DIRECTION_SOUTH!=c.direction||(f.cursor="row-resize",f.left="0px",f.height=g+"px",f.right="0px",c.direction==a.DIRECTION_NORTH?f.bottom=-g/2+"px":f.top=-g/2+"px"),c.direction!=a.DIRECTION_WEST&&a.DIRECTION_EAST!=c.direction||(f.cursor="col-resize",f.top="0px",f.bottom="0px",f.width=g+"px",c.direction==a.DIRECTION_WEST?f.right=-g/2+"px":f.left=-g/2+"px"),d.css(f),d.appendTo(b)},a.prototype._getNewSize=function(b,c,d,e){var f;if(e==a.DIRECTION_EAST||e==a.DIRECTION_WEST){var g=b.x-c.x;f=e==a.DIRECTION_EAST?d+g:d-g}if(e==a.DIRECTION_NORTH||e==a.DIRECTION_SOUTH){var g=b.y-c.y;f=e==a.DIRECTION_SOUTH?d+g:d-g}return f},a.prototype.hasContainer=function(a){return this._descriptionMap.has(a)||this._containerMap.has(a)},a.prototype.getContainer=function(a){return this._containerMap.has(a)?this._containerMap.get(a):null},Object.defineProperty(a.prototype,"horizontalStronger",{get:function(){return this._horizontalStronger},enumerable:!0,configurable:!0}),a.prototype.getContainerSizeDescription=function(a){return this._descriptionMap.get(a).size},a.prototype.getContainerDescription=function(a){return this._descriptionMap.get(a)},a.prototype.getContainerSize=function(b){if(this.hasContainer(b)){var c=this.getContainer(b);return b==a.DIRECTION_EAST||b==a.DIRECTION_WEST?c.width():b==a.DIRECTION_NORTH||b==a.DIRECTION_SOUTH?c.height():c.width()}return 0},a.prototype.getDirectionDescription=function(a){return["center","east","south","west","north"][a]},a.DIRECTION_CENTER=0,a.DIRECTION_EAST=1,a.DIRECTION_SOUTH=2,a.DIRECTION_WEST=3,a.DIRECTION_NORTH=4,a}();a.IviewBorderLayout=b}(a.layout||(a.layout={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(c){a.call(this,c,b.TYPE)}return __extends(b,a),b.TYPE="ComponentInitializedEvent",b}(a.MyCoReImageViewerEvent);a.ComponentInitializedEvent=b}(a.events||(a.events={}))}(a.components||(a.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d,e,f,g,h,i){void 0===h&&(h=new MyCoReMap),this.type=a,this.id=b,this.order=c,this.orderLabel=d,this.href=e,this.mimetype=f,this.requestImgdataUrl=g,this.additionalHrefs=h,this.uniqueIdentifier=void 0===i||null==i||""==i?null:i}return a}();a.StructureImage=b}(a.model||(a.model={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(c,d){a.call(this,c,b.TYPE),this._image=d}return __extends(b,a),Object.defineProperty(b.prototype,"image",{get:function(){return this._image},enumerable:!0,configurable:!0}),b.TYPE="ImageChangedEvent",b}(a.MyCoReImageViewerEvent);a.ImageChangedEvent=b}(a.events||(a.events={}))}(a.components||(a.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(c,d){a.call(this,c,b.TYPE),this._image=d}return __extends(b,a),Object.defineProperty(b.prototype,"image",{get:function(){return this._image},enumerable:!0,configurable:!0}),b.TYPE="ImageSelectedEvent",b}(a.MyCoReImageViewerEvent);a.ImageSelectedEvent=b}(a.events||(a.events={}))}(a.components||(a.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(c,d,e,f,g){void 0===f&&(f=300),void 0===g&&(g=null),a.call(this,c,b.TYPE),this.content=d,this.containerDirection=e,this.size=f,this.text=g}return __extends(b,a),b.DIRECTION_CENTER=0,b.DIRECTION_EAST=1,b.DIRECTION_SOUTH=2,b.DIRECTION_WEST=3,b.DIRECTION_NORTH=4,b.TYPE="ShowContentEvent",b}(a.MyCoReImageViewerEvent);a.ShowContentEvent=b}(a.events||(a.events={}))}(a.components||(a.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(b){!function(c){var d=function(d){function e(a,b,c){void 0===c&&(c=jQuery("<div></div>")),d.call(this),this._settings=a,this._container=b,this._contentContainer=c,this._lastSizeMap=new MyCoReMap}return __extends(e,d),e.prototype.init=function(){var c=this;this._container.append(this._contentContainer),this._container.css({overflow:"hidden"}),jQuery(this._contentContainer).css({left:"0px",bottom:"0px",right:"0px",position:"absolute"});var d=[];this._settings.mobile||(d=[{direction:e.SIDEBAR_DIRECTION,resizeable:!0,size:0,minSize:0},{direction:e.INFORMATION_BAR_DIRECTION,resizeable:!1,size:30},{direction:a.viewer.widgets.layout.IviewBorderLayout.DIRECTION_EAST,resizeable:!0,size:0}]),this._layout=new a.viewer.widgets.layout.IviewBorderLayout(this._contentContainer,!1,d),this._content=this._layout.getContainer(e.CONTENT_DIRECTION),this._settings.mobile||(this._sidebar=this._layout.getContainer(e.SIDEBAR_DIRECTION),this._informationBar=this._layout.getContainer(e.INFORMATION_BAR_DIRECTION),this._sidebar.addClass("panel panel-default sidebar"),this._informationBar=this._layout.getContainer(e.INFORMATION_BAR_DIRECTION),this._layout.getContainer(b.widgets.layout.IviewBorderLayout.DIRECTION_EAST).addClass("panel panel-default sidebar"),this._container.bind("iviewResize",function(){c.correctToToolbarSize()}))},e.prototype.correctToToolbarSize=function(){var a=this._container.parent().find(".navbar.navbar-default"),b=a.outerHeight(!1);a.siblings().css({top:b+"px"})},e.prototype.handle=function(b){var d=this;if(b.type,c.events.ComponentInitializedEvent.TYPE,b.type==c.events.ShowContentEvent.TYPE){var f=b,g=this._layout.getContainer(f.containerDirection);if(this._clearOldContent(g),g.append(f.content),null!=f.text&&!this._settings.mobile){var h=jQuery("<div></div>");h.addClass("panel-heading");var i=jQuery("<button></button>");i.attr("type","button"),i.addClass("close");var j=jQuery('<span aria-hidden="true">&times;</span><span class="sr-only">Close</span>');i.append(j),h.prepend(f.text),h.append(i),g.prepend(h),i.click(function(){f.component=d,f.size=0,d.trigger(f)})}if(f.containerDirection!=e.CONTENT_DIRECTION){var k=this._layout.getContainerDescription(f.containerDirection);-1!=f.size?0==f.size?(g.css({display:"none"}),this._lastSizeMap.set(k.direction,k.size),k.size=0):(g.css({display:"block"}),k.size=f.size):(g.css({display:"block"}),0==k.size&&this._lastSizeMap.has(k.direction)?k.size=this._lastSizeMap.get(k.direction):k.size>0?k.size=k.size:k.size=300),this._layout.updateSizes()}this.correctToToolbarSize()}if(b.type==a.viewer.widgets.toolbar.events.DropdownButtonPressedEvent.TYPE){"close"==b.childId&&this._closeSidebar()}if(b.type==a.viewer.widgets.toolbar.events.ButtonPressedEvent.TYPE){"CloseViewerButton"==b.button.id&&("function"!=typeof this._settings.onClose||null==this._settings.onClose?window.history.length>1?window.history.back():window.close():this._settings.onClose.apply(window))}},e.prototype._closeSidebar=function(){var a=this._layout.getContainerDescription(e.SIDEBAR_DIRECTION);a.size=0,a.minSize=0,this._clearOldContent(this._layout.getContainer(e.SIDEBAR_DIRECTION)),this._layout.updateSizes()},e.prototype._clearOldContent=function(a){a.children().not(".resizer").detach()},Object.defineProperty(e.prototype,"handlesEvents",{get:function(){return[a.viewer.widgets.toolbar.events.ButtonPressedEvent.TYPE,a.viewer.components.events.ShowContentEvent.TYPE,c.events.ImageSelectedEvent.TYPE]},enumerable:!0,configurable:!0}),e.SIDEBAR_DIRECTION=a.viewer.widgets.layout.IviewBorderLayout.DIRECTION_WEST,e.CONTENT_DIRECTION=a.viewer.widgets.layout.IviewBorderLayout.DIRECTION_CENTER,e.INFORMATION_BAR_DIRECTION=a.viewer.widgets.layout.IviewBorderLayout.DIRECTION_SOUTH,e}(c.ViewerComponent);c.MyCoReViewerContainerComponent=d}(b.components||(b.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d,e,f,g){void 0===e&&(e=new Array),void 0===f&&(f=new MyCoReMap),void 0===g&&(g=function(){return null}),this._parent=a,this._type=b,this._id=c,this._label=d,this._chapter=e,this._additional=f,this._destinationResolver=g}return Object.defineProperty(a.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"chapter",{get:function(){return this._chapter},set:function(a){this._chapter=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"additional",{get:function(){return this._additional},enumerable:!0,configurable:!0}),a.prototype.resolveDestination=function(a){this._destinationResolver(a)},a}();a.StructureChapter=b}(a.model||(a.model={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d,e,f){this._rootChapter=a,this._imageList=b,this._chapterToImageMap=c,this._imageToChapterMap=d,this._imageHrefImageMap=e,this._textContentPresent=f}return Object.defineProperty(a.prototype,"rootChapter",{get:function(){return this._rootChapter},set:function(a){this._rootChapter=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"imageList",{get:function(){return this._imageList},set:function(a){this._imageList=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"chapterToImageMap",{get:function(){return this._chapterToImageMap},set:function(a){this._chapterToImageMap=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"imageToChapterMap",{get:function(){return this._imageToChapterMap},set:function(a){this._imageToChapterMap=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"imageHrefImageMap",{get:function(){return this._imageHrefImageMap},set:function(a){this._imageHrefImageMap=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isTextContentPresent",{get:function(){return this._textContentPresent},set:function(a){this._textContentPresent=a},enumerable:!0,configurable:!0}),a}();a.StructureModel=b}(a.model||(a.model={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(c,d){a.call(this,c,b.TYPE),this._structureModel=d}return __extends(b,a),Object.defineProperty(b.prototype,"structureModel",{get:function(){return this._structureModel},enumerable:!0,configurable:!0}),b.TYPE="StructureModelLoadedEvent",b}(a.MyCoReImageViewerEvent);a.StructureModelLoadedEvent=b}(a.events||(a.events={}))}(a.components||(a.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(c){a.call(this,c,b.TYPE)}return __extends(b,a),b.TYPE="CanvasTapedEvent",b}(a.MyCoReImageViewerEvent);a.CanvasTapedEvent=b}(a.events||(a.events={}))}(a.components||(a.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(c,d){a.call(this,c,b.TYPE),this._languageModel=d}return __extends(b,a),Object.defineProperty(b.prototype,"languageModel",{get:function(){return this._languageModel},enumerable:!0,configurable:!0}),b.TYPE="LanguageModelLoadedEvent",b}(a.MyCoReImageViewerEvent);a.LanguageModelLoadedEvent=b}(a.events||(a.events={}))}(a.components||(a.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(c,d){a.call(this,c,b.TYPE),this.model=d}return __extends(b,a),b.TYPE="ProvideToolbarModelEvent",b}(a.MyCoReImageViewerEvent);a.ProvideToolbarModelEvent=b}(a.events||(a.events={}))}(a.components||(a.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(b){!function(b){var c=function(c){function d(a,d){var e=this;c.call(this),this._settings=a,this._container=d,this._sync=Utils.synchronize([function(a){return null!=a._toolbarModel&&null!=a._imageIdMap}],function(a){a.trigger(new b.events.WaitForEvent(e,b.events.ImageChangedEvent.TYPE))}),this._imageIdMap=null,this._toolbarModel=null}return __extends(d,c),d.prototype.init=function(){this.trigger(new b.events.WaitForEvent(this,b.events.ProvideToolbarModelEvent.TYPE))},d.prototype.handle=function(c){if(c.type==b.events.ProvideToolbarModelEvent.TYPE){this._toolbarModel=c.model,this._toolbarController=new a.viewer.widgets.toolbar.IviewToolbar(this._container,this._settings.mobile,this._toolbarModel);var d=this;this._toolbarController.eventManager.bind(function(a){d.trigger(a)}),this.trigger(new b.events.WaitForEvent(this,b.events.LanguageModelLoadedEvent.TYPE)),this.trigger(new b.events.WaitForEvent(this,b.events.StructureModelLoadedEvent.TYPE))}if(null!=this._toolbarModel){if(c.type==b.events.LanguageModelLoadedEvent.TYPE){var e=c;this._toolbarModel.i18n(e.languageModel),this._sync(this)}if(c.type==b.events.StructureModelLoadedEvent.TYPE){if(!this._settings.mobile){var f=c,g=f.structureModel._imageList,h=this._toolbarModel.getGroup("ImageChangeControllGroup").getComponentById("PageSelect");this._imageIdMap=new MyCoReMap;var i=new Array;for(var j in g){var k=g[j];this._imageIdMap.set(k.id,k);var l={id:k.id,label:"["+k.order+"]"+(null!=k.orderLabel?" - "+k.orderLabel:"")};i.push(l)}h.children=i}return void this._sync(this)}if(c.type==a.viewer.widgets.toolbar.events.DropdownButtonPressedEvent.TYPE){var m=c;if("PageSelect"==m.button.id){var n=m.childId,o=this._imageIdMap.get(n);this.trigger(new b.events.ImageSelectedEvent(this,o))}return}if(c.type==b.events.ImageChangedEvent.TYPE){var p=c;if(null!=p.image&&!this._settings.mobile){this._toolbarController.getView("PageSelect").getElement().val(p.image.id)}return}if(c.type==b.events.CanvasTapedEvent.TYPE)return void this._toolbarController.getView(null).getElement().slideToggle()}},Object.defineProperty(d.prototype,"handlesEvents",{get:function(){var c=new Array;return c.push(b.events.StructureModelLoadedEvent.TYPE),c.push(b.events.ProvideToolbarModelEvent.TYPE),c.push(a.viewer.widgets.toolbar.events.DropdownButtonPressedEvent.TYPE),c.push(b.events.ImageChangedEvent.TYPE),c.push(b.events.CanvasTapedEvent.TYPE),c.push(b.events.LanguageModelLoadedEvent.TYPE),c},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"toolbar",{get:function(){return this._toolbarController},enumerable:!0,configurable:!0}),d}(b.ViewerComponent);b.MyCoReToolbarComponent=c}(b.components||(b.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){
var b=function(){function a(a){void 0===a&&(a=new Array),this.thumbnails=a,this._idThumbnailMap=new MyCoReMap,this.tilesInsertedMap=new MyCoReMap,this.fillIdThumbnailMap(),this.fillTilesInsertedMap(),this.currentPosition=new Position2D(0,0)}return a.prototype.fillTilesInsertedMap=function(){for(var a in this.thumbnails){var b=this.thumbnails[a];this.tilesInsertedMap.set(b.id,!1)}},a.prototype.fillIdThumbnailMap=function(){for(var a in this.thumbnails){var b=this.thumbnails[a];this._idThumbnailMap.set(b.id,b)}},a.prototype.getThumbnailById=function(a){return this._idThumbnailMap.get(a)},a}();a.ThumbnailOverviewModel=b}(a.thumbnail||(a.thumbnail={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d){this._container=a,this._scrollHandler=b,this._resizeHandler=c,this._inputHandler=d,this._gap=0,this._spacer=jQuery("<div></div>"),this._spacer.appendTo(this._container);var e={position:"relative"};e["overflow-y"]="scroll",e["overflow-x"]="hidden",e["-webkit-overflow-scrolling"]="touch",this._container.css(e),this._lastViewPortSize=this.getViewportSize();var f=this,g=function(){var a=new Position2D(f._container.scrollLeft(),f._container.scrollTop());f._scrollHandler.scrolled(a)};this._container.bind("scroll",g);var h=function(){var a=f.getViewportSize();f._lastViewPortSize!=a&&(f._resizeHandler.resized(a),f._lastViewPortSize=f.getViewportSize(),g())};jQuery(this._container).bind("iviewResize",h)}return Object.defineProperty(a.prototype,"gap",{get:function(){return this._gap},set:function(a){this._gap=a},enumerable:!0,configurable:!0}),a.prototype.setContainerSize=function(a){this._spacer.css({width:a.width,height:a.height})},a.prototype.setContainerScrollPosition=function(a){this._container.scrollLeft(a.x),this._container.scrollTop(a.y)},a.prototype.setThumnailSelected=function(a,b){var c=this._container.find("[data-id='"+a+"']");b?c.addClass("selected"):c.removeClass("selected")},a.prototype.injectTile=function(a,b,c){var d=jQuery("<img />");d.attr("alt",c);var e=jQuery("<div>"+c+"</div>");e.addClass("caption");var f=jQuery("<div></div>");f.addClass("imgSpacer"),f.append(d);var g=jQuery("<div/>");g.attr("data-id",a),g.toggleClass("iviewThumbnail"),g.addClass("thumbnail"),g.prepend(f),g.append(e),g.css({left:this.gap+b.x,top:b.y}),this._inputHandler.addedThumbnail(a,g),this._container.append(g)},a.prototype.updateTileHref=function(a,b){this._container.find("div[data-id="+a+"] img").attr("src",b)},a.prototype.removeTile=function(a){this._container.find("div[data-id="+a+"]").remove()},a.prototype.updateTilePosition=function(a,b){this._container.find("div[data-id='"+a+"']").css({left:this.gap+b.x,top:b.y})},a.prototype.getViewportSize=function(){return new Size2D(this._container.width(),this._container.height())},a.prototype.jumpToThumbnail=function(a){this._container.scrollTop(a)},a}();a.ThumbnailOverviewView=b}(a.thumbnail||(a.thumbnail={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d){void 0===c&&(c={addedThumbnail:function(a,b){}}),void 0===d&&(d=new Size2D(255,255)),this._thumbnails=a,this._container=b,this._inputHandler=c,this._maxThumbnailSize=d}return Object.defineProperty(a.prototype,"thumbnails",{get:function(){return this._thumbnails},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"maxThumbnailSize",{get:function(){return this._maxThumbnailSize},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"inputHandler",{get:function(){return this._inputHandler},enumerable:!0,configurable:!0}),a}();a.DefaultThumbnailOverviewSettings=b}(a.thumbnail||(a.thumbnail={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function b(b){this._settings=b,this._model=new a.ThumbnailOverviewModel(this._settings.thumbnails),this._view=new a.ThumbnailOverviewView(this._settings.container,this,this,this._settings.inputHandler),this._settings.container.css({"min-width":this._settings.maxThumbnailSize.width+"px","min-height":this._settings.maxThumbnailSize.height+"px"}),this.update(!0)}return b.prototype.setThumbnailSelected=function(a){void 0!==this._model.selectedThumbnail&&null!=this._model.selectedThumbnail&&this._view.setThumnailSelected(this._model.selectedThumbnail.id,!1),this._model.selectedThumbnail=this._model.getThumbnailById(a)||null,this._view.setThumnailSelected(a,!0)},b.prototype.jumpToThumbnail=function(a){var b=this._view.getViewportSize(),c=this._settings.maxThumbnailSize,d=this._model.currentPosition,e=Math.floor(b.width/c.width),f=this._model.getThumbnailById(a),g=this._model.thumbnails.indexOf(f),h=Math.floor(g/e),i=h*this._settings.maxThumbnailSize.height,j=this._model.currentPosition.y>i,k=this._model.currentPosition.y+this._view.getViewportSize().height<i+this._settings.maxThumbnailSize.height;if(j);else{if(!k)return;i=i-this._view.getViewportSize().height+this._settings.maxThumbnailSize.height}this._model.currentPosition.move(new MoveVector(0,i-d.y)),this.update(),this._view.jumpToThumbnail(i)},b.prototype.update=function(a){var b=this;void 0===a&&(a=!1);var c=this._view.getViewportSize(),d=function(a){var c=0;return a.each(function(a,d){b._settings.container[0]!=d&&"absolute"!=jQuery(d).css("position")&&(c+=jQuery(d).outerHeight())}),c}(this._settings.container.parent().children());if(this._settings.container.css({height:this._settings.container.parent().height()-d}),0!=c.width&&0!=c.height){var e=c.width%this._settings.maxThumbnailSize.width/2;this._view.gap=e;var f=this._settings.maxThumbnailSize,g=this._model.currentPosition,h=Math.floor(c.width/f.width),i=Math.ceil(c.height/f.height);a&&(this._view.setContainerSize(new Size2D(c.width,Math.ceil(this._model.thumbnails.length/Math.max(h,1))*f.height)),this.updateThumbnails(0,Math.ceil(this._model.thumbnails.length/h),a));var j=Math.floor(g.y/f.height),k=Math.ceil(g.y/f.height+i);this.updateThumbnails(j,k,!1)}},b.prototype.updateThumbnails=function(a,b,c){for(var d=this._view.getViewportSize(),e=this._settings.maxThumbnailSize,f=Math.floor(d.width/e.width),g=new MyCoReMap,h=this,i=a||0;i<b;i++)for(var j=0;j<f;j++){var k=i*f+j,l=new Position2D(j*e.width,i*e.height),m=this._model.thumbnails[k],n=void 0!==m;if(n){var o=this._model.tilesInsertedMap.get(m.id);o||c?o&&this._view.updateTilePosition(m.id,l):(this._model.tilesInsertedMap.set(m.id,!0),this._view.injectTile(m.id,l,m.label),m.requestImgdataUrl(function(a){return function(b){h._view.updateTileHref(a,b)}}(m.id)),null!=this._model.selectedThumbnail&&this._model.selectedThumbnail.href==m.href&&this.setThumbnailSelected(m.id)),g.set(m.id,!1)}}var h=this;this._model.tilesInsertedMap.forEach(function(a,b){g.has(a)||0==g.get(a)||h.removeThumbnail(a)})},b.prototype.removeThumbnail=function(a){this._model.tilesInsertedMap.remove(a),this._view.removeTile(a)},b.prototype.scrolled=function(a){this._model.currentPosition=a,this.update(!1)},b.prototype.resized=function(a){this.update(!0),null!=this._model.selectedThumbnail&&this.jumpToThumbnail(this._model.selectedThumbnail.id)},b}();a.IviewThumbnailOverview=b}(a.thumbnail||(a.thumbnail={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(b){!function(b){var c=function(c){function d(a){c.call(this),this._settings=a,this._sidebarLabel=jQuery("<span>Bildübersicht</span>"),this._currentImageId=null,this._spinner=null,this._enabled=Utils.getVar(this._settings,"imageOverview.enabled",!0)}return __extends(d,c),d.prototype.init=function(){if(this._enabled){this._container=jQuery("<div></div>"),this._idMetsImageMap=new MyCoReMap,this.trigger(new b.events.WaitForEvent(this,b.events.StructureModelLoadedEvent.TYPE)),this.trigger(new b.events.WaitForEvent(this,b.events.LanguageModelLoadedEvent.TYPE));var a="imageOverview"==Utils.getVar(this._settings,"leftShowOnStart","chapterOverview");if(0==this._settings.mobile&&a){this._spinner=jQuery("<div class='spinner'><img src='"+this._settings.webApplicationBaseURL+"/modules/iview2/img/spinner.gif'></div>"),this._container.append(this._spinner);var c=this._settings.mobile?b.events.ShowContentEvent.DIRECTION_CENTER:b.events.ShowContentEvent.DIRECTION_WEST;this.trigger(new b.events.ShowContentEvent(this,this._container,c,300,this._sidebarLabel))}}else this.trigger(new b.events.WaitForEvent(this,b.events.ProvideToolbarModelEvent.TYPE))},Object.defineProperty(d.prototype,"content",{get:function(){return this._container},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"handlesEvents",{get:function(){var c=new Array;return this._enabled?(c.push(b.events.StructureModelLoadedEvent.TYPE),c.push(b.events.ImageChangedEvent.TYPE),c.push(a.viewer.widgets.toolbar.events.DropdownButtonPressedEvent.TYPE),c.push(b.events.ShowContentEvent.TYPE),c.push(b.events.LanguageModelLoadedEvent.TYPE)):c.push(b.events.ProvideToolbarModelEvent.TYPE),c},enumerable:!0,configurable:!0}),d.prototype.handle=function(c){if(c.type==b.events.ProvideToolbarModelEvent.TYPE){var d=c;d.model._sidebarControllDropdownButton.children=d.model._sidebarControllDropdownButton.children.filter(function(a){return"imageOverview"!=a.id})}if(c.type==a.viewer.widgets.toolbar.events.DropdownButtonPressedEvent.TYPE){if("imageOverview"==c.childId){var e=this._settings.mobile?b.events.ShowContentEvent.DIRECTION_CENTER:b.events.ShowContentEvent.DIRECTION_WEST;this.trigger(new b.events.ShowContentEvent(this,this._container,e,-1,this._sidebarLabel)),this._overview.update(!0),this._overview.jumpToThumbnail(this._currentImageId)}}if(c.type==b.events.StructureModelLoadedEvent.TYPE){var f=c.structureModel._imageList,g=this._settings.tileProviderPath+this._settings.derivate+"/";this._overviewSettings=new a.viewer.widgets.thumbnail.DefaultThumbnailOverviewSettings(this.prepareModel(f,g),this._container,this),this._overview=new a.viewer.widgets.thumbnail.IviewThumbnailOverview(this._overviewSettings);var h=0==this._settings.filePath.indexOf("/")?this._settings.filePath.substr(1):this._settings.filePath;this._overview.jumpToThumbnail(h),this._overview.setThumbnailSelected(h),this._currentImageId=h,null!=this._spinner&&this._spinner.detach(),this.trigger(new b.events.ComponentInitializedEvent(this))}if(c.type==b.events.ImageChangedEvent.TYPE){var i=c;void 0!==this._overview&&(this._overview.jumpToThumbnail(i.image.id),this._overview.setThumbnailSelected(i.image.id),this._currentImageId=i.image.id)}if(c.type==b.events.LanguageModelLoadedEvent.TYPE){var j=c;this._sidebarLabel.text(j.languageModel.getTranslation("sidebar.imageOverview"))}},d.prototype.prepareModel=function(a,b){var c=new Array;for(var d in a){var e,f=a[d];e=-1==f.href.indexOf("data:")?b+f.href+"/0/0/0.jpg":f.href;var g=""+(f.orderLabel||f.order),h=f.id;this._idMetsImageMap.set(h,f),c.push({id:h,label:g,href:e,requestImgdataUrl:f.requestImgdataUrl})}return c},d.prototype.addedThumbnail=function(a,c){var d=this;jQuery(c).bind("click",function(){d.trigger(new b.events.ImageSelectedEvent(d,d._idMetsImageMap.get(a)))})},d}(b.ViewerComponent);b.MyCoReImageOverviewComponent=c}(b.components||(b.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a,b){this.root=a,this.chapterLabelMap=b,this.chapterVisible=new MyCoReMap,this.idElementMap=new MyCoReMap,this.initChapter(this.root),this.selected=null}return a.prototype.initChapter=function(a){this.idElementMap.set(a.id,a),this.chapterVisible.set(a.id,!0);for(var b in a.chapter){var c=a.chapter[b];this.initChapter(c)}},a}();a.ChapterTreeModel=b}(a.chaptertree||(a.chaptertree={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(){}return a.prototype.register=function(a){this._ctrl=a},a.prototype.registerNode=function(a,b){var c=this;a.click(function(){var a=c._ctrl.getChapterById(b);c._ctrl.setChapterSelected(a)})},a.prototype.registerExpander=function(a,b){var c=this;a.click(function(){var a=c._ctrl.getChapterById(b);c._ctrl.setChapterExpanded(a,!c._ctrl.getChapterExpanded(a))})},a}();a.DefaultChapterTreeInputHandler=b}(a.chaptertree||(a.chaptertree={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a,b,c){void 0===c&&(c="chapterTreeDesktop"),this._container=a,this._inputHandler=b,this.list=jQuery("<ol><ol>"),this.list.addClass(c),this.list.addClass("list-group"),this._container.append(this.list)}return a.prototype.addNode=function(a,b,c,d,e){var f=this.getParent(a),g=this.createNode(b,c,d,e);f.append(g)},a.prototype.getParent=function(a){var b;if(null!=a){if(b=this.list.find("ol[data-id='"+a+"']"),0==b.length){b=this.list.find("li[data-id='"+a+"']");var c=jQuery("<ol></ol>");c.attr("data-id",a),c.attr("data-opened",!0),c.insertAfter(b),b=c}}else b=this.list;return b},a.prototype.createNode=function(b,c,d,e){var f=jQuery("<li></li>"),g=jQuery("<a title='"+c+"'></a>").text(c),h=jQuery("<span>"+d+"</span>");if(h.addClass("childLabel"),f.append(g),f.append(h),f.addClass("list-group-item"),f.attr("data-id",b),f.attr("data-opened",!0),this._inputHandler.registerNode(g,b),e){var i=jQuery('<span class="expander glyphicon '+a.OPEN_ICON_CLASS+'"></span>');f.prepend(i),this._inputHandler.registerExpander(i,b)}return f},a.prototype.setOpened=function(b,c){var d=(this.list.find("li[data-id='"+b+"']").attr("data-opened",c.toString()),this.list.find("ol[data-id='"+b+"']").attr("data-opened",c.toString()),this.list.find("li[data-id='"+b+"'] span.expander"));c?(d.removeClass(a.CLOSE_ICON_CLASS),d.addClass(a.OPEN_ICON_CLASS)):(d.removeClass(a.OPEN_ICON_CLASS),d.addClass(a.CLOSE_ICON_CLASS))},a.prototype.setSelected=function(a,b){this.list.find("li[data-id='"+a+"']").attr("data-selected",b.toString())},a.prototype.jumpTo=function(a){var b=this.list.find("li[data-id='"+a+"']");b.addClass("blink"),setTimeout(function(){b.removeClass("blink")},500);var c=b.position().top-this._container.position().top,d=0;if(c<0)d=c-10;else{var e=this._container.height(),f=b.height();if(!(c+f+10>e))return;d=c-e+f+10}this._container.scrollTop(this._container.scrollTop()+d)},a.CLOSE_ICON_CLASS="glyphicon-chevron-right",a.OPEN_ICON_CLASS="glyphicon-chevron-down",a}();a.DesktopChapterTreeView=b}(a.chaptertree||(a.chaptertree={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a,b,c){void 0===c&&(c="chapterTreeDesktop"),this._container=a,this._inputHandler=b,this.list=jQuery("<ul></ul>"),this.list.addClass("mobileListview"),this.levelMap=new MyCoReMap,this.list.appendTo(a)}return a.prototype.addNode=function(a,b,c,d,e){var f=jQuery("<li></li>"),g=jQuery("<a></a>");g.addClass("label"),g.text(c),g.attr("data-id",b),g.appendTo(f);var h=jQuery("<a></a>");h.text(d),h.addClass("childLabel"),h.appendTo(f),f.attr("data-id",b);var i=0;null!=a&&this.levelMap.has(a)&&(i=this.levelMap.get(a)+1),this.levelMap.set(b,i),g.css({"padding-left":15*i+"px"}),this.list.append(f),this._inputHandler.registerNode(f,b)},a.prototype.setOpened=function(a,b){},a.prototype.setSelected=function(a,b){},a.prototype.jumpTo=function(a){},a.LEVEL_MARGIN=15,a}();a.MobileChapterTreeView=b}(a.chaptertree||(a.chaptertree={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function b(b,c,d,e,f){void 0===d&&(d=null),void 0===e&&(e=!1),void 0===f&&(f=new a.DefaultChapterTreeInputHandler),this._container=b,this._chapterLabelMap=c,this._chapter=d,this.mobile=e,this._inputHandler=f}return Object.defineProperty(b.prototype,"chapter",{get:function(){return this._chapter},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"chapterLabelMap",{get:function(){return this._chapterLabelMap},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"viewFactory",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"inputHandler",{get:function(){return this._inputHandler},enumerable:!0,configurable:!0}),b.prototype.createChapterTeeView=function(){return this.mobile?new a.MobileChapterTreeView(this.container,this.inputHandler):new a.DesktopChapterTreeView(this.container,this.inputHandler)},b}();a.DefaultChapterTreeSettings=b}(a.chaptertree||(a.chaptertree={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function b(b){this._settings=b,this._model=new a.ChapterTreeModel(b.chapter,this._settings.chapterLabelMap),this._view=b.viewFactory.createChapterTeeView(),this._settings.inputHandler.register(this),this.init()}return b.prototype.setChapterSelected=function(a){null!=this._model.selected&&this._view.setSelected(this._model.selected.id,!1),null!=a&&(this._model.selected=a,this._view.setSelected(this._model.selected.id,!0))},b.prototype.getSelectedChapter=function(){return this._model.selected},b.prototype.setChapterExpanded=function(a,b){null!=a&&(this._model.chapterVisible.set(a.id,b),this._view.setOpened(a.id,b))},b.prototype.getChapterExpanded=function(a){return this._model.chapterVisible.get(a.id)},b.prototype.getChapterById=function(a){return this._model.idElementMap.get(a)},b.prototype.init=function(){this.insertChapterView(this._model.root)},b.prototype.jumpToChapter=function(a){null!=a&&this._view.jumpTo(a.id)},b.prototype.insertChapterView=function(a){this._view.addNode((a.parent||{id:null}).id,a.id,a.label,this._model.chapterLabelMap.get(a.id)||"",a.chapter.length>0);for(var b in a.chapter){var c=a.chapter[b];this.insertChapterView(c)}},b}();a.IviewChapterTree=b}(a.chaptertree||(a.chaptertree={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(c,d){a.call(this,c,b.TYPE),this._chapter=d}return __extends(b,a),Object.defineProperty(b.prototype,"chapter",{get:function(){return this._chapter},enumerable:!0,configurable:!0}),b.TYPE="ChapterChangedEvent",b}(a.MyCoReImageViewerEvent);a.ChapterChangedEvent=b}(a.events||(a.events={}))}(a.components||(a.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(c,d,e){void 0===e&&(e=!0),a.call(this,c,b.TYPE),this.stateMap=d,this.deepState=e}return __extends(b,a),b.TYPE="RequestStateEvent",b}(a.MyCoReImageViewerEvent);a.RequestStateEvent=b}(a.events||(a.events={}))}(a.components||(a.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(b){!function(b){var c=function(c){function d(a){c.call(this),this._settings=a,this._spinner=null,this._currentChapter=null,this._initialized=!1,this._sidebarLabel=jQuery("<span>strukturübersicht</span>"),this._chapterToActivate=null,this._autoPagination=!0,this._idImageMap=new MyCoReMap,this._enabled=Utils.getVar(this._settings,"chapter.enabled",!0)}return __extends(d,c),d.prototype.init=function(){var a=this;if(this._enabled){this._container=jQuery("<div></div>"),this._container.css({overflowY:"scroll"}),this._container.bind("iviewResize",function(){a.updateContainerSize()}),this.trigger(new b.events.WaitForEvent(this,b.events.StructureModelLoadedEvent.TYPE)),this.trigger(new b.events.WaitForEvent(this,b.events.LanguageModelLoadedEvent.TYPE));var c=Utils.getVar(this._settings,"chapter.showOnStart",window.innerWidth>=1200),d="chapterOverview"==Utils.getVar(this._settings,"leftShowOnStart",c?"chapterOverview":"none");if(0==this._settings.mobile&&d){this._spinner=jQuery("<div class='spinner'><img src='"+this._settings.webApplicationBaseURL+"/modules/iview2/img/spinner.gif'></div>"),this._container.append(this._spinner);var e=this._settings.mobile?b.events.ShowContentEvent.DIRECTION_CENTER:b.events.ShowContentEvent.DIRECTION_WEST;this.trigger(new b.events.ShowContentEvent(this,this._container,e,300,this._sidebarLabel))}}else this.trigger(new b.events.WaitForEvent(this,b.events.ProvideToolbarModelEvent.TYPE))},d.prototype.updateContainerSize=function(){this._container.css({height:this._container.parent().height()-this._sidebarLabel.parent().outerHeight()+"px"})},Object.defineProperty(d.prototype,"handlesEvents",{get:function(){var c=new Array;return this._enabled?(c.push(b.events.StructureModelLoadedEvent.TYPE),c.push(b.events.ImageChangedEvent.TYPE),c.push(b.events.ShowContentEvent.TYPE),c.push(a.viewer.widgets.toolbar.events.DropdownButtonPressedEvent.TYPE),c.push(b.events.LanguageModelLoadedEvent.TYPE),c.push(b.events.RequestStateEvent.TYPE),c.push(b.events.RestoreStateEvent.TYPE),c.push(b.events.ChapterChangedEvent.TYPE)):c.push(b.events.ProvideToolbarModelEvent.TYPE),c},enumerable:!0,configurable:!0}),d.prototype.handle=function(c){var d=this;if(c.type==b.events.ProvideToolbarModelEvent.TYPE){var e=c;e.model._sidebarControllDropdownButton.children=e.model._sidebarControllDropdownButton.children.filter(function(a){return"chapterOverview"!=a.id})}if(c.type==a.viewer.widgets.toolbar.events.DropdownButtonPressedEvent.TYPE){if("chapterOverview"==c.childId){var f=this._settings.mobile?b.events.ShowContentEvent.DIRECTION_CENTER:b.events.ShowContentEvent.DIRECTION_WEST;this.trigger(new b.events.ShowContentEvent(this,this._container,f,-1,this._sidebarLabel)),this.updateContainerSize()}}if(c.type==b.events.StructureModelLoadedEvent.TYPE){var g=c,h=g.structureModel._rootChapter;this._structureModel=g.structureModel,this._structureModel._imageList.forEach(function(a){d._idImageMap.set(a.id,a),"orderLabel"in a&&null!=a.orderLabel&&(d._autoPagination=!1)});var i=this.createChapterLabelMap(this._structureModel);this._chapterWidgetSettings=new a.viewer.widgets.chaptertree.DefaultChapterTreeSettings(this._container,i,h,this._settings.mobile,this),this._chapterWidget=new a.viewer.widgets.chaptertree.IviewChapterTree(this._chapterWidgetSettings),this._initialized=!0,this.trigger(new b.events.ComponentInitializedEvent(this)),null!=this._spinner&&this._spinner.detach(),null!=this._chapterToActivate&&this.setChapter(this._chapterToActivate)}if(c.type==b.events.ImageChangedEvent.TYPE){if(void 0===this._structureModel||this._structureModel._imageToChapterMap.isEmpty())return;var j=c;if(null!=j.image&&this._initialized&&(null==this._chapterWidget.getSelectedChapter()||this._structureModel.chapterToImageMap.get(this._chapterWidget.getSelectedChapter().id)!=j.image)){var k=this._structureModel._imageToChapterMap.get(j.image.id);null!=k&&(this._chapterWidget.setChapterExpanded(k,!0),this._chapterWidget.jumpToChapter(k))}}if(c.type==b.events.LanguageModelLoadedEvent.TYPE){var l=c;this._sidebarLabel.text(l.languageModel.getTranslation("sidebar.chapterOverview"))}if(c.type==b.events.RequestStateEvent.TYPE){var m=c;null!=this._currentChapter&&m.stateMap.set("logicalDiv",this.persistChapterToString(this._currentChapter))}if(c.type==b.events.RestoreStateEvent.TYPE){var m=c,n=function(a){d._initialized?d.setChapter(a):d._chapterToActivate=a};m.restoredState.hasThen("logicalDiv",n),m.restoredState.hasThen("div",n)}if(c.type===b.events.ChapterChangedEvent.TYPE){var o=c;if(null==o||null==o.chapter)return;this.setChapter(o.chapter.id,!1)}},d.prototype.persistChapterToString=function(a){return a.id},d.prototype.createChapterLabelMap=function(a){var b=this,c=new MyCoReMap;return a.chapterToImageMap.forEach(function(a,d){c.set(a,d.orderLabel||(b._autoPagination?d.order.toString(10):""))}),c},d.prototype.register=function(){},d.prototype.registerNode=function(a,b){var c=this;a.click(function(){c.setChapter(b,!0,a)})},d.prototype.setChapter=function(a,c,d){var e=this;if(void 0===c&&(c=!0),null==this._currentChapter||this._currentChapter.id!=a){var f=this._chapterWidget.getChapterById(a);if(null!=f){var g=function(a){void 0!==a&&null!==a&&(e._currentChapter=f,e._chapterWidget.setChapterExpanded(f,!0),e._chapterWidget.setChapterSelected(f),e._chapterWidget.jumpToChapter(f),e.trigger(new b.events.ChapterChangedEvent(e,f)),c&&e.trigger(new b.events.ImageSelectedEvent(e,a)))};if(this._structureModel._chapterToImageMap.has(a)){var h=this._structureModel._chapterToImageMap.get(a);g(h)}else{if(void 0!==d){var i=d.css("cursor");d.css("cursor","wait")}f.resolveDestination(function(a){void 0!==d&&d.css("cursor",i),g(e._idImageMap.get(a))})}}}},d.prototype.registerExpander=function(a,b){var c=this;a.click(function(){var a=c._chapterWidget.getChapterById(b);c._chapterWidget.setChapterExpanded(a,!c._chapterWidget.getChapterExpanded(a))})},Object.defineProperty(d.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0}),d}(b.ViewerComponent);b.MyCoReChapterComponent=c}(b.components||(b.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a,b,c){void 0===c&&(c=document.body),this._mobile=a;var d=this;this._wrapper=jQuery("<div></div>"),this._wrapper.addClass("modal fade bs-modal-sm"),this._wrapper.attr("tabindex","-1"),this._wrapper.attr("role","dialog"),this._wrapper.attr("aria-labeleby","permalinkLabel"),this._wrapper.attr("aria-hidden","true"),this._wrapper.on("click",function(a){a.target==d._wrapper[0]&&d.hide()}),this._box=jQuery("<div></div>"),this._box.addClass("modal-dialog modal-sm"),this._box.appendTo(this._wrapper),this._content=jQuery("<div></div>"),this._content.addClass("modal-content"),this._content.appendTo(this._box),this._header=jQuery("<div><h4 class='modal-title' data-i18n='"+b+"'>"+b+"</h4></div>"),this._header.addClass("modal-header"),this._header.appendTo(this._content),this._body=jQuery("<div></div>"),this._body.addClass("modal-body"),this._body.appendTo(this._content),this._footer=jQuery("<div></div>"),this._footer.addClass("modal-footer"),this._footer.appendTo(this._content),this._close=jQuery("<a data-i18n='modal.close'>Close</a>"),this._close.attr("type","button"),this._close.addClass("btn btn-default"),this._close.appendTo(this._footer),this._close.click(function(){d.hide()}),this._mobile?this.hide():this._wrapper.modal({show:!1}),jQuery(c).prepend(this._wrapper)}return Object.defineProperty(a.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"wrapper",{get:function(){return this._wrapper},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"modalContent",{get:function(){return this._content},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"modalHeader",{get:function(){return this._header},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"modalBody",{get:function(){return this._body},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"modalFooter",{get:function(){return this._footer},enumerable:!0,configurable:!0}),a.prototype.show=function(){this._mobile?this._wrapper.show():this._wrapper.modal("show")},a.prototype.hide=function(){this._mobile?this._wrapper.hide():this._wrapper.modal("hide")},Object.defineProperty(a.prototype,"closeButton",{get:function(){return this._close},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"closeLabel",{set:function(a){this._close.text(a)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"title",{get:function(){return this._header.find(".modal-title").text()},set:function(a){this._header.find(".modal-title").text(a)},enumerable:!0,configurable:!0}),a.prototype.updateI18n=function(a){return a.translate(this._wrapper),this},a}();a.IviewModalWindow=b}(a.modal||(a.modal={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(b){a.call(this,b,"Permalink");var c=this;this._textArea=jQuery("<textarea></textarea>"),this._textArea.addClass("form-control"),this._textArea.appendTo(this.modalBody),this._textArea.on("click",function(){c._textArea.select()})}return __extends(b,a),Object.defineProperty(b.prototype,"permalink",{set:function(a){this._textArea.text(a)},enumerable:!0,configurable:!0}),b}(a.IviewModalWindow);a.ViewerPermalinkModalWindow=b}(a.modal||(a.modal={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(c,d){a.call(this,c,b.TYPE),this.restoredState=d}return __extends(b,a),b.TYPE="RestoreStateEvent",b}(a.MyCoReImageViewerEvent);a.RestoreStateEvent=b}(a.events||(a.events={}))}(a.components||(a.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(c){a.call(this,c,b.TYPE)}return __extends(b,a),b.TYPE="UpdateURLEvent",b}(a.MyCoReImageViewerEvent);a.UpdateURLEvent=b}(a.events||(a.events={}))}(a.components||(a.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(c,d){a.call(this,c,b.TYPE),this.callback=d}return __extends(b,a),b.TYPE="RequestPermalinkEvent",b}(a.MyCoReImageViewerEvent);a.RequestPermalinkEvent=b}(a.events||(a.events={}))}(a.components||(a.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(b){!function(c){var d=function(d){function e(a){d.call(this),this._settings=a,this._currentState=new ViewerParameterMap,this._enabled=Utils.getVar(this._settings,"permalink.enabled",!0)}return __extends(e,d),e.prototype.init=function(){if(this.trigger(new c.events.ComponentInitializedEvent(this)),this._enabled){this._modalWindow=new a.viewer.widgets.modal.ViewerPermalinkModalWindow(this._settings.mobile),this.trigger(new c.events.WaitForEvent(this,c.events.LanguageModelLoadedEvent.TYPE));var b=this,d=ViewerParameterMap.fromCurrentUrl();d.isEmpty()||b.trigger(new c.events.RestoreStateEvent(b,d))}else this.trigger(new c.events.WaitForEvent(this,c.events.ProvideToolbarModelEvent.TYPE))},e.prototype.handle=function(a){if(a.type==c.events.ProvideToolbarModelEvent.TYPE){var d=a,e=d.model.getGroup(d.model._actionControllGroup.name);void 0!==e&&null!=e&&d.model.getGroup(d.model._actionControllGroup.name).removeComponent(d.model._shareButton)}if(a.type==c.events.LanguageModelLoadedEvent.TYPE){var f=a;this._modalWindow.closeLabel=f.languageModel.getTranslation("permalink.close"),this._modalWindow.title=f.languageModel.getTranslation("permalink.title")}if(a.type==b.widgets.toolbar.events.ButtonPressedEvent.TYPE){if("ShareButton"==a.button.id){var g=new ViewerParameterMap;this.trigger(new c.events.RequestStateEvent(this,g,!0));var h=this.buildPermalink(g);this._modalWindow.permalink=h,this._modalWindow.show()}}if(a.type==c.events.RequestPermalinkEvent.TYPE){var i=a,g=new ViewerParameterMap;this.trigger(new c.events.RequestStateEvent(this,g,!0));var h=this.buildPermalink(g);i.callback(h)}if(a.type==c.events.ImageChangedEvent.TYPE){void 0!==a.image&&this.updateHistory()}a.type==c.events.UpdateURLEvent.TYPE&&this.updateHistory()},e.prototype.updateHistory=function(){var a=Utils.getVar(this._settings,"permalink.updateHistory",!0),b=new ViewerParameterMap;this.trigger(new c.events.RequestStateEvent(this,b,!1)),
a&&window.history.replaceState({},"",this.buildPermalink(b))},e.prototype.buildPermalink=function(a){var b;"pdf"==this._settings.doctype?b=this._settings.filePath:(b=a.get("page"),a.remove("page"));var c=this.getBaseURL(b);return a.remove("derivate"),c+a.toParameterString()},e.prototype.getBaseURL=function(a){return ViewerFormatString(Utils.getVar(this._settings,"permalink.viewerLocationPattern","{baseURL}/rsc/viewer/{derivate}/{file}",function(a){return null!=a}),{baseURL:this._settings.webApplicationBaseURL,derivate:this._settings.derivate,file:a})},Object.defineProperty(e.prototype,"handlesEvents",{get:function(){var a=new Array;return this._enabled?(a.push(b.widgets.toolbar.events.ButtonPressedEvent.TYPE),a.push(c.events.LanguageModelLoadedEvent.TYPE),a.push(c.events.RequestPermalinkEvent.TYPE),a.push(c.events.ImageChangedEvent.TYPE),a.push(c.events.UpdateURLEvent.TYPE)):a.push(c.events.ProvideToolbarModelEvent.TYPE),a},enumerable:!0,configurable:!0}),e}(c.ViewerComponent);c.MyCoRePermalinkComponent=d}(b.components||(b.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(b){!function(b){var c=function(){function b(){}return b.prototype.getLanguage=function(c,d,e){void 0===e&&(e=b.DEFAULT_ERROR_CALLBACK);var f={url:c,success:function(b){d(new a.model.LanguageModel(new MyCoReMap(b)))},error:function(a,b,c){e(c)}};jQuery.ajax(f)},b.DEFAULT_ERROR_CALLBACK=function(a){console.log(a)},b}();b.XMLI18NProvider=c,b.I18NPROVIDER=new c}(b.i18n||(b.i18n={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(b){!function(c){var d=function(){function a(){}return a.prototype.getLanguage=function(c,d,e){void 0===e&&(e=a.DEFAULT_ERROR_CALLBACK);var f={url:c,success:function(c){var e=[];for(var f in c){var g=0;0==f.indexOf(a.VIEWER_PREFIX)?g=a.VIEWER_PREFIX.length:0==f.indexOf(a.METS_PREFIX)&&(g=a.METS_PREFIX.length);e[f.substr(g)]=c[f]}d(new b.model.LanguageModel(new MyCoReMap(e)))},error:function(a,c,f){e(f),d(new b.model.LanguageModel(new MyCoReMap))}};jQuery.ajax(f)},a.DEFAULT_ERROR_CALLBACK=function(a){console.log(a)},a.VIEWER_PREFIX="component.viewer.",a.METS_PREFIX="component.mets.",a}();c.MyCoReI18NProvider=d,a.viewer.widgets.i18n.I18NPROVIDER=new d;var e=function(a){function d(b){a.call(this),this._settings=b,this._language="lang"in this._settings?this._settings.lang:"en",this._loadI18N()}return __extends(d,a),d.prototype._loadI18N=function(){var a=this;if(void 0===this._settings.i18nURL||null==this._settings.i18nURL)throw new ViewerError("i18nURL is not specified in settings!");b.widgets.i18n.I18NPROVIDER.getLanguage(ViewerFormatString(this._settings.i18nURL,{lang:this._language}),function(b){var d=new c.events.LanguageModelLoadedEvent(a,b);a.trigger(d)})},d}(c.ViewerComponent);c.MyCoReI18NComponent=e}(b.components||(b.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(c,d,e){a.call(this,c,b.TYPE),this._href=d,this._onResolve=e}return __extends(b,a),b.TYPE="RequestTextContentEvent",b}(a.MyCoReImageViewerEvent);a.RequestTextContentEvent=b}(a.events||(a.events={}))}(a.components||(a.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(){this._insertedPages=new Array}return a.prototype.init=function(a,b,c,d,e,f){this._model=a,this._pageController=b,this._pageDimension=c,this._originalPageDimension=c,this._horizontalScrollbar=d,this._verticalScrollbar=e,this._pageLoader=f},a.prototype.getPageController=function(){return this._pageController},a.prototype.updatePage=function(a){var b=this.checkShouldBeInserted(a),c=this.isImageInserted(a);if(b&&!c&&this._model.children.has(a)){var d=this._model.children.get(a);this._insertedPages.push(a),this._pageController.addPage(d,this.calculatePageAreaInformation(a))}if(!b&&c&&this._model.children.has(a)){var d=this._model.children.get(a);this._insertedPages.splice(this._insertedPages.indexOf(a)),this._pageController.removePage(d)}},a.prototype.getRealPageDimension=function(a){if(-1!=a&&this._model.children.has(a)){var b=this._model.children.get(a),c=this._pageController.getPageAreaInformation(b);if(void 0!==c)return b.size.scale(c.scale).getRotated(this.getCurrentPageRotation())}return this._pageDimension.getRotated(this.getCurrentPageRotation())},a.prototype.syncronizePages=function(){throw"should be implemented"},a.prototype.clear=function(){throw"should be implemented"},a.prototype.checkShouldBeInserted=function(a){throw"should be implemented"},a.prototype.calculatePageAreaInformation=function(a){throw"should be implemented"},a.prototype.getImageMiddle=function(a){throw"should be implemented"},a.prototype.fitToScreen=function(){throw"should be implemented"},a.prototype.fitToWidth=function(a){throw void 0===a&&(a=!1),"should be implemented"},a.prototype.getCurrentPage=function(){throw"should be implemented"},a.prototype.jumpToPage=function(a){throw"should be implemented"},a.prototype.isImageInserted=function(a){return this._model.children.has(a)&&-1!=this._pageController.getPages().indexOf(this._model.children.get(a))},a.prototype.scrollhandler=function(){throw"should be implemented"},a.prototype.rotate=function(a){throw"should be implemented"},a.prototype.getLabelKey=function(){throw"should be implemented"},a.prototype.getCurrentOverview=function(){throw"should be implemented"},a.prototype.next=function(){throw"should be implemented"},a.prototype.previous=function(){throw"should be implemented"},a.prototype.getCurrentPageRotation=function(){throw"should be implemented"},a.prototype.setCurrentPageZoom=function(a){throw"should be implemented"},a.prototype.getCurrentPageZoom=function(){throw"should be implemented"},a.prototype.getCurrentPositionInPage=function(){var a=this._pageController.viewport.asRectInArea().pos,b=this.getCurrentPage(),c=this._pageDimension,d=this.getImageMiddle(b),e=a.x-(d.x-c.width/2),f=a.y-(d.y-c.height/2);return new Position2D(e,f)},a.prototype.setCurrentPositionInPage=function(a){throw"should be implemented"},a.prototype.getPositionInArea=function(a){var b=this._pageController.viewport,c=b.asRectInArea(),d=c.pos.x+c.size.width*(a.x/b.size.width),e=c.pos.y+c.size.height*(a.y/b.size.height);return new Position2D(d,e)},a.prototype.getPageHitInfo=function(a){for(var b=this._pageController.viewport,c=this._pageController.getPageArea(),d=this.getPositionInArea(a),e=0,f=c.getPagesInViewport(b);e<f.length;e++){var g=f[e],h=this._model.hrefImageMap.get(g.id);if(null!=h){var i=c.getPageInformation(g),j=g.size.getRotated(i.rotation).scale(i.scale),k=new Rect(new Position2D(i.position.x-j.width/2,i.position.y-j.height/2),j);if(k.intersects(d)){var l=k.flip(i.rotation),m=l.pos.rotate(i.rotation),n=d.rotate(i.rotation),o=new Position2D(Math.abs(n.x-m.x),Math.abs(n.y-m.y));return{id:g.id,order:h.order,pageAreaInformation:i,hit:o}}}}return{id:null,order:null,pageAreaInformation:null,hit:null}},a}();a.PageLayout=b}(a.canvas||(a.canvas={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(c,d,e){void 0===e&&(e=!1),a.call(this,c,b.TYPE),this.pageLayout=d,this.isDefault=e}return __extends(b,a),b.TYPE="ProvidePageLayoutEvent",b}(a.MyCoReImageViewerEvent);a.ProvidePageLayoutEvent=b}(a.events||(a.events={}))}(a.components||(a.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(c,d,e,f){void 0===f&&(f=null),a.call(this,c,b.TYPE),this._pageId=d,this._onResolve=e,this.textContentURL=f}return __extends(b,a),b.TYPE="RequestPageEvent",b}(a.MyCoReImageViewerEvent);a.RequestPageEvent=b}(a.events||(a.events={}))}(a.components||(a.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(c,d){a.call(this,c,b.TYPE),this.pageLayout=d}return __extends(b,a),b.TYPE="PageLayoutChangedEvent",b}(a.MyCoReImageViewerEvent);a.PageLayoutChangedEvent=b}(a.events||(a.events={}))}(a.components||(a.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(){}return a.prototype.mouseDown=function(a,b){},a.prototype.mouseUp=function(a,b){},a.prototype.mouseClick=function(a,b){},a.prototype.mouseDoubleClick=function(a,b){},a.prototype.mouseMove=function(a,b){},a.prototype.mouseDrag=function(a,b,c,d){},a.prototype.scroll=function(a){},a.prototype.keydown=function(a){},a.prototype.keypress=function(a){},a.prototype.keyup=function(a){},a}();a.DesktopInputAdapter=b}(a.canvas||(a.canvas={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(c,d){a.call(this,c,b.TYPE),this.listener=d}return __extends(b,a),b.TYPE="RequestDesktopInputEvent",b}(a.MyCoReImageViewerEvent);a.RequestDesktopInputEvent=b}(a.events||(a.events={}))}(a.components||(a.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d,e,f,g){this.positions=a,this.middle=b,this.angle=c,this.distance=d,this.time=e,this.velocity=f,this.delta=g}return a}();a.TouchMove=b}(a.canvas||(a.canvas={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m){this.startTime=a,this.startMiddle=b,this.startAngle=c,this.startDistance=d,this.canvasStartPosition=e,this.canvasStartScale=f,this.canvasStartRotation=g,this.currentMove=h,this.lastMove=i,this.lastSession=j,this.touches=k,this.touchLeft=l,this.maxTouches=m}return a}();a.TouchSession=b}(a.canvas||(a.canvas={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(){}return a.prototype.touchStart=function(a){},a.prototype.touchMove=function(a){},a.prototype.touchEnd=function(a){},a}();a.TouchInputAdapter=b}(a.canvas||(a.canvas={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(c,d){a.call(this,c,b.TYPE),this.listener=d}return __extends(b,a),b.TYPE="RequestTouchInputEvent",b}(a.MyCoReImageViewerEvent);a.RequestTouchInputEvent=b}(a.events||(a.events={}))}(a.components||(a.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(c,d,e){a.call(this,c,b.TYPE),this.zIndex=d,this.canvasPageLayer=e}return __extends(b,a),b.TYPE="AddCanvasPageLayerEvent",b}(a.MyCoReImageViewerEvent);a.AddCanvasPageLayerEvent=b}(a.events||(a.events={}))}(a.components||(a.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(c,d){void 0===d&&(d=!0),a.call(this,c,b.TYPE),this.edit=d}return __extends(b,a),b.TYPE="TextEditEvent",b}(a.MyCoReImageViewerEvent);a.TextEditEvent=b}(a.events||(a.events={}))}(a.components||(a.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(c){a.call(this,c,b.TYPE)}return __extends(b,a),b.TYPE="RedrawEvent",b}(a.MyCoReImageViewerEvent);a.RedrawEvent=b}(a.events||(a.events={}))}(a.components||(a.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(b){var c=function(b){function c(){b.apply(this,arguments),this._paiCache=new MyCoReMap,this._rotation=0}return __extends(c,b),c.prototype.syncronizePages=function(){var a=this,b=this._pageController.viewport,c=this.getPageHeightWithSpace(),d=this._model.pageCount;this.correctViewport(),void 0!==this._horizontalScrollbar&&null!=this._horizontalScrollbar&&(this._horizontalScrollbar.areaSize=this._pageDimension.width,this._horizontalScrollbar.viewSize=this._pageController.viewport.size.width/this._pageController.viewport.scale,this._horizontalScrollbar.position=b.position.x-b.size.width/b.scale/2+this._pageDimension.width/2),void 0!==this._verticalScrollbar&&null!=this._verticalScrollbar&&(this._verticalScrollbar.areaSize=d*this.getPageHeightWithSpace(),this._verticalScrollbar.viewSize=this._pageController.viewport.size.height/this._pageController.viewport.scale,this._verticalScrollbar.position=b.position.y-b.size.height/b.scale/2);for(var e=b.size.height/b.scale,f=b.position.y-e/2,g=b.position.y+e/2,h=Math.floor(f/c),i=Math.ceil(g/c),j=this._insertedPages.slice(0),k=h;k<=i;k++)this._model.children.has(k)&&-1==j.indexOf(k)?j.push(k):0<k&&k<=this._model.pageCount&&this._pageLoader(k);j.forEach(function(b){a.updatePage(b)})},c.prototype.clear=function(){var a=this,b=this._pageController.getPages().slice(0);this._insertedPages.splice(0,this._insertedPages.length),b.forEach(function(b){a._pageController.removePage(b)})},c.prototype.fitToScreen=function(){var a=this._pageController.viewport;if(0!=a.size.width&&0!=a.size.height){var b=a.size,c=this.getRealPageDimension(this.getCurrentPage());a.scale=Math.min(b.width/c.width,b.height/c.height);var d=this.getImageMiddle(this.getCurrentPage());a.position=new Position2D(0,d.y)}},c.prototype.calculatePageAreaInformation=function(b){var c=this._model.children.get(b).size,d=new a.canvas.PageAreaInformation;return d.position=this.getImageMiddle(b),d.scale=Math.min(this._originalPageDimension.width/c.width,this._originalPageDimension.height/c.height),d.rotation=this._rotation,this._paiCache.set(b,d),d},c.prototype.checkShouldBeInserted=function(a){var b=this._pageController.viewport.asRectInArea(),c=this.getImageMiddle(a),d=new Rect(new Position2D(c.x-this._pageDimension.width/2,c.y-this._pageDimension.height/2),this._pageDimension),e=this.getCurrentOverview();return null!=b.getIntersection(d)||null!=e.getIntersection(d)},c.prototype.fitToWidth=function(a){void 0===a&&(a=!1);var b=this.getImageMiddle(this.getCurrentPage()),c=this.getRealPageDimension(this.getCurrentPage());this._pageController.viewport.scale=this._pageController.viewport.size.width/c.width;var d=b.y;if(a){var e=this._pageController.viewport,f=e.size.scale(1/e.scale);d=d-c.height/2+f.height/2}this._pageController.viewport.position=new Position2D(0,d)},c.prototype.getCurrentPage=function(){return void 0===this._pageController?0:Math.ceil(this._pageController.viewport.position.y/this.getPageHeightWithSpace())},c.prototype.jumpToPage=function(a){var b=this.getImageMiddle(a),c=new Rect(new Position2D(b.x-this._pageDimension.width/2,b.y-this._pageDimension.height/2),this._pageDimension);this._pageController.viewport.setRect(c)},c.prototype.getPageHeightWithSpace=function(){return this._pageDimension.height+this._pageDimension.height/10},c.prototype.getImageMiddle=function(a){var b=this.getPageHeightWithSpace(),c=a*b-this._pageDimension.height/2;return new Position2D(0,c)},c.prototype.scrollhandler=function(){var a=this._pageController.viewport,b=new Position2D(this._horizontalScrollbar.position,this._verticalScrollbar.position),c=b.x+a.size.width/a.scale/2-this._pageDimension.width/2;a.position=new Position2D(c,b.y+a.size.height/a.scale/2)},c.prototype.correctViewport=function(){var a=this._pageController.viewport,b=this.getCurrentPageScaling();if(-1!=b){var c=this._pageController.viewport.size.width/this._pageDimension.width,d=Math.min(this._pageController.viewport.size.height/(2*this._pageDimension.height),c);a.scale<d&&(a.stopAnimation(),a.scale=d);a.scale*b>4&&(a.stopAnimation(),a.scale=4/b)}var e=a.size.scale(1/a.scale),f=Math.ceil(a.asRectInArea().size.height/2),g=Math.ceil(this._model.pageCount*this.getPageHeightWithSpace()-Math.floor(a.asRectInArea().size.height/2)),h=Math.min(Math.max(a.position.y,f),g);if(e.width>this._pageDimension.width){var i=new Position2D(0,h);a.position.equals(i)||(a.position=i)}else{var j=-this._pageDimension.width/2+e.width/2,k=this._pageDimension.width/2-e.width/2,l=Math.max(j,Math.min(k,a.position.x)),i=new Position2D(l,h);a.position.equals(i)||(a.position=i)}},c.prototype.rotate=function(a){this._rotation=a;var b=this.getCurrentPage();this._pageDimension=this._originalPageDimension.getRotated(a),this.clear(),this.syncronizePages(),this.jumpToPage(b)},c.prototype.getLabelKey=function(){return"singlePageLayout"},c.prototype.getCurrentOverview=function(){var a=this.getRealPageDimension(this.getCurrentPage()),b=this.getImageMiddle(this.getCurrentPage());return new Rect(new Position2D(b.x-a.width/2,b.y-a.height/2),a)},c.prototype.next=function(){var a=this.getCurrentPage(),b=Math.max(Math.min(a+1,this._model.pageCount),0),c=this._pageController.viewport.scale,d=this.getCurrentPositionInPage();this.jumpToPage(b),this._pageController.viewport.scale=c,this.setCurrentPositionInPage(d)},c.prototype.previous=function(){var a=this.getCurrentPage(),b=Math.max(Math.min(a-1,this._model.pageCount),0),c=this._pageController.viewport.scale,d=this.getCurrentPositionInPage();this.jumpToPage(b),this._pageController.viewport.scale=c,this.setCurrentPositionInPage(d)},c.prototype.getCurrentPageRotation=function(){return this._rotation},c.prototype.getCurrentPageZoom=function(){if(void 0!==this._pageController){var a=this.getCurrentPageScaling();return-1!==a?this._pageController.viewport.scale*a:this._pageController.viewport.scale}},c.prototype.setCurrentPageZoom=function(a){if(void 0!==this._pageController){var b=this.getCurrentPageScaling();this._pageController.viewport.scale=a/b}},c.prototype.getCurrentPageScaling=function(){if(void 0===this._model)return-1;var a=this.getCurrentPage();if(-1!=a&&this._model.children.has(a)){var b=this._model.children.get(a),c=this._pageController.getPageAreaInformation(b);if(void 0!==c)return c.scale}return-1},c.prototype.setCurrentPositionInPage=function(a){var b=this._pageController.viewport.asRectInArea(),c=this.getCurrentPage(),d=this.getImageMiddle(c),e=this._pageDimension,f=new Position2D(d.x-e.width/2,d.y-e.height/2);this._pageController.viewport.position=new Position2D(f.x+a.x+b.size.width/2,f.y+a.y+b.size.height/2)},c}(b.PageLayout);b.SinglePageLayout=c}(a.canvas||(a.canvas={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d){void 0===d&&(d=300),this._viewport=a,this._zoomScale=b,this._duration=d,this._startScale=null,this._startPosition=null,this._targetScale=null,this._totalElapsedTime=0,this._targetScale=a.scale*this._zoomScale,this._startPosition=this._viewport.position,this._startScale=a.scale,this._position=void 0!==c&&null!=c?c:this._viewport.position.copy(),this._diff=new MoveVector(this._viewport.position.x-this._position.x,this._viewport.position.y-this._position.y).scale(this._startScale)}return a.prototype.updateAnimation=function(a){this._totalElapsedTime+=a;var b=(this._targetScale-this._startScale)*this._totalElapsedTime/this._duration+this._startScale;this._viewport.scale=b,this._viewport.position=this._position.move(this._diff.scale(1/b));var c=this._totalElapsedTime>=this._duration-a;return c&&(this._viewport.position=this._position.move(this._diff.scale(1/this._targetScale)),this._viewport.scale=this._targetScale),c},a.prototype.merge=function(a){this._startScale=this._viewport.scale,this._targetScale*=a,this._totalElapsedTime=0},a}();a.ZoomAnimation=b}(a.canvas||(a.canvas={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a,b){this._viewport=a,this._startVelocity=b,this._currentVelocity=this._startVelocity.scale(1/this._viewport.scale)}return a.prototype.updateAnimation=function(b){this._currentVelocity=this._currentVelocity.scale(1/(1+b/3*.01));var c=this._currentVelocity.x<a.MINIMUM_VELOCITY&&this._currentVelocity.x>-a.MINIMUM_VELOCITY&&this._currentVelocity.y<a.MINIMUM_VELOCITY&&this._currentVelocity.y>-a.MINIMUM_VELOCITY;if(!c){var d=this._viewport.position,e=new Position2D(d.x+this._currentVelocity.x*b,d.y+this._currentVelocity.y*b);this._viewport.position=e}return c},a.MINIMUM_VELOCITY=.05,a}();a.VelocityScrollAnimation=b}(a.canvas||(a.canvas={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a,b,c){this._inputElement=a,this._viewport=b,this._handler=c,this._lastMouseSession=null,this.initMove(),this.initScale()}return a.prototype.initMove=function(){var a=this,b=jQuery(this._inputElement[0]);this._mouseMoveHandler=function(c){if(null!=a.getTarget(c)){var d=a.getMousePosition(b,c);a._handler.mouseMove(d,c)}},this._mouseDragHandler=function(c){if(null!=a.getTarget(c)){var d=a.getMousePosition(b,c);a._handler.mouseDrag(d,a._currentMouseSession.startPosition,a._currentMouseSession.startViewport,c)}},this._mouseDownHandler=function(c){if(null!=a.getTarget(c)){var d=a.getMousePosition(b,c);a._handler.mouseDown(d,c),a._currentMouseSession=a.createMouseSession(d,a._viewport.position.copy()),b.unbind("mousemove",a._mouseMoveHandler),b.bind("mousemove",a._mouseDragHandler),b.bind("mouseleave",a._mouseLeaveHandler)}},this._mouseLeaveHandler=function(b){a._mouseUpHandler(b)},this._mouseUpHandler=function(c){var d=(jQuery(c.target),a.getMousePosition(b,c));a._handler.mouseUp(d,c),a.notNull(a._currentMouseSession)&&((new Date).valueOf()-a._currentMouseSession.downDate<250&&Math.abs(a._currentMouseSession.startPosition.x-d.x)<10&&Math.abs(a._currentMouseSession.startPosition.y-d.y)<10&&a._handler.mouseClick(d,c),a.notNull(a._lastMouseSession)&&a._currentMouseSession.downDate-a._lastMouseSession.downDate<500&&Math.abs(a._lastMouseSession.startPosition.x-d.x)<10&&Math.abs(a._lastMouseSession.startPosition.y-d.y)<10&&a._handler.mouseDoubleClick(d,c),b.unbind("mousemove",a._mouseDragHandler),b.unbind("mouseleave",a._mouseLeaveHandler),b.bind("mousemove",a._mouseMoveHandler),a._lastMouseSession=a._currentMouseSession,a._currentMouseSession=null)},b.bind("mousemove",this._mouseMoveHandler),b.bind("mousedown",this._mouseDownHandler),b.bind("mouseup",this._mouseUpHandler);var c=jQuery(document.body);c.keydown(function(b){a._handler.keydown(b)}),c.keyup(function(b){a._handler.keyup(b)}),c.keypress(function(b){a._handler.keypress(b)})},a.prototype.notNull=function(a){return void 0!==a&&null!=a},a.prototype.getTarget=function(a){var b=jQuery(a.target);return b.hasClass("overview")?null:b},a.prototype.getMousePosition=function(a,b){var c=(b.clientX+window.pageXOffset-a.offset().left)*window.devicePixelRatio,d=(b.clientY+window.pageYOffset-a.offset().top)*window.devicePixelRatio;return new Position2D(c,d)},a.prototype.clearRunning=function(){if(null!=this._currentMouseSession){var a=jQuery(this._inputElement[0]);a.unbind("mousemove",this._mouseDragHandler),a.bind("mousemove",this._mouseMoveHandler),this._lastMouseSession=this._currentMouseSession,this._handler.mouseUp(this._currentMouseSession.currentPosition,null),this._currentMouseSession=null}},a.prototype.initScale=function(){var a=this;viewerCrossBrowserWheel(this._inputElement[0],function(b){a._handler.scroll(b)})},a.prototype.updateOverview=function(a,b,c){this._overviewRect=a,this._overviewScale=b,this._overviewBounds=c},a.prototype.createMouseSession=function(a,b){return new c(a,b,a)},a}();a.DesktopInputDelegator=b;var c=function(){function a(a,b,c){this.startPosition=a,this.startViewport=b,this.currentPosition=c,this.downDate=(new Date).getTime()}return a}()}(a.canvas||(a.canvas={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a,b){void 0===a&&(a=20),void 0===b&&(b=300),this._maxElements=a,this._maxTime=b,this._maxElementsOrig=this._maxElements,this._values=new Array}return a.prototype.add=function(a){if(this._values.length>0){var b=this._values.pop();this._values.push(b),a.time-b.time>=5&&this._values.push(a);var c=this._values.reverse();c.length=Math.min(c.length,this._maxElements),this._values=c.reverse()}else this._values.push(a)},a.prototype.getVelocity=function(){var a=this._values.pop();if(this._values.push(a),0==this._values.length)return new MoveVector(0,0);var b=null;for(var c in this._values){var d=this._values[c];if(!(Math.abs(d.time-a.time)>this._maxTime)){b=d;break}}var e=a.time-b.time,f=new MoveVector(b.middle.x-a.middle.x,b.middle.y-a.middle.y);return new MoveVector(f.x/e||0,f.y/e||0)},a}();a.VelocityCalculationQueue=b}(a.canvas||(a.canvas={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a){var b=this;this._inputElement=a,this._idPointerMap=new MyCoReMap,this._handlerMap=new MyCoReMap,this._inputElement.addEventListener("pointerdown",function(a){"touch"==a.pointerType&&(a.stopImmediatePropagation(),a.preventDefault(),a.stopPropagation(),b._updatePointer(a.pointerId.toString(10),new Position2D(a.offsetX,a.offsetY)),b._fireEvent("touchstart"))}),this._inputElement.addEventListener("pointerup",function(a){"touch"==a.pointerType&&(a.stopImmediatePropagation(),a.preventDefault(),a.stopPropagation(),b._deletePointer(a.pointerId.toString(10)),b._fireEvent("touchend"))}),this._inputElement.addEventListener("pointermove",function(a){"touch"==a.pointerType&&(a.stopImmediatePropagation(),a.preventDefault(),a.stopPropagation(),b._updatePointer(a.pointerId.toString(10),new Position2D(a.offsetX,a.offsetY)),b._fireEvent("touchmove"))}),this._inputElement.addEventListener("pointercancel",function(a){"touch"==a.pointerType&&(a.stopImmediatePropagation(),a.preventDefault(),a.stopPropagation(),b._deletePointer(a.pointerId.toString(10)),b._fireEvent("touchend"))})}return a.prototype._deletePointer=function(a){this._idPointerMap.remove(a)},a.prototype._updatePointer=function(a,b){this._idPointerMap.set(a,b)},a.prototype._fireEvent=function(a){if(this._handlerMap.has(a)){this._handlerMap.get(a)(this._createTouchEvent())}},a.prototype._createTouchEvent=function(){return{preventDefault:function(){},targetTouches:this._createTouchesArray()}},a.prototype._createTouchesArray=function(){var a=new Array;return this._idPointerMap.values.forEach(function(b){return a.push({clientX:b.x,clientY:b.y,pageX:b.x,pageY:b.y})}),a},Object.defineProperty(a.prototype,"touchstart",{get:function(){return this._handlerMap.get("touchstart")},set:function(a){this._handlerMap.set("touchstart",a)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"touchmove",{get:function(){return this._handlerMap.get("touchmove")},set:function(a){this._handlerMap.set("touchmove",a)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"touchend",{get:function(){return this._handlerMap.get("touchend")},set:function(a){this._handlerMap.set("touchend",a)},enumerable:!0,configurable:!0}),a}();a.TouchPolyfill=b}(a.canvas||(a.canvas={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function b(a,b,c){this._inputElement=a,this._viewport=b,this._handler=c,this.msGestureTarget=null,this.session=null,this.lastSession=null,this.listener=new Array,this.initTouch()}return b.prototype.createTouchSession=function(b,c,d,e,f,g,h){return void 0===f&&(f=this._viewport.position),void 0===g&&(g=this._viewport.scale),void 0===h&&(h=this._viewport.rotation),new a.TouchSession((new Date).valueOf(),b,c,d,f,g,h,null,null,e,0,!1,0)},b.prototype.initTouch=function(){var b=this._inputElement[0],c=this,d=new a.VelocityCalculationQueue,e=new a.TouchPolyfill(b),f=function(b){if(b.preventDefault(),null==this.session){d=new a.VelocityCalculationQueue,this.session=c.createTouchSession(c.getMiddle(b.targetTouches),0,c.getDistance(b.targetTouches),this.lastSession),this.session.touches++,this.session.maxTouches=this.session.touches}else this.session.touches++,this.session.touches>this.session.maxTouches&&(this.session.maxTouches=this.session.touches),2==this.session.touches&&(this.session.startAngle=c.getAngle(b.targetTouches[0],b.targetTouches[1])),this.session.startMiddle=c.getMiddle(b.targetTouches),this.session.startDistance=c.getDistance(b.targetTouches);c._handler.touchStart(this.session)},g=function(a){this.session.touches--,this.session.touchLeft=!0,0===this.session.touches&&(c._handler.touchEnd(this.session),this.session.lastSession=null,this.lastSession=this.session,this.session=null),a.preventDefault()},h=function(b){b.preventDefault();var e=c.getMiddle(b.targetTouches),f=c.getPositions(b.targetTouches),g=c.getDistance(b.targetTouches),h=0;2===this.session.touches&&(h=c.getAngle(b.targetTouches[0],b.targetTouches[1]));var i=null,j=null;null!=this.session.currentMove?(d.add(this.session.currentMove),i=d.getVelocity(),j=null!=this.session.lastMove?new MoveVector(this.session.lastMove.middle.x-this.session.currentMove.middle.x,this.session.lastMove.middle.y-this.session.currentMove.middle.y):new MoveVector(0,0)):(i=new MoveVector(0,0),j=new MoveVector(0,0));var k=new a.TouchMove(f,e,h,g,(new Date).valueOf(),i,j);this.session.lastMove=this.session.currentMove,this.session.currentMove=k,c._handler.touchMove(this.session)};this.addListener(b,"touchstart",f),this.addListener(b,"touchend",g),this.addListener(b,"touchmove",h),e.touchstart=f,e.touchmove=h,e.touchend=g},b.prototype.clearRunning=function(){null!=this.session&&(this._handler.touchEnd(this.session),this.session.lastSession=null,this.lastSession=this.session,this.session=null)},b.prototype.addListener=function(a,b,c){a.addEventListener(b,c),this.listener.push({surface:a,type:b,fn:c})},b.prototype.getPositions=function(a){for(var b=new Array,c=0;c<a.length;c++){var d=a[c];b.push(new Position2D(d.clientX*window.devicePixelRatio,d.clientY*window.devicePixelRatio))}return b},b.prototype.getAngle=function(a,b){var c=b.pageY*window.devicePixelRatio-a.pageY*window.devicePixelRatio,d=b.pageX*window.devicePixelRatio-a.pageX*window.devicePixelRatio;return 180*Math.atan2(c,d)/Math.PI},b.prototype.getMiddle=function(a){for(var b=0,c=0,d=0;d<a.length;d++){var e=a[d];b+=e.clientX*window.devicePixelRatio,c+=e.clientY*window.devicePixelRatio}return new Position2D(b/a.length,c/a.length)},b.prototype.getDistance=function(a){for(var b=0,c=0;c<a.length;c++){var d=a[c],e=a[c-1];if(void 0!==e&&null!=e){b+=Math.sqrt(Math.pow(d.clientX-e.clientX,2)+Math.pow(d.clientY-e.clientY,2))}}return b},b.prototype.getVelocity=function(a,b){return new MoveVector(Math.abs(b.x/a)||0,Math.abs(b.y/a)||0)},b.prototype.delete=function(){this.listener.forEach(function(a){a.surface.removeEventListener(a.type,a.fn)})},b}();a.TouchInputDelegator=b}(a.canvas||(a.canvas={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(c,d){a.call(this,c,b.TYPE),this.viewport=d}return __extends(b,a),b.TYPE="ViewportInitializedEvent",b}(a.MyCoReImageViewerEvent);a.ViewportInitializedEvent=b}(a.events||(a.events={}))}(a.components||(a.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(b){!function(c){var d=a.viewer.components.events.RequestTextContentEvent,e=function(e){function h(c,d){var f=this;e.call(this),this._settings=c,this._container=d,this._pageLayout=null,
this._pageController=new a.viewer.widgets.canvas.PageController(!0),this._hrefImageMap=new MyCoReMap,this._hrefPageMap=new MyCoReMap,this._orderImageMap=new MyCoReMap,this._orderPageMap=new MyCoReMap,this._hrefPageLoadingMap=new MyCoReMap,this._structureImages=null,this._languageModel=null,this._desktopDelegators=new Array,this._touchDelegators=new Array,this._permalinkState=null,this._imageView=new b.widgets.canvas.PageView(!0,!1),this._altoView=new b.widgets.canvas.PageView(!0,!0),this._componentContent=jQuery("<div></div>"),this._viewMode="imageView",this._layouts=new Array,this._rotation=0,this._layoutModel={children:this._orderPageMap,hrefImageMap:this._hrefImageMap,pageCount:1},this._pageLoader=function(a){f._orderImageMap.has(a)?f.loadPageIfNotPresent(f._orderImageMap.get(a).href,a):f.loadPageIfNotPresent(f._settings.filePath,a)},this.pageWidth=2480,this.pageHeight=3508}return __extends(h,e),h.prototype.init=function(){var a=this;this.changeImage(this._settings.filePath,!1),this.trigger(new c.events.ComponentInitializedEvent(this)),this.trigger(new c.events.WaitForEvent(this,c.events.StructureModelLoadedEvent.TYPE)),this.trigger(new c.events.WaitForEvent(this,c.events.ShowContentEvent.TYPE)),this.trigger(new c.events.WaitForEvent(this,c.events.ProvideToolbarModelEvent.TYPE)),this.trigger(new c.events.ViewportInitializedEvent(this,this._pageController.viewport));var b=this._componentContent;b.css({position:"absolute",top:"0px",left:"0px",right:this._settings.mobile?"0px":"15px",bottom:"15px"}),this.initMainView();var d=Utils.getVar(this._settings,"canvas.overview.enabled",!0);this._settings.mobile||(d&&b.append(this._pageController._overview.container),this._pageController._overview.initEventHandler(),b=b.add(this._horizontalScrollbar.scrollbarElement),b=b.add(this._verticalScrollbar.scrollbarElement),b=b.add(this._toggleButton),this.initOverview(d)),jQuery(b).bind("iviewResize",function(){a._horizontalScrollbar.resized(),a._verticalScrollbar.resized(),a._pageController.update()}),this._pageController.viewport.positionProperty.addObserver({propertyChanged:function(b,c){a.update()}}),this._pageController.viewport.scaleProperty.addObserver({propertyChanged:function(a,b){}}),this.trigger(new c.events.ShowContentEvent(this,b,c.events.ShowContentEvent.DIRECTION_CENTER))},h.prototype.initOverview=function(a){if(a){var b=this._pageController._overview.container,c=parseInt(Utils.getVar(this._settings,"canvas.overview.minVisibleSize",h.DEFAULT_CANVAS_OVERVIEW_MIN_VISIBLE_SIZE,function(a){return!isNaN(1*a)&&parseInt(a,10)>1}),10),d=this._toggleButton.children(".glyphicon");this._container.width()<c?(jQuery(b).hide(),d.addClass(h.OVERVIEW_VISIBLE_ICON)):d.addClass(h.OVERVIEW_INVISIBLE_ICON),this._toggleButton.click(function(){jQuery(b).is(":visible")?(jQuery(b).hide(),d.addClass(h.OVERVIEW_VISIBLE_ICON),d.removeClass(h.OVERVIEW_INVISIBLE_ICON)):(jQuery(b).show(),d.addClass(h.OVERVIEW_INVISIBLE_ICON),d.removeClass(h.OVERVIEW_VISIBLE_ICON))})}else this._toggleButton.addClass("disabled")},h.prototype.initMainView=function(){var a=this;if(this.registerDesktopInputHandler(new g(this)),this.registerTouchInputHandler(new f(this)),this._settings.mobile||(this._horizontalScrollbar=new b.widgets.canvas.Scrollbar(!0),this._verticalScrollbar=new b.widgets.canvas.Scrollbar(!1),this._toggleButton=jQuery("<div class='overViewToggle'><div class=\"glyphicon\"></div></div>"),this._pageController.viewport.sizeProperty.addObserver({propertyChanged:function(b,c){a._horizontalScrollbar.update(),a._verticalScrollbar.update()}}),this._horizontalScrollbar.scrollHandler=this._verticalScrollbar.scrollHandler=function(){a._pageLayout.scrollhandler()},this._pageController._overview=new b.widgets.canvas.Overview(this._pageController.viewport)),this._componentContent.append(this._imageView.container),this._imageView.container.addClass("mainView"),this._imageView.container.css({left:"0px",right:"0px"}),this._componentContent.addClass("grabbable"),this._altoView.container.addClass("secondView"),this._altoView.container.css({left:"50%",right:"0px"}),this._altoView.container.css({"border-left":"1px solid black"}),this._pageController.views.push(this._imageView),"pdf"==this._settings.doctype){var c=new b.widgets.canvas.TextRenderer(this._pageController.viewport,this._pageController.getPageArea(),this._imageView,function(b,c){a.trigger(new d(a,b.id,function(a,b){c(b)}))},function(b){a.changeImage(b,!0)});this._pageController.textRenderer=c}},h.prototype.setViewMode=function(a){var b=this,c=function(a){var c=b._pageController.views.indexOf(a);-1!=c&&b._pageController.views.splice(c,1),a.container.detach()},d=function(a){-1==b._pageController.views.indexOf(a)&&b._pageController.views.push(a),a.container.parent()!=b._componentContent&&b._componentContent.append(a.container)};this._viewMode=a,"imageView"==a?(this._imageView.container.css({left:"0px",right:"0px"}),c(this._altoView),d(this._imageView),this.setSelectableButtonEnabled(!1)):"mixedView"==a?(this._imageView.container.css({left:"0px",right:"50%"}),this._altoView.container.css({left:"50%",right:"0px"}),d(this._altoView),d(this._imageView),this.setSelectableButtonEnabled(!0)):"textView"==a?(this._altoView.container.css({left:"0px",right:"0px"}),c(this._imageView),d(this._altoView),this.setSelectableButtonEnabled(!0)):console.warn("unknown view mode: "+a),this._pageController.update(),this.updateToolbarLabel()},h.prototype.changeImage=function(a,b){if(this._currentImage!=a){this._currentImage=a;var d=this._hrefImageMap.get(a);b&&this._pageLayout.jumpToPage(d.order),this.trigger(new c.events.ImageChangedEvent(this,d))}this._settings.mobile&&this.trigger(new c.events.ShowContentEvent(this,jQuery(this._componentContent),c.events.ShowContentEvent.DIRECTION_CENTER))},h.prototype.fitViewportOverPage=function(){this._pageLayout.fitToScreen()},h.prototype.fitViewerportOverPageWidth=function(){this._pageLayout.fitToWidth()},Object.defineProperty(h.prototype,"handlesEvents",{get:function(){var b=[];return b.push(a.viewer.widgets.toolbar.events.ButtonPressedEvent.TYPE),b.push(a.viewer.widgets.toolbar.events.DropdownButtonPressedEvent.TYPE),b.push(a.viewer.components.events.ImageSelectedEvent.TYPE),b.push(c.events.StructureModelLoadedEvent.TYPE),b.push(c.events.RequestStateEvent.TYPE),b.push(c.events.RestoreStateEvent.TYPE),b.push(c.events.ShowContentEvent.TYPE),b.push(c.events.LanguageModelLoadedEvent.TYPE),b.push(c.events.ProvideToolbarModelEvent.TYPE),b.push(c.events.ProvidePageLayoutEvent.TYPE),b.push(c.events.RequestDesktopInputEvent.TYPE),b.push(c.events.RequestTouchInputEvent.TYPE),b.push(c.events.AddCanvasPageLayerEvent.TYPE),b.push(c.events.RedrawEvent.TYPE),b.push(c.events.TextEditEvent.TYPE),b},enumerable:!0,configurable:!0}),h.prototype.previousImage=function(){this._pageLayout.previous(),this.update()},h.prototype.nextImage=function(){this._pageLayout.next(),this.update()},h.prototype.getPageController=function(){return this._pageController},h.prototype.getPageLayout=function(){return this._pageLayout},h.prototype.getRotation=function(){return this._rotation},h.prototype.setRotation=function(a){this._rotation=a},h.prototype.changePageLayout=function(a){if(null!=this._pageLayout){this._pageLayout.clear();var b=this._pageLayout.getCurrentPage()}if(this._pageLayout=a,isNaN(b)){var b=1;this._layoutModel.pageCount=1}this._pageLayout.jumpToPage(b),this._pageLayout.rotate(this._rotation),this.update(),this.trigger(new c.events.PageLayoutChangedEvent(this,this._pageLayout))},h.prototype.loadPageIfNotPresent=function(a,b){var d=this;if(!(this._hrefPageMap.has(a)||this._hrefPageLoadingMap.has(a)&&this._hrefPageLoadingMap.get(a))){this._hrefPageLoadingMap.set(a,!0);var e=null;if(this._hrefImageMap.has(a)){var f=this._imageByHref(a).additionalHrefs;f.has(h.ALTO_TEXT_HREF)?e=f.get(h.ALTO_TEXT_HREF):f.has(h.PDF_TEXT_HREF)&&(e=f.get(h.PDF_TEXT_HREF))}this.trigger(new c.events.RequestPageEvent(this,a,function(a,b){d._hrefPageMap.set(a,b),d._hrefImageMap.has(a)?d._orderPageMap.set(d._hrefImageMap.get(a).order,b):d._orderPageMap.set(1,b),d.update()},e))}},h.prototype.restorePermalink=function(){var a=this._permalinkState;if(a.has("layout")){var b=a.get("layout"),c=this._layouts.filter(function(a){return a.getLabelKey()==b});1!=c.length?console.log("no matching layout found!"):this.changePageLayout(c[0])}if(a.has("page")){var d=+a.get("page");this._pageLayout.jumpToPage(d)}if(a.has("rotation")){var e=+a.get("rotation");this._rotation=e,this._pageLayout.rotate(e)}a.has("scale")&&(this._pageController.viewport.scale=+a.get("scale")),a.has("x")&&a.has("y")&&this._pageLayout.setCurrentPositionInPage(new Position2D(+a.get("x"),+a.get("y"))),this._permalinkState=null},h.prototype.handle=function(d){var e=this;if(d.type==c.events.ProvideToolbarModelEvent.TYPE){var f=d;this._rotateButton=f.model._rotateButton,this._layoutToolbarButton=f.model._layoutDropdownButton,this._toolbarModel=f.model,this._settings.mobile||("addViewSelectButton"in f.model||"addSelectionSwitchButton"in f.model)&&(this._enableAltoSpecificButtons=function(){"addViewSelectButton"in f.model&&(f.model.addViewSelectButton(),e._viewSelectButton=f.model.viewSelect),"addSelectionSwitchButton"in f.model&&(f.model.addSelectionSwitchButton(),e._selectionSwitchButton=f.model.selectionSwitchButton),e.updateToolbarLabel()})}if(d.type==c.events.LanguageModelLoadedEvent.TYPE){var g=d;this._languageModel=g.languageModel,this.updateToolbarLabel()}if(d.type==a.viewer.widgets.toolbar.events.ButtonPressedEvent.TYPE){var h=d;"PreviousImageButton"==h.button.id&&this.previousImage(),"NextImageButton"==h.button.id&&this.nextImage(),"ZoomInButton"==h.button.id&&this._pageController.viewport.startAnimation(new b.widgets.canvas.ZoomAnimation(this._pageController.viewport,2)),"ZoomOutButton"==h.button.id&&this._pageController.viewport.startAnimation(new b.widgets.canvas.ZoomAnimation(this._pageController.viewport,.5)),"ZoomWidthButton"==h.button.id&&this.fitViewerportOverPageWidth(),"ZoomFitButton"==h.button.id&&this.fitViewportOverPage(),"RotateButton"==h.button.id&&(h.button.disabled||(270==this._rotation?(this._rotation=0,this._pageLayout.rotate(0)):this._pageLayout.rotate(this._rotation+=90))),"selectionSwitchButton"==h.button.id&&(h.button.active?this.setAltoSelectable(!1):this.setAltoSelectable(!0))}if(d.type==c.events.ProvidePageLayoutEvent.TYPE){var i=d;this.addLayout(i.pageLayout),i.isDefault&&this.changePageLayout(i.pageLayout)}if(d.type==b.widgets.toolbar.events.DropdownButtonPressedEvent.TYPE){var j=d;"LayoutDropdownButton"==j.button.id?this._layouts.filter(function(a){return a.getLabelKey()==j.childId}).forEach(function(a){e.changePageLayout(a),e.updateToolbarLabel()}):"viewSelect"==j.button.id&&(this.setViewMode(j.childId),this.updateToolbarLabel())}if(d.type==a.viewer.components.events.ImageSelectedEvent.TYPE){var k=d;this.changeImage(k.image.href,!0)}if(d.type==c.events.StructureModelLoadedEvent.TYPE){var l=d;this._structureImages=l.structureModel.imageList,"defaultPageDimension"in l.structureModel&&(this.pageWidth=l.structureModel.defaultPageDimension.width,this.pageHeight=l.structureModel.defaultPageDimension.height),this._structureModelLoaded(),this.changeImage(this._currentImage,!1),this.update()}if(d.type==c.events.RequestStateEvent.TYPE){var m=d,n=m.stateMap;if(m.deepState){var o=this._pageLayout.getCurrentPositionInPage();n.set("x",o.x.toString(10)),n.set("y",o.y.toString(10)),n.set("scale",this._pageController.viewport.scale.toString(10)),n.set("rotation",this._rotation.toString(10)),n.set("layout",this._pageLayout.getLabelKey())}n.set("page",this._orderImageMap.get(this._pageLayout.getCurrentPage()).href),n.set("derivate",this._settings.derivate)}if(d.type==c.events.RequestDesktopInputEvent.TYPE){var p=d;this.registerDesktopInputHandler(p.listener)}if(d.type==c.events.RequestTouchInputEvent.TYPE){var p=d;this.registerTouchInputHandler(p.listener)}if(d.type==c.events.RestoreStateEvent.TYPE){var q=d;this._permalinkState=q.restoredState}if(d.type==c.events.AddCanvasPageLayerEvent.TYPE){var r=d;this._pageController.addCanvasPageLayer(r.zIndex,r.canvasPageLayer)}if(d.type==c.events.RedrawEvent.TYPE&&this._pageController.update(),d.type===c.events.TextEditEvent.TYPE){var s=d;s.component!==this&&(this.setAltoOnTop(s.edit),s.edit&&"imageView"==this._viewMode&&this.setViewMode("mixedView"))}},h.prototype.setAltoOnTop=function(a){this.setAltoSelectable(!1),a?(this._altoView.container.addClass("altoTop"),this._selectionSwitchButton.disabled=!0):(this._altoView.container.removeClass("altoTop"),this._selectionSwitchButton.disabled=!1)},h.prototype.isAltoSelectable=function(){return null!=this._selectionSwitchButton&&this._selectionSwitchButton.active},h.prototype.setAltoSelectable=function(a){this._selectionSwitchButton.active=a,jQuery("[data-id='selectionSwitchButton']").blur(),this._altoView.container.removeClass("altoTop"),a?this._altoView.container.addClass("altoSelectable"):this._altoView.container.removeClass("altoSelectable"),viewerClearTextSelection()},h.prototype.setSelectableButtonEnabled=function(a){a?-1==this._toolbarModel._actionControllGroup.getComponents().indexOf(this._selectionSwitchButton)&&this._toolbarModel._actionControllGroup.addComponent(this._selectionSwitchButton):-1!=this._toolbarModel._actionControllGroup.getComponents().indexOf(this._selectionSwitchButton)&&this._toolbarModel._actionControllGroup.removeComponent(this._selectionSwitchButton)},h.prototype.addLayout=function(a){this._layouts.push(a),a.init(this._layoutModel,this._pageController,new Size2D(this.pageWidth,this.pageHeight),this._horizontalScrollbar,this._verticalScrollbar,this._pageLoader),this.synchronizeLayoutToolbarButton()},h.prototype.synchronizeLayoutToolbarButton=function(){var a=this,b=!1;this._layouts.forEach(function(c){var d=c.getLabelKey();0==a._layoutToolbarButton.children.filter(function(a){return a.id==d}).length&&(a._layoutToolbarButton.children.push({id:d,label:d}),b=!0)}),b&&(this._layoutToolbarButton.children=this._layoutToolbarButton.children,this.updateToolbarLabel())},h.prototype.updateToolbarLabel=function(){var a=this;null!=this._languageModel&&(null!=this._layoutToolbarButton&&(this._layoutToolbarButton.children.forEach(function(b){b.label=a._languageModel.getTranslation("layout."+b.id)}),this._layoutToolbarButton.children=this._layoutToolbarButton.children,null!=this._pageLayout&&(this._layoutToolbarButton.label=this._languageModel.getTranslation("layout."+this._pageLayout.getLabelKey()))),null!=this._viewSelectButton&&(this._viewSelectButton.label=this._languageModel.getTranslation("view."+this._viewMode),this._viewSelectButton.children.forEach(function(b){b.label=a._languageModel.getTranslation("view."+b.id)}),this._viewSelectButton.children=this._viewSelectButton.children))},h.prototype.update=function(){if(null!=this._pageLayout){var a=this._pageLayout.getCurrentPage();this._pageLayout.syncronizePages(),this._settings.mobile||(this._pageController._overview.overviewRect=this._pageLayout.getCurrentOverview()),void 0!==a&&this._orderImageMap.has(a)&&this.changeImage(this._orderImageMap.get(a).href,!1)}},h.prototype._structureModelLoaded=function(){var a=!1;for(var b in this._structureImages){var c=this._structureImages[b];this._hrefImageMap.set(c.href,c),this._orderImageMap.set(c.order,c),a=a||c.additionalHrefs.has("AltoHref")}if(this._orderPageMap.has(1)){var d=this._orderPageMap.get(1);this._orderPageMap.remove(1);var e=this._hrefImageMap.get(this._settings.filePath);this._orderPageMap.set(e.order,d)}this.initPageLayouts(),a&&!this._settings.mobile&&this._enableAltoSpecificButtons()},h.prototype.initPageLayouts=function(){var a=this._settings.filePath,b=this._pageLayout.getCurrentPositionInPage(),d=this._pageController.viewport.scale;this._pageController.viewport.stopAnimation(),this._desktopDelegators.forEach(function(a){return a.clearRunning()}),this._touchDelegators.forEach(function(a){return a.clearRunning()}),this._settings.mobile||(this._horizontalScrollbar.clearRunning(),this._verticalScrollbar.clearRunning()),this._pageLayout.clear(),this._layoutModel.pageCount=this._structureImages.length;var e;if(this._hrefImageMap.has(a))e=this._hrefImageMap.get(a).order;else{var f=ViewerParameterMap.fromCurrentUrl();e=f.has("page")?parseInt(f.get("page")):1}if(null==this._pageLayout)throw"no default page layout found";this._pageLayout.jumpToPage(e),this._pageController.viewport.scale=d,this._pageLayout.setCurrentPositionInPage(b),this._pageController._updateSizeIfChanged(),Utils.getVar(this._settings,"canvas.startup.fitWidth",!1)?this._pageLayout.fitToWidth(!0):this._pageLayout.fitToScreen(),this.trigger(new c.events.WaitForEvent(this,c.events.RestoreStateEvent.TYPE)),null!=this._permalinkState&&this.restorePermalink();var g=this._orderImageMap.get(this._pageLayout.getCurrentPage());this.trigger(new c.events.ImageChangedEvent(this,g))},h.prototype._imageByHref=function(a){return this._hrefImageMap.get(a)},h.prototype.registerDesktopInputHandler=function(a){this._desktopDelegators.push(new b.widgets.canvas.DesktopInputDelegator(jQuery(this._imageView.container),this._pageController.viewport,a)),this._desktopDelegators.push(new b.widgets.canvas.DesktopInputDelegator(jQuery(this._altoView.container),this._pageController.viewport,a))},h.prototype.registerTouchInputHandler=function(a){this._touchDelegators.push(new b.widgets.canvas.TouchInputDelegator(jQuery(this._imageView.container),this._pageController.viewport,a)),this._touchDelegators.push(new b.widgets.canvas.TouchInputDelegator(jQuery(this._altoView.container),this._pageController.viewport,a))},h.ALTO_TEXT_HREF="AltoHref",h.PDF_TEXT_HREF="pdfText",h.DEFAULT_CANVAS_OVERVIEW_MIN_VISIBLE_SIZE="800",h.OVERVIEW_VISIBLE_ICON="glyphicon-triangle-top",h.OVERVIEW_INVISIBLE_ICON="glyphicon-triangle-bottom",h}(c.ViewerComponent);c.MyCoReImageScrollComponent=e;var f=function(a){function c(b){a.call(this),this.component=b,this._touchAdditionalScaleMove=null,this._sessionStartRotation=0}return __extends(c,a),c.prototype.touchStart=function(a){this._touchAdditionalScaleMove=new MoveVector(0,0),this.component.getPageController().viewport.stopAnimation()},c.prototype.touchMove=function(a){var b=this.component.getPageController().viewport;if(!a.touchLeft){if(2==a.touches&&a.startDistance>150&&a.currentMove.distance>150){var c=a.currentMove.angle-a.startAngle,d=(720+(this._sessionStartRotation+c))%360,e=90*Math.round(d/90);e=360==e?0:e,this.component.getRotation()!=e&&(this.component.getPageLayout().rotate(e),this.component.setRotation(e))}if(0!=a.startDistance&&0!=a.currentMove.distance&&a.touches>1){var f=0;f=null==a.lastMove||0==a.lastMove.distance?a.startDistance:a.lastMove.distance;var g=a.currentMove.distance/f,h=b.getAbsolutePosition(a.currentMove.middle),i=new MoveVector(b.position.x-h.x,b.position.y-h.y),j=i.scale(g),k=h.move(j);this._touchAdditionalScaleMove=this._touchAdditionalScaleMove.move(new MoveVector(b.position.x-k.x,b.position.y-k.y)),b.scale*=g}var l=new MoveVector(-(a.currentMove.middle.x-a.startMiddle.x),-(a.currentMove.middle.y-a.startMiddle.y)),m=b.rotation,n=b.scale;b.position=a.canvasStartPosition.copy().scale(n).move(l.rotate(m)).scale(1/n).move(this._touchAdditionalScaleMove)}},c.prototype.touchEnd=function(a){var c=this.component.getPageController().viewport;if(null!=a.currentMove&&(0!=a.currentMove.velocity.x||0!=a.currentMove.velocity.y)){var d=new b.widgets.canvas.VelocityScrollAnimation(this.component.getPageController().viewport,a.currentMove.velocity);this.component.getPageController().viewport.startAnimation(d)}if(null!=a.lastSession)if(a.startTime-a.lastSession.startTime<200){var e=a.startMiddle,f=c.getAbsolutePosition(e);c.startAnimation(new b.widgets.canvas.ZoomAnimation(c,2,f,500))}else a.canvasStartPosition.equals(this.component.getPageController().viewport.position);this._sessionStartRotation=this.component.getRotation()},c}(b.widgets.canvas.TouchInputAdapter),g=function(a){function c(b){a.call(this),this.component=b}return __extends(c,a),c.prototype.mouseDown=function(a,b){var c=this.component._componentContent;c.addClass("grab"),c.removeClass("grabbable")},c.prototype.mouseUp=function(a,b){var c=this.component._componentContent;c.addClass("grabbable"),c.removeClass("grab")},c.prototype.mouseDoubleClick=function(a){var c=this.component.getPageController().viewport,d=c.getAbsolutePosition(a);c.startAnimation(new b.widgets.canvas.ZoomAnimation(c,2,d))},c.prototype.mouseDrag=function(a,b,c){if(!this.component.isAltoSelectable()){var d=a.x-b.x,e=a.y-b.y,f=new MoveVector(-d,-e).rotate(this.component.getPageController().viewport.rotation);this.component.getPageController().viewport.position=c.scale(this.component.getPageController().viewport.scale).move(f).scale(1/this.component.getPageController().viewport.scale)}},c.prototype.scroll=function(a){var c="zoom"==ViewerParameterMap.fromCurrentUrl().get("iview2.scroll"),d=c?!a.altKey||a.ctrlKey:a.altKey||a.ctrlKey,e=this.component.getPageController().viewport;if(d){var f=Math.pow(.95,a.deltaY/10);if(void 0!==e.currentAnimation&&null!=e.currentAnimation)e.currentAnimation instanceof b.widgets.canvas.ZoomAnimation?e.currentAnimation.merge(f):console.log("dont know howto merge animations");else{var g=e.getAbsolutePosition(a.pos);e.startAnimation(new b.widgets.canvas.ZoomAnimation(e,f,g))}}else e.position=new Position2D(e.position.x+a.deltaX/e.scale,e.position.y+a.deltaY/e.scale)},c.prototype.keydown=function(a){switch(a.keyCode){case 33:this.component.previousImage();break;case 34:this.component.nextImage()}},c}(b.widgets.canvas.DesktopInputAdapter)}(b.components||(b.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(c,d){a.call(this,c,b.TYPE),this.layer=d}return __extends(b,a),b.TYPE="ProvideLayerEvent",b}(a.MyCoReImageViewerEvent);a.ProvideLayerEvent=b}(a.events||(a.events={}))}(a.components||(a.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(){this.onLayerAdd=Array(),this.onLayerRemove=Array(),this.currentPage=null,this.layerList=new Array}return a.prototype.addLayer=function(a){if(-1!=this.layerList.indexOf(a))throw"the layer "+a.getId()+" is already in model!";this.layerList.push(a),this.onLayerAdd.forEach(function(b){return b(a)})},a.prototype.removeLayer=function(a){var b=this.layerList.indexOf(a);if(-1==b)throw"the layer "+a.getId()+" is not present in model!";this.layerList.splice(b,1),this.onLayerRemove.forEach(function(b){return b(a)})},a.prototype.getLayerList=function(){return this.layerList.slice(0)},a}();a.LayerDisplayModel=b}(a.layer||(a.layer={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function b(b,c){this._container=b,this.languageResolver=c,this._layerIdViewMap=new MyCoReMap,this._layerIdCallbackMap=new MyCoReMap,this.model=new a.LayerDisplayModel,this.initializeView(),this.initializeModel()}return b.prototype.initializeView=function(){this._view=jQuery("<div></div>"),this._view.addClass("layer-view"),this._view.appendTo(this._container)},b.prototype.addLayerView=function(a){var b,c=a.getId();b=this._layerIdViewMap.has(c)?this._layerIdViewMap.get(c):this.createLayerView(a),this._view.append(b)},b.prototype.createLayerView=function(a){var c=a.getId(),d=this.languageResolver(a.getLabel()),e=jQuery("<div data-id='layer-"+c+"' class='layer'></div>");return jQuery('<div class="layer-heading '+b.REMOVE_EXCLUDE_CLASS+'">'+d+"</div>").appendTo(e),this._layerIdViewMap.set(c,e),e},b.prototype.removeLayerView=function(a){this.getLayerView(a.getId()).detach()},b.prototype.getLayerView=function(a){return this._layerIdViewMap.get(a)},b.prototype.cleanLayerView=function(a){this._layerIdViewMap.get(a).children().not("."+b.REMOVE_EXCLUDE_CLASS).detach()},b.prototype.initializeModel=function(){var a=this;this.model.onLayerAdd.push(function(b){a.addLayerView(b)}),this.model.onLayerRemove.push(function(b){a.removeLayerView(b)})},b.prototype.addLayer=function(a){this.model.addLayer(a),this.synchronizeView()},b.prototype.removeLayer=function(a){this.model.removeLayer(a),this.synchronizeView()},b.prototype.getLayer=function(){return this.model.getLayerList()},b.prototype.pageChanged=function(a){this.model.currentPage=a,this.synchronizeView()},b.prototype.synchronizeView=function(){var a=this;this.model.getLayerList().forEach(function(b){var c=b.getId();a.cleanLayerView(b.getId());var d=function(e,f){e&&a._layerIdCallbackMap.has(c)&&a._layerIdCallbackMap.get(c)==d&&(f.find(".popupTrigger").each(function(a,b){var c=jQuery(b);c.attr("data-placement","bottom"),c.popover({html:!0,content:function(){return c.find(".popupBox").html()}})}),a.getLayerView(b.getId()).append(f),a._layerIdCallbackMap.remove(c))};a._layerIdCallbackMap.has(c)&&a._layerIdCallbackMap.remove(c),a._layerIdCallbackMap.set(c,d),b.resolveLayer(a.model.currentPage,d)})},b.REMOVE_EXCLUDE_CLASS="rm-exclude",b}();a.LayerDisplayController=b}(a.layer||(a.layer={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(b){!function(c){var d=function(d){function e(a){d.call(this),this._settings=a,this.toolbarButtonSync=Utils.synchronize([function(a){return a.toolbarButtonDisplayable()},function(a){return null==a.dropDownButton}],function(a){return a.initToolbarButton()}),this.layerSync=Utils.synchronize([function(a){return a.toolbarButtonInitialized()}],function(a){return a.synchronizeLayers()}),this.structureModel=null,this.languageModel=null,this.toolbarModel=null,this.dropDownButton=null,this.sidebarLabel=jQuery("<span>Ebenen</span>"),this.enabled="true"===Utils.getVar(this._settings,"text.enabled","true")&&1!=this._settings.mobile,this.showLayerOnStart=Utils.getVar(this._settings,"text.showOnStart",[])}return __extends(e,d),e.prototype.init=function(){var a=this;this.enabled&&(this.container=jQuery("<div></div>"),this.container.css({overflowY:"scroll",display:"block"}),this.container.addClass("tei"),this.container.addClass("layer-component"),this.container.bind("iviewResize",function(){a.updateContainerSize()}),this.layerDisplay=new b.widgets.layer.LayerDisplayController(this.container,function(b){return a.languageModel.getTranslation(b)}),this.layerList=new Array,this.layerIdLayerMap=new MyCoReMap,this.trigger(new c.events.WaitForEvent(this,c.events.StructureModelLoadedEvent.TYPE)),this.trigger(new c.events.WaitForEvent(this,c.events.LanguageModelLoadedEvent.TYPE)),this.trigger(new c.events.WaitForEvent(this,c.events.ImageChangedEvent.TYPE)))},e.prototype.updateContainerSize=function(){this.container.css({height:this.container.parent().height()-this.sidebarLabel.parent().outerHeight()+"px"});var a=this.container.width(),b=ViewerUserSettingStore.getInstance();a>50&&b.setValue(e.SIDEBAR_LAYER_SIZE,a.toString())},Object.defineProperty(e.prototype,"handlesEvents",{get:function(){var b=new Array;return this.enabled&&(b.push(c.events.StructureModelLoadedEvent.TYPE),b.push(c.events.ImageChangedEvent.TYPE),b.push(c.events.ShowContentEvent.TYPE),b.push(a.viewer.widgets.toolbar.events.DropdownButtonPressedEvent.TYPE),b.push(c.events.LanguageModelLoadedEvent.TYPE),b.push(c.events.ProvideToolbarModelEvent.TYPE),b.push(c.events.ProvideLayerEvent.TYPE)),b},enumerable:!0,configurable:!0}),e.prototype.handle=function(b){var d=this;if(b.type==a.viewer.widgets.toolbar.events.DropdownButtonPressedEvent.TYPE){var f=b;if(f.button.id==e.LAYER_DROPDOWN_ID){if(!this.layerIdLayerMap.has(f.childId))throw new ViewerError("Invalid button child pressed!");var g=f.childId;this.toggleTranscriptionContainer(g)}}if(b.type==c.events.ProvideLayerEvent.TYPE){var h=b;this.layerList.push(h.layer);var i=h.layer.getId();if(this.layerIdLayerMap.set(i,h.layer),this.toolbarButtonSync(this),this.layerSync(this),this.showLayerOnStart.length>0){var j=void 0;if(-1!=(j=this.showLayerOnStart.indexOf(i))){if(0!=this.layerDisplay.getLayer().length){var k=void 0;if(-1!=(k=this.showLayerOnStart.indexOf(this.layerDisplay.getLayer()[0].getId()))&&k<j)return}this.toggleTranscriptionContainer(i,!0)}}}if(b.type==c.events.ShowContentEvent.TYPE){var l=b;0==l.size&&l.containerDirection==c.events.ShowContentEvent.DIRECTION_EAST&&null!=this.dropDownButton&&(this.dropDownButton.children.forEach(function(a){delete a.icon}),this.dropDownButton.children=this.dropDownButton.children,this.layerDisplay.getLayer().forEach(function(a){d.layerDisplay.removeLayer(a)}))}if(b.type==c.events.StructureModelLoadedEvent.TYPE){var m=b;this.structureModel=m.structureModel,this.toolbarButtonSync(this)}if(b.type==c.events.ImageChangedEvent.TYPE){var n=b;void 0!==this.structureModel&&void 0!==n.image&&null!=n&&(this.currentHref=n.image.href,this.layerDisplay.pageChanged(this.currentHref))}if(b.type==c.events.LanguageModelLoadedEvent.TYPE&&(this.languageModel=b.languageModel,this.toolbarButtonSync(this)),b.type==c.events.ProvideToolbarModelEvent.TYPE){var o=b;this.toolbarModel=o.model,this.toolbarButtonSync(this)}},e.prototype.toggleTranscriptionContainer=function(a,b){var c=this;void 0===b&&(b=!1);var d=this.layerIdLayerMap.get(a);-1==this.layerDisplay.getLayer().indexOf(d)?this.layerDisplay.addLayer(d):this.layerDisplay.removeLayer(d),b&&this.layerDisplay.getLayer().forEach(function(a){d!=a&&c.layerDisplay.removeLayer(a)}),this.layerDisplay.getLayer().length>0?this.showContainer():this.hideContainer(),this.synchronizeLayers()},e.prototype.showContainer=function(){var a=ViewerUserSettingStore.getInstance(),b=a.hasValue(e.SIDEBAR_LAYER_SIZE),d=b?parseInt(a.getValue(e.SIDEBAR_LAYER_SIZE),10):null,f=this._settings.mobile?c.events.ShowContentEvent.DIRECTION_CENTER:c.events.ShowContentEvent.DIRECTION_EAST;this.trigger(new c.events.ShowContentEvent(this,this.container,f,b?d:400,this.sidebarLabel)),this.updateContainerSize()},e.prototype.hideContainer=function(){var a=this._settings.mobile?c.events.ShowContentEvent.DIRECTION_CENTER:c.events.ShowContentEvent.DIRECTION_EAST;this.trigger(new c.events.ShowContentEvent(this,null,a,0,null))},e.prototype.toolbarButtonInitialized=function(){return null!=this.dropDownButton},e.prototype.toolbarButtonDisplayable=function(){return null!=this.languageModel&&null!=this.toolbarModel&&this.layerList.length>0},e.prototype.initToolbarButton=function(){this.dropDownButton=new b.widgets.toolbar.ToolbarDropdownButton(e.LAYER_DROPDOWN_ID,this.languageModel.getTranslation("toolbar.layerButton"),[]),this.toolbarModel._actionControllGroup.addComponent(this.dropDownButton),this.layerSync(this)},e.prototype.synchronizeLayers=function(){var a=this,b=function(b){return 0==a.dropDownButton.children.filter(function(a){return a.id==b.getId()}).length};this.layerList.filter(b).forEach(function(b){var c=a.languageModel.getTranslation(b.getLabel()),d={id:b.getId(),label:c};a.dropDownButton.children.push(d)}),this.dropDownButton.children.forEach(function(b){a.layerIdLayerMap.has(b.id)&&(-1!=a.layerDisplay.getLayer().indexOf(a.layerIdLayerMap.get(b.id))?b.icon="ok":"icon"in b&&delete b.icon)}),this.dropDownButton.children=this.dropDownButton.children},e.SIDEBAR_LAYER_SIZE="SIDEBAR_LAYER_SIZE",e.LAYER_DROPDOWN_ID="toolbar.LayerButton",e}(c.ViewerComponent);c.MyCoReLayerComponent=d}(b.components||(b.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){var b=function(b){function c(a){var c=this;b.call(this),this._settings=a,this._nextImageButton=null,this._previousImageButton=null,this._structureModel=null,this._currentImage=null,this._checkAndDisableSynchronize=Utils.synchronize([function(a){return null!=a._nextImageButton},function(a){return null!=a._previousImageButton},function(a){return null!=a._structureModel},function(a){return null!=a._currentImage}],function(a){
var b=c._structureModel._imageList.indexOf(c._currentImage);c._previousImageButton.disabled=0==b,b==c._structureModel.imageList.length-1?c._nextImageButton.disabled=!0:c._nextImageButton.disabled=!1})}return __extends(c,b),c.prototype.init=function(){},Object.defineProperty(c.prototype,"handlesEvents",{get:function(){var b=new Array;return b.push(a.events.StructureModelLoadedEvent.TYPE),b.push(a.events.ImageChangedEvent.TYPE),b.push(a.events.ProvideToolbarModelEvent.TYPE),b},enumerable:!0,configurable:!0}),c.prototype.handle=function(b){if(b.type==a.events.ProvideToolbarModelEvent.TYPE){var c=b;this._nextImageButton=c.model._nextImageButton,this._previousImageButton=c.model._previousImageButton,null==this._structureModel&&(this._nextImageButton.disabled=!0,this._previousImageButton.disabled=!0),this._checkAndDisableSynchronize(this)}if(b.type==a.events.StructureModelLoadedEvent.TYPE){var d=b;this._structureModel=d.structureModel,this._nextImageButton.disabled=!1,this._previousImageButton.disabled=!1,this._checkAndDisableSynchronize(this)}if(b.type==a.events.ImageChangedEvent.TYPE){var e=b;null!=e.image&&(this._currentImage=e.image,this._checkAndDisableSynchronize(this))}},c}(a.ViewerComponent);a.MyCoReButtonChangeComponent=b}(a.components||(a.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var IVIEW_COMPONENTS=VIEWER_COMPONENTS||[],mycore;!function(a){!function(a){var b=function(){function b(a,b){this._container=a,this._settings=b,this._initializing=!1,this._eventHandlerMap=new MyCoReMap,this._components=new Array,this._initializingEvents=new Array,this.initialize()}return Object.defineProperty(b.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0}),b.prototype.addComponent=function(b){var c=this;b.bind(function(a){c.eventTriggered(a)});var d=b.handlesEvents;if(void 0!==d&&null!=d&&d instanceof Array){d.push(a.components.events.WaitForEvent.TYPE);for(var e in d){var f=d[e];this._eventHandlerMap.has(f)||this._eventHandlerMap.set(f,new Array),this._eventHandlerMap.get(f).push(b)}}else console.log(ViewerFormatString("The component {comp} doesnt have a valid handlesEvents!",{comp:b}));this._components.push(b),b.init()},b.prototype.eventTriggered=function(a){if(this._eventHandlerMap.has(a.type)){var b=this._eventHandlerMap.get(a.type);for(var c in b){b[c]._handle(a)}}},b.prototype.initialize=function(){this._settings=a.MyCoReViewerSettings.normalize(this._settings),this._container.hasClass("mycoreViewer")||this._container.addClass("mycoreViewer");for(var b in IVIEW_COMPONENTS){var c=IVIEW_COMPONENTS[b];try{this.addComponent(new c(this._settings,this._container))}catch(a){console.log("Unable to add component"),console.log(a)}}},b}();a.MyCoReViewer=b}(a.viewer||(a.viewer={}))}(mycore||(mycore={})),addViewerComponent(mycore.viewer.components.MyCoReViewerContainerComponent),addViewerComponent(mycore.viewer.components.MyCoReI18NComponent),addViewerComponent(mycore.viewer.components.MyCoReImageOverviewComponent),addViewerComponent(mycore.viewer.components.MyCoReToolbarComponent),addViewerComponent(mycore.viewer.components.MyCoReImageScrollComponent),addViewerComponent(mycore.viewer.components.MyCoReChapterComponent),addViewerComponent(mycore.viewer.components.MyCoRePermalinkComponent),addViewerComponent(mycore.viewer.components.MyCoReLayerComponent),addViewerComponent(mycore.viewer.components.MyCoReButtonChangeComponent);var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(b,c,d,e,f){void 0===f&&(f=document.body),a.call(this,b,c,f),this.modalHeader.children("h4").addClass("text-danger");var g=null!=e?"<img class='thumbnail error-image' src='"+e+"' />":"";this.modalBody.append("<div class='error-image-holder'> "+g+" <span data-i18n='\" + text + \"'>"+d+"</span></div>")}return __extends(b,a),b}(a.IviewModalWindow);a.ViewerErrorModal=b}(a.modal||(a.modal={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(b,c,d,e){void 0===e&&(e=document.body),a.call(this,b,c,e),this.modalHeader.children("h4").addClass("text-info"),this.modalBody.append("<p><span data-i18n='"+d+"'>"+d+"</span></p>")}return __extends(b,a),b}(a.IviewModalWindow);a.ViewerInfoModal=b}(a.modal||(a.modal={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(b,c,d,e,f){void 0===f&&(f=document.body),a.call(this,b,c,f),this.modalHeader.children("h4").addClass("text-info"),this.modalBody.append("<p><span data-i18n='"+d+"'>"+d+"</span></p>"),this.modalFooter.empty(),this.createButton(!0,e),this.createButton(!1,e)}return __extends(b,a),b.prototype.createButton=function(a,b){var c=a?"yes":"no",d=jQuery("<a data-i18n='modal."+c+"'></a>");d.attr("type","button"),d.addClass("btn btn-default"),d.appendTo(this.modalFooter);var e=this;d.click(function(){b&&b(a),e.hide()})},b}(a.IviewModalWindow);a.ViewerConfirmModal=b}(a.modal||(a.modal={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(a){!function(a){var b=function(a){function b(c,d,e){a.call(this,c,b.TYPE),this._pageId=d,this.abstractPage=e}return __extends(b,a),b.TYPE="PageLoadedEvent",b}(a.MyCoReImageViewerEvent);a.PageLoadedEvent=b}(a.events||(a.events={}))}(a.components||(a.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));