var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},mycore;!function(a){!function(a){!function(a){!function(a){var b=function(){function a(a,b,c,d,e){this._id=a,this._label=b,this.mapping=c,this.contentLocation=d,this.teiStylesheet=e}return a.prototype.getId=function(){return this._id},a.prototype.getLabel=function(){return this._label},a.prototype.resolveLayer=function(a,b){if(this.mapping.has(a)){var c={};c.async=!0,c.success=function(a,c,d){b(!0,jQuery(a))},jQuery.ajax(this.contentLocation+this.mapping.get(a)+"?XSL.Style="+this.teiStylesheet,c)}else b(!1)},a}();a.TEILayer=b}(a.tei||(a.tei={}))}(a.widgets||(a.widgets={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={}));var mycore;!function(a){!function(a){!function(b){var c=function(c){function d(a){c.call(this),this._settings=a,this._model=null,this.contentLocation=null,this.contentLocation=this._settings.webApplicationBaseURL+"/servlets/MCRDerivateContentTransformerServlet/"+this._settings.derivate+"/"}return __extends(d,c),d.prototype.init=function(){"mets"==this._settings.doctype&&this.trigger(new b.events.WaitForEvent(this,b.events.StructureModelLoadedEvent.TYPE))},d.prototype.handle=function(c){var d=this;if(c.type==b.events.StructureModelLoadedEvent.TYPE){var e=c;this._model=e.structureModel;var f=new MyCoReMap,g=new MyCoReMap,h=new Array;e.structureModel._imageList.forEach(function(a){a.additionalHrefs.forEach(function(b,c){if(0==b.indexOf("TEI.")){var d=b.substr("TEI.".length).toLocaleLowerCase();g.has(d)||g.set(d,new MyCoReMap),g.get(d).set(a.href,c),-1==h.indexOf(d)&&h.push(d)}})}),f.isEmpty()||this.trigger(new b.events.ProvideLayerEvent(this,new a.widgets.tei.TEILayer("transcription","layer.transcription",f,this.contentLocation,this._settings.teiStylesheet||"html")));var i=["de","en"];return void(0!=h.length&&h.sort(function(a,b){return i.indexOf(a)-i.indexOf(b)}).forEach(function(c){var e=g.get(c);d.trigger(new b.events.ProvideLayerEvent(d,new a.widgets.tei.TEILayer(c,"layer."+c,e,d.contentLocation,d._settings.teiStylesheet||"html")))}))}},Object.defineProperty(d.prototype,"handlesEvents",{get:function(){return"mets"==this._settings.doctype?[b.events.StructureModelLoadedEvent.TYPE]:[]},enumerable:!0,configurable:!0}),d}(b.ViewerComponent);b.MyCoReTEILayerProvider=c}(a.components||(a.components={}))}(a.viewer||(a.viewer={}))}(mycore||(mycore={})),addViewerComponent(mycore.viewer.components.MyCoReTEILayerProvider);